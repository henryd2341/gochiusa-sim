# åŒå±‚å‰ç«¯ç•Œé¢è®¾è®¡æ–‡æ¡£ v2.0

## ä¸€ã€é¡¹ç›®æ¦‚è¿°

### 1.1 é¡¹ç›®ç›®æ ‡

è®¾è®¡ä¸€ä¸ªç²¾ç¾çš„åŒå±‚å‰ç«¯ç•Œé¢ï¼Œç”¨äºåŸºäºLLMçš„æ–‡å­—äº¤äº’æ¸¸æˆã€‚è¯¥ç•Œé¢éœ€è¦ï¼š

- æä¾›æœ€å¤§åŒ–æ²‰æµ¸å¼ä½“éªŒçš„äº’åŠ¨å¼å¯¹è¯çª—å£
- æ‰“é€šå‰ç«¯å’ŒåŸç”Ÿå¯¹è¯ç•Œé¢ï¼Œæ­£ç¡®æŠ“å–å†…å®¹å¹¶æ˜¾ç¤º
- ä¸ºç”¨æˆ·å®ç°å„ç§å®ç”¨åŠŸèƒ½
- ç¬¦åˆç‚¹å…”ï¼ˆè¯·é—®æ‚¨ä»Šå¤©è¦æ¥ç‚¹å…”å­å—ï¼Ÿï¼‰çš„æ³•å¼è‰ºæœ¯é£æ ¼
- **ç§»åŠ¨ç«¯ä¼˜å…ˆçš„å“åº”å¼å¸ƒå±€**

### 1.2 æ ¸å¿ƒç‰¹æ€§

| ç‰¹æ€§       | æè¿°                                |
| ---------- | ----------------------------------- |
| å¯åŠ¨é¡µé¢   | Press Start å…¥å£é¡µé¢ï¼Œå‡è½»æ¸²æŸ“å‹åŠ›  |
| å…¨å±æ²‰æµ¸å¼ | å¸¦å…¨å±åˆ‡æ¢æŒ‰é’®ï¼Œéå…¨å±æŒ‰ç§»åŠ¨ç«¯å¤„ç†  |
| è§’è‰²çŠ¶æ€   | å¯æŠ˜å åº•æ /ä¾§è¾¹æ ï¼Œç‚¹å‡»å¤´åƒå±•å¼€è¯¦æƒ… |
| é€‰é¡¹äº¤äº’   | çº¯é€‰é¡¹æŒ‰é’®äº¤äº’ï¼Œæ”¯æŒè‡ªå®šä¹‰æ–°å¢é€‰é¡¹  |
| æ¶ˆæ¯æ˜¾ç¤º   | è®¾ç½®å¯é€‰ï¼Œé»˜è®¤å³æ—¶æ˜¾ç¤ºå®Œæ•´å†…å®¹      |
| å†å²æ¶ˆæ¯   | æ”¯æŒæŸ¥çœ‹å†å²æ¶ˆæ¯åŠŸèƒ½                |
| ä¸–ç•Œä¹¦ç®¡ç† | å¿«é€ŸæŸ¥çœ‹/è°ƒæ•´ä¸–ç•Œä¹¦å¼€å…³çŠ¶æ€         |
| å­—ä½“é…è‰²   | è®¾ç½®é¡µå¯åˆ‡æ¢å­—ä½“å’Œé…è‰²æ–¹æ¡ˆ          |

### 1.3 æ•°æ®æµæ¶æ„ï¼ˆé‡è¦ï¼‰

```mermaid
flowchart TB
    subgraph ç”¨æˆ·äº¤äº’
        A[å‰ç«¯ç•Œé¢] --> B[é€‰æ‹©é€‰é¡¹]
    end

    subgraph é…’é¦†å¤„ç†
        B --> C[é…’é¦†åŸç”Ÿå‘é€æ¶ˆæ¯]
        C --> D[AIç”Ÿæˆå›å¤]
        D --> E[é…’é¦†æ¥æ”¶AIå›å¤]
        E --> F[MVUè§£æå˜é‡]
    end

    subgraph å‰ç«¯æ˜¾ç¤º
        F --> G[å‰ç«¯æŠ“å–æ¶ˆæ¯]
        G --> A
    end
```

**å…³é”®ç‚¹**ï¼š

- AIå›å¤**ä¸æ˜¯**ç›´æ¥å‘é€åˆ°å‰ç«¯ç•Œé¢
- AIå›å¤å…ˆå‘é€åˆ°é…’é¦†ï¼Œç„¶åå‰ç«¯ä»é…’é¦†æŠ“å–æ˜¾ç¤º
- ç”¨æˆ·é€‰æ‹©é€‰é¡¹ï¼Œå®é™…ä¸Šæ˜¯åœ¨é…’é¦†å†…å‘é€äº†ä¸€æ¡æ¶ˆæ¯
- è¿™æ ·æ‰èƒ½å®ç°MVUçš„å®Œæ•´åŠŸèƒ½

### 1.4 æŠ€æœ¯æ¶æ„

```mermaid
flowchart TB
    subgraph é¡µé¢è·¯ç”±
        A[å¯åŠ¨é¡µ StartScreen] --> B[ä¸»æ¸¸æˆé¡µ GameMain]
        B --> C[è§’è‰²è¯¦æƒ…é¡µ CharacterDetail]
        B --> D[å†å²æ¶ˆæ¯é¡µ HistoryMessages]
        B --> E[ä¸–ç•Œä¹¦ç®¡ç†é¡µ WorldbookManager]
        B --> F[è®¾ç½®é¡µ SettingsPage]
    end

    subgraph ä¸»æ¸¸æˆé¡µç»„ä»¶
        B --> G[æ¶ˆæ¯æ˜¾ç¤ºåŒº MessageDisplay]
        B --> H[é€‰é¡¹äº¤äº’åŒº OptionsPanel]
        B --> I[è§’è‰²çŠ¶æ€æ  CharacterBar - å¯æŠ˜å ]
    end

    subgraph æ•°æ®å±‚
        J[Pinia Store] --> K[MVUå˜é‡æ¥å£]
        K --> L[é…’é¦†åŠ©æ‰‹API]
    end
```

---

## äºŒã€é¡µé¢è®¾è®¡

### 2.1 å¯åŠ¨é¡µé¢ï¼ˆStartScreenï¼‰

**ç›®çš„**ï¼šå‡è½»æ¸²æŸ“å‹åŠ›ï¼Œæä¾›ä¼˜é›…çš„å…¥å£ä½“éªŒ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                             â”‚
â”‚                                                             â”‚
â”‚                                                             â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚                    â”‚   ç‚¹å…”Logo      â”‚                     â”‚
â”‚                    â”‚   (SVGæ ‡é¢˜)     â”‚                     â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                                                             â”‚
â”‚                                                             â”‚
â”‚                  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—                   â”‚
â”‚                  â•‘   Press Start      â•‘                   â”‚
â”‚                  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                   â”‚
â”‚                                                             â”‚
â”‚                                                             â”‚
â”‚                      ç‰ˆæœ¬ä¿¡æ¯ v1.0                          â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**äº¤äº’**ï¼š

- ç‚¹å‡» "Press Start" è¿›å…¥ä¸»æ¸¸æˆé¡µé¢
- æ˜¾ç¤ºåŠ è½½åŠ¨ç”»
- èƒŒæ™¯ä½¿ç”¨è£…é¥°æ€§å›¾æ¡ˆ

### 2.2 ä¸»æ¸¸æˆé¡µé¢ï¼ˆGameMainï¼‰

**ç§»åŠ¨ç«¯ä¼˜å…ˆè®¾è®¡**ï¼ˆéå…¨å±æ¨¡å¼ï¼‰ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â‰¡  Logo          âš™ï¸  â›¶    â”‚  â† é¡¶éƒ¨å¯¼èˆªæ 
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                     â”‚   â”‚
â”‚   â”‚    æ¶ˆæ¯æ˜¾ç¤ºåŒºåŸŸ     â”‚   â”‚
â”‚   â”‚                     â”‚   â”‚
â”‚   â”‚   AIå›å¤å†…å®¹å‘ˆç°    â”‚   â”‚
â”‚   â”‚                     â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ é€‰é¡¹æ ‡é¢˜            â”‚   â”‚
â”‚  â”‚ é€‰é¡¹æè¿°...         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ é€‰é¡¹æ ‡é¢˜            â”‚   â”‚
â”‚  â”‚ é€‰é¡¹æè¿°...         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  [ + æ·»åŠ è‡ªå®šä¹‰é€‰é¡¹ ]       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â–¼ è§’è‰²çŠ¶æ€æ ï¼ˆå¯æŠ˜å ï¼‰     â”‚  â† ç‚¹å‡»å±•å¼€/æ”¶èµ·
â”‚  â”Œâ”€â”€â”€â”â”Œâ”€â”€â”€â”â”Œâ”€â”€â”€â”â”Œâ”€â”€â”€â”      â”‚
â”‚  â”‚å¿ƒçˆ±â”‚â”‚æ™ºä¹ƒâ”‚â”‚ç†ä¸–â”‚â”‚...â”‚      â”‚  â† è§’è‰²å¤´åƒ
â”‚  â””â”€â”€â”€â”˜â””â”€â”€â”€â”˜â””â”€â”€â”€â”˜â””â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å…¨å±æ¨¡å¼**ï¼šæ‰©å±•ä¸ºå®½å±å¸ƒå±€ï¼Œæ¶ˆæ¯åŒºåŸŸæ›´å®½

### 2.3 è§’è‰²è¯¦æƒ…é¡µï¼ˆCharacterDetailï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â† è¿”å›      è§’è‰²è¯¦æƒ…       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                     â”‚   â”‚
â”‚   â”‚    è§’è‰²ç«‹ç»˜         â”‚   â”‚
â”‚   â”‚    (å¤§å›¾)           â”‚   â”‚
â”‚   â”‚                     â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                             â”‚
â”‚   å¿ƒçˆ±                      â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
â”‚   å¿ƒæƒ…: å¼€å¿ƒ ğŸ˜Š             â”‚
â”‚   ä½ç½®: Rabbit House        â”‚
â”‚   ç€è£…: å’–å•¡å…åˆ¶æœ          â”‚
â”‚                             â”‚
â”‚   â”€â”€â”€â”€ å…³é”®ç‰©å“ â”€â”€â”€â”€        â”‚
â”‚   â€¢ ç‰¹åˆ¶å’–å•¡è±† x1           â”‚
â”‚   â€¢ æ‰‹å†™ä¿¡ä»¶ x1             â”‚
â”‚                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.4 å†å²æ¶ˆæ¯é¡µï¼ˆHistoryMessagesï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â† è¿”å›      å†å²æ¶ˆæ¯       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [æœç´¢æ¡†]                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ç¬¬15æ¥¼ - å¿ƒçˆ±       â”‚   â”‚
â”‚  â”‚ æ¶ˆæ¯å†…å®¹é¢„è§ˆ...     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ç¬¬14æ¥¼ - ç”¨æˆ·       â”‚   â”‚
â”‚  â”‚ æ¶ˆæ¯å†…å®¹é¢„è§ˆ...     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  ...                        â”‚
â”‚  [åŠ è½½æ›´å¤š]                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å®ç°æ–¹å¼**ï¼šä½¿ç”¨ `/messages` æ–œæ å‘½ä»¤è·å–å†å²æ¶ˆæ¯

### 2.5 ä¸–ç•Œä¹¦ç®¡ç†é¡µï¼ˆWorldbookManagerï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â† è¿”å›      ä¸–ç•Œä¹¦ç®¡ç†     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [æœç´¢æ¡ç›®]                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ â˜‘ ä¿ç™»å¿ƒçˆ±          â”‚   â”‚
â”‚  â”‚   è§’è‰²è®¾å®šæ¡ç›®      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ â˜‘ é¦™é£æ™ºä¹ƒ          â”‚   â”‚
â”‚  â”‚   è§’è‰²è®¾å®šæ¡ç›®      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ â˜ æµ‹è¯•æ¡ç›®          â”‚   â”‚
â”‚  â”‚   å·²ç¦ç”¨çš„æ¡ç›®      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  ...                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**åŠŸèƒ½**ï¼š

- æ˜¾ç¤ºæ‰€æœ‰ä¸–ç•Œä¹¦æ¡ç›®
- å¿«é€Ÿå¼€å…³æ¡ç›®å¯ç”¨/ç¦ç”¨çŠ¶æ€
- æœç´¢è¿‡æ»¤æ¡ç›®

### 2.6 è®¾ç½®é¡µï¼ˆSettingsPageï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â† è¿”å›        è®¾ç½®         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                             â”‚
â”‚  â”€â”€â”€â”€ æ˜¾ç¤ºè®¾ç½® â”€â”€â”€â”€         â”‚
â”‚  æ¶ˆæ¯æ˜¾ç¤ºæ¨¡å¼:              â”‚
â”‚  â—‹ å³æ—¶æ˜¾ç¤ºï¼ˆé»˜è®¤ï¼‰         â”‚
â”‚  â—‹ æ‰“å­—æœºæ•ˆæœ               â”‚
â”‚  â—‹ åˆ†æ®µæ˜¾ç¤º                 â”‚
â”‚                             â”‚
â”‚  â”€â”€â”€â”€ å­—ä½“è®¾ç½® â”€â”€â”€â”€         â”‚
â”‚  å­—ä½“æ–¹æ¡ˆ:                  â”‚
â”‚  â—‰ é»˜è®¤å­—ä½“                 â”‚
â”‚  â—‹ é˜…è¯»å­—ä½“                 â”‚
â”‚  â—‹ è‰ºæœ¯å­—ä½“                 â”‚
â”‚                             â”‚
â”‚  â”€â”€â”€â”€ é…è‰²æ–¹æ¡ˆ â”€â”€â”€â”€         â”‚
â”‚  â—‰ æš–è‰²è°ƒï¼ˆé»˜è®¤ï¼‰           â”‚
â”‚  â—‹ å†·è‰²è°ƒ                   â”‚
â”‚  â—‹ é«˜å¯¹æ¯”åº¦                 â”‚
â”‚  â—‹ æŠ¤çœ¼æ¨¡å¼                 â”‚
â”‚                             â”‚
â”‚  â”€â”€â”€â”€ å…¶ä»–è®¾ç½® â”€â”€â”€â”€         â”‚
â”‚  å­—ä½“å¤§å°: [å°] [ä¸­] [å¤§]   â”‚
â”‚  è‡ªåŠ¨æ»šåŠ¨: [å¼€]             â”‚
â”‚                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ä¸‰ã€è§†è§‰è®¾è®¡è§„èŒƒ

### 3.1 è‰²å½©ç³»ç»Ÿ

åŸºäº [`charcolor.css`](src/å‰ç«¯ç•Œé¢/charcolor.css) ä¸­å®šä¹‰çš„è§’è‰²ä»£è¡¨è‰²ï¼š

```css
:root {
  /* è§’è‰²ä»£è¡¨è‰² */
  --clr-cocoa: #f5b0b6;   /* å¿ƒçˆ± - æ¸©æš–ç²‰è‰² */
  --clr-chino: #8ab7eb;   /* æ™ºä¹ƒ - æ¸…çˆ½è“è‰² */
  --clr-rize: #ae96d8;    /* ç†ä¸– - ä¼˜é›…ç´«è‰² */
  --clr-chiya: #87ce87;   /* åƒå¤œ - è‡ªç„¶ç»¿è‰² */
  --clr-syaro: #f5d36e;   /* çº±è·¯ - æ˜äº®é»„è‰² */
  --clr-maya: #7dd4df;    /* éº»è€¶ - æ´»åŠ›é’è‰² */
  --clr-megu: #f7a699;    /* æƒ ç¾ - æŸ”å’Œæ©™è‰² */
  --clr-fuyu: #8d8fd6;    /* å†¬ä¼˜ - æ·¡é›…ç´«è‰² */
  --clr-yura: #e58ec4;    /* ç»“è‰¯ - ç²‰ç´«è‰² */
  --clr-natsume: #ce67e8; /* å¤ç›® - é²œè‰³ç´«è‰² */
  --clr-eru: #faa548;     /* è‰¾éœ² - æ©™è‰² */
  --clr-aoyama: #4778d1;  /* é’å±± - æ·±è“è‰² */
  --clr-mate: #4bafd7;    /* é©¬ç‰¹ - å¤©è“è‰² */
  --clr-mocha: #b7df69;   /* æ‘©å¡ - é»„ç»¿è‰² */
}

/* é…è‰²æ–¹æ¡ˆé¢„è®¾ */
[data-theme="warm"] {
  --primary-bg: #faf8f5;
  --secondary-bg: #f5f0e8;
  --accent-color: #d4a574;
  --text-primary: #4a4a4a;
  --text-secondary: #7a7a7a;
  --border-color: #e8e0d5;
}

[data-theme="cool"] {
  --primary-bg: #f0f4f8;
  --secondary-bg: #e8f0f8;
  --accent-color: #6b8cae;
  --text-primary: #3a4a5a;
  --text-secondary: #6a7a8a;
  --border-color: #d0dce8;
}

[data-theme="high-contrast"] {
  --primary-bg: #ffffff;
  --secondary-bg: #f5f5f5;
  --accent-color: #1a1a1a;
  --text-primary: #000000;
  --text-secondary: #333333;
  --border-color: #cccccc;
}

[data-theme="eye-care"] {
  --primary-bg: #f5f0e6;
  --secondary-bg: #ebe5d9;
  --accent-color: #8b7355;
  --text-primary: #5a4a3a;
  --text-secondary: #7a6a5a;
  --border-color: #d5cfc3;
}
```

### 3.2 å­—ä½“è§„èŒƒ

```css
:root {
  /* é»˜è®¤å­—ä½“ */
  --font-primary: 'Noto Serif SC', 'Source Han Serif CN', serif;
  --font-heading: 'ZCOOL XiaoWei', 'Noto Serif SC', serif;
  --font-ui: 'Noto Sans SC', 'Source Han Sans CN', sans-serif;

  /* é˜…è¯»å­—ä½“ */
  --font-reading: 'LXGW WenKai', 'Noto Serif SC', serif;

  /* è‰ºæœ¯å­—ä½“ */
  --font-artistic: 'ZCOOL QingKe HuangYou', 'Noto Serif SC', serif;
}

/* å­—ä½“æ–¹æ¡ˆé¢„è®¾ */
[data-font="default"] {
  --font-body: var(--font-primary);
  --font-title: var(--font-heading);
}

[data-font="reading"] {
  --font-body: var(--font-reading);
  --font-title: var(--font-heading);
}

[data-font="artistic"] {
  --font-body: var(--font-artistic);
  --font-title: var(--font-artistic);
}
```

### 3.3 å“åº”å¼æ–­ç‚¹

```scss
// ç§»åŠ¨ç«¯ä¼˜å…ˆæ–­ç‚¹
$breakpoints: (
  'mobile': 0,        // 0-767px (é»˜è®¤)
  'tablet': 768px,    // 768px+
  'desktop': 1024px,  // 1024px+
  'wide': 1440px      // 1440px+
);

@mixin mobile {
  @media (max-width: 767px) { @content; }
}

@mixin tablet {
  @media (min-width: 768px) { @content; }
}

@mixin desktop {
  @media (min-width: 1024px) { @content; }
}
```

---

## å››ã€ç»„ä»¶è®¾è®¡

### 4.1 ç»„ä»¶æ¸…å•

| ç»„ä»¶å            | æ–‡ä»¶è·¯å¾„                           | åŠŸèƒ½æè¿°             |
| ----------------- | ---------------------------------- | -------------------- |
| StartScreen       | `components/StartScreen.vue`       | å¯åŠ¨é¡µé¢             |
| GameMain          | `components/GameMain.vue`          | ä¸»æ¸¸æˆé¡µé¢           |
| MessageDisplay    | `components/MessageDisplay.vue`    | æ¶ˆæ¯æ˜¾ç¤ºåŒº           |
| OptionsPanel      | `components/OptionsPanel.vue`      | é€‰é¡¹äº¤äº’åŒº           |
| OptionCard        | `components/OptionCard.vue`        | å•ä¸ªé€‰é¡¹å¡ç‰‡         |
| CustomOptionInput | `components/CustomOptionInput.vue` | è‡ªå®šä¹‰é€‰é¡¹è¾“å…¥       |
| CharacterBar      | `components/CharacterBar.vue`      | è§’è‰²çŠ¶æ€æ ï¼ˆå¯æŠ˜å ï¼‰ |
| CharacterAvatar   | `components/CharacterAvatar.vue`   | è§’è‰²å¤´åƒç»„ä»¶         |
| CharacterDetail   | `components/CharacterDetail.vue`   | è§’è‰²è¯¦æƒ…é¡µ           |
| HistoryMessages   | `components/HistoryMessages.vue`   | å†å²æ¶ˆæ¯é¡µ           |
| WorldbookManager  | `components/WorldbookManager.vue`  | ä¸–ç•Œä¹¦ç®¡ç†é¡µ         |
| SettingsPage      | `components/SettingsPage.vue`      | è®¾ç½®é¡µ               |
| TopNavBar         | `components/TopNavBar.vue`         | é¡¶éƒ¨å¯¼èˆªæ            |
| BackgroundLayer   | `components/BackgroundLayer.vue`   | èƒŒæ™¯è£…é¥°å±‚           |

### 4.2 æ¶ˆæ¯æ˜¾ç¤ºåŒºç»„ä»¶

**Props**:

```typescript
interface MessageDisplayProps {
  message: string;
  displayMode: 'instant' | 'typewriter' | 'segment';
  messageId: number;
}
```

**åŠŸèƒ½**ï¼š

- ä»é…’é¦†æ¶ˆæ¯æ¥¼å±‚è·å–å†…å®¹
- æ”¯æŒä¸‰ç§æ˜¾ç¤ºæ¨¡å¼
- è§£æè§’è‰²å¯¹è¯å¹¶åº”ç”¨å¯¹åº”é¢œè‰²
- æ”¯æŒMarkdownæ¸²æŸ“

### 4.3 é€‰é¡¹äº¤äº’åŒºç»„ä»¶

**æ•°æ®ç»“æ„**:

```typescript
interface RoleplayOption {
  id: string;
  title: string;
  content: string;
  isCustom?: boolean;
}

interface OptionsPanelProps {
  options: RoleplayOption[];
  allowCustom: boolean;
}
```

**äº¤äº’æµç¨‹**ï¼š

1. ç”¨æˆ·ç‚¹å‡»é€‰é¡¹
2. è°ƒç”¨ `createChatMessages()` åœ¨é…’é¦†åˆ›å»ºç”¨æˆ·æ¶ˆæ¯
3. è°ƒç”¨ `triggerSlash('/trigger')` è§¦å‘AIç”Ÿæˆ
4. AIå›å¤å‘é€åˆ°é…’é¦†
5. å‰ç«¯ç›‘å¬å¹¶æ›´æ–°æ˜¾ç¤º

### 4.4 è§’è‰²çŠ¶æ€æ ç»„ä»¶

**å¯æŠ˜å è®¾è®¡**ï¼š

```vue
<template>
  <div class="character-bar" :class="{ collapsed: isCollapsed }">
    <div class="bar-header" @click="toggleCollapse">
      <span class="toggle-icon">{{ isCollapsed ? 'â–¶' : 'â–¼' }}</span>
      <span>è§’è‰²çŠ¶æ€</span>
    </div>
    <div class="bar-content" v-show="!isCollapsed">
      <CharacterAvatar
        v-for="char in currentCharacters"
        :key="char.name"
        :character="char"
        @click="showDetail(char)"
      />
    </div>
  </div>
</template>
```

### 4.5 å†å²æ¶ˆæ¯ç»„ä»¶

**å®ç°æ–¹å¼**ï¼š

```typescript
// ä½¿ç”¨ /messages æ–œæ å‘½ä»¤è·å–å†å²æ¶ˆæ¯
async function loadHistoryMessages(startId: number, count: number) {
  const messages = await triggerSlash(`/messages ${startId}-${startId + count}`);
  return parseMessages(messages);
}

// æˆ–è€…ä½¿ç”¨é…’é¦†åŠ©æ‰‹API
async function loadHistoryMessagesAPI() {
  const chatLength = SillyTavern.chat.length;
  const messages = [];
  for (let i = 0; i < Math.min(chatLength, 50); i++) {
    const msg = getChatMessages(i)[0];
    messages.push(msg);
  }
  return messages;
}
```

### 4.6 ä¸–ç•Œä¹¦ç®¡ç†ç»„ä»¶

**å®ç°æ–¹å¼**ï¼š

```typescript
// è·å–ä¸–ç•Œä¹¦
async function loadWorldbook() {
  const worldbook = await getWorldbook({ type: 'character' });
  return worldbook.entries;
}

// åˆ‡æ¢æ¡ç›®çŠ¶æ€
async function toggleEntry(uid: string, enabled: boolean) {
  await setWorldbookEntryField({
    file: 'character',
    uid,
    field: 'disable',
    value: !enabled
  });
}
```

---

## äº”ã€èµ„æºæ¸…å•

### 5.1 ç«‹ç»˜èµ„æº

ä½äº [`src/ç•Œé¢/assets/portraits`](src/ç•Œé¢/assets/portraits)ï¼š

| æ–‡ä»¶å      | è§’è‰²              | å¯¹åº”å˜é‡å |
| ----------- | ----------------- | ---------- |
| cocoa.png   | ä¿ç™»å¿ƒçˆ±          | ä¿ç™»å¿ƒçˆ±   |
| chino.png   | é¦™é£æ™ºä¹ƒ          | é¦™é£æ™ºä¹ƒ   |
| rize.png    | å¤©å¤©åº§ç†ä¸–        | å¤©å¤©åº§ç†ä¸– |
| chiya.png   | å®‡æ²»æ¾åƒå¤œ        | å®‡æ²»æ¾åƒå¤œ |
| syaro.png   | æ¡é—´çº±è·¯          | æ¡é—´çº±è·¯   |
| maya.png    | æ¡æ²³éº»è€¶          | æ¡æ²³éº»è€¶   |
| megu.png    | å¥ˆæ´¥æƒ             | å¥ˆæ´¥æƒ      |
| mocha.png   | ä¿ç™»æ‘©å¡          | ä¿ç™»æ‘©å¡   |
| aoyama.png  | é’å±±è“å±±          | é’å±±è“å±±   |
| mate.png    | çœŸæ‰‹å‡›            | çœŸæ‰‹å‡›     |
| eru.png     | ç¥æ²™æ˜ æœˆ          | ç¥æ²™æ˜ æœˆ   |
| fuyu.png    | é£è¡£å¶å†¬ä¼˜        | é£è¡£å¶å†¬ä¼˜ |
| yura.png    | ç‹©æ‰‹ç»“è‰¯          | ç‹©æ‰‹ç»“è‰¯   |
| natsume.png | ç¥æ²™å¤æ˜          | ç¥æ²™å¤æ˜   |

### 5.2 å›¾æ ‡èµ„æº

ä½äº [`src/ç•Œé¢/assets/icons`](src/ç•Œé¢/assets/icons)ï¼š

| æ–‡ä»¶å           | ç”¨é€”        |
| ---------------- | ----------- |
| logo_shingle.png | Logoå›¾æ ‡    |
| title_brown.svg  | æ£•è‰²æ ‡é¢˜SVG |
| title_white.svg  | ç™½è‰²æ ‡é¢˜SVG |

### 5.3 è£…é¥°å›¾æ¡ˆ

ä½äº [`src/ç•Œé¢/assets/patterns`](src/ç•Œé¢/assets/patterns)ï¼š

- æ³•å¼èŠ±çº¹èƒŒæ™¯
- è¾¹æ¡†è£…é¥°

---

## å…­ã€çŠ¶æ€ç®¡ç†

### 6.1 Pinia Store ç»“æ„

```typescript
// stores/gameStore.ts
export const useGameStore = defineStore('game', () => {
  // å½“å‰é¡µé¢çŠ¶æ€
  const currentPage = ref<'start' | 'game' | 'character' | 'history' | 'worldbook' | 'settings'>('start');

  // å½“å‰æ¶ˆæ¯
  const currentMessage = ref<string>('');
  const currentMessageId = ref<number>(0);

  // å½“å‰é€‰é¡¹
  const options = ref<RoleplayOption[]>([]);

  // å½“å‰åœºæ™¯è§’è‰²
  const currentCharacters = ref<string[]>([]);

  // UIçŠ¶æ€
  const isCharacterBarCollapsed = ref(false);
  const isFullscreen = ref(false);

  return {
    currentPage,
    currentMessage,
    currentMessageId,
    options,
    currentCharacters,
    isCharacterBarCollapsed,
    isFullscreen
  };
});

// stores/settingsStore.ts
export const useSettingsStore = defineStore('settings', () => {
  const settings = ref({
    messageDisplayMode: 'instant' as 'instant' | 'typewriter' | 'segment',
    theme: 'warm' as 'warm' | 'cool' | 'high-contrast' | 'eye-care',
    fontScheme: 'default' as 'default' | 'reading' | 'artistic',
    fontSize: 'medium' as 'small' | 'medium' | 'large',
    autoScroll: true
  });

  // æŒä¹…åŒ–åˆ° localStorage
  watchEffect(() => {
    localStorage.setItem('gameSettings', JSON.stringify(settings.value));
  });

  return { settings };
});

// stores/characterStore.ts - ä½¿ç”¨MVUæ•°æ®
export const useCharacterStore = defineMvuDataStore(
  Schema,
  { type: 'message', message_id: () => getCurrentMessageId() }
);
```

---

## ä¸ƒã€æ–‡ä»¶ç»“æ„è§„åˆ’

```
src/è§’è‰²å¡/ç•Œé¢/åŒå±‚å‰ç«¯/
â”œâ”€â”€ index.html              # å…¥å£HTML
â”œâ”€â”€ index.ts                # å…¥å£è„šæœ¬
â”œâ”€â”€ App.vue                 # ä¸»åº”ç”¨ç»„ä»¶ï¼ˆå«è·¯ç”±ï¼‰
â”œâ”€â”€ global.scss             # å…¨å±€æ ·å¼
â”‚
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ StartScreen.vue         # å¯åŠ¨é¡µé¢
â”‚   â”œâ”€â”€ GameMain.vue            # ä¸»æ¸¸æˆé¡µé¢
â”‚   â”œâ”€â”€ MessageDisplay.vue      # æ¶ˆæ¯æ˜¾ç¤ºåŒº
â”‚   â”œâ”€â”€ OptionsPanel.vue        # é€‰é¡¹äº¤äº’åŒº
â”‚   â”œâ”€â”€ OptionCard.vue          # å•ä¸ªé€‰é¡¹å¡ç‰‡
â”‚   â”œâ”€â”€ CustomOptionInput.vue   # è‡ªå®šä¹‰é€‰é¡¹è¾“å…¥
â”‚   â”œâ”€â”€ CharacterBar.vue        # è§’è‰²çŠ¶æ€æ 
â”‚   â”œâ”€â”€ CharacterAvatar.vue     # è§’è‰²å¤´åƒç»„ä»¶
â”‚   â”œâ”€â”€ CharacterDetail.vue     # è§’è‰²è¯¦æƒ…é¡µ
â”‚   â”œâ”€â”€ HistoryMessages.vue     # å†å²æ¶ˆæ¯é¡µ
â”‚   â”œâ”€â”€ WorldbookManager.vue    # ä¸–ç•Œä¹¦ç®¡ç†é¡µ
â”‚   â”œâ”€â”€ SettingsPage.vue        # è®¾ç½®é¡µ
â”‚   â”œâ”€â”€ TopNavBar.vue           # é¡¶éƒ¨å¯¼èˆªæ 
â”‚   â””â”€â”€ BackgroundLayer.vue     # èƒŒæ™¯è£…é¥°å±‚
â”‚
â”œâ”€â”€ stores/
â”‚   â”œâ”€â”€ gameStore.ts            # æ¸¸æˆçŠ¶æ€
â”‚   â”œâ”€â”€ settingsStore.ts        # è®¾ç½®çŠ¶æ€
â”‚   â””â”€â”€ characterStore.ts       # è§’è‰²æ•°æ®ï¼ˆMVUï¼‰
â”‚
â”œâ”€â”€ composables/
â”‚   â”œâ”€â”€ useMessage.ts           # æ¶ˆæ¯å¤„ç†é€»è¾‘
â”‚   â”œâ”€â”€ useOptions.ts           # é€‰é¡¹å¤„ç†é€»è¾‘
â”‚   â”œâ”€â”€ useCharacters.ts        # è§’è‰²çŠ¶æ€é€»è¾‘
â”‚   â”œâ”€â”€ useHistory.ts           # å†å²æ¶ˆæ¯é€»è¾‘
â”‚   â”œâ”€â”€ useWorldbook.ts         # ä¸–ç•Œä¹¦ç®¡ç†é€»è¾‘
â”‚   â””â”€â”€ useFullscreen.ts        # å…¨å±æ§åˆ¶é€»è¾‘
â”‚
â”œâ”€â”€ styles/
â”‚   â”œâ”€â”€ _variables.scss         # æ ·å¼å˜é‡
â”‚   â”œâ”€â”€ _mixins.scss            # æ ·å¼æ··å…¥
â”‚   â”œâ”€â”€ _animations.scss        # åŠ¨ç”»å®šä¹‰
â”‚   â”œâ”€â”€ _themes.scss            # ä¸»é¢˜æ ·å¼
â”‚   â””â”€â”€ _decorations.scss       # è£…é¥°æ ·å¼
â”‚
â””â”€â”€ assets/
    â”œâ”€â”€ portraits/              # è§’è‰²ç«‹ç»˜ï¼ˆç¬¦å·é“¾æ¥åˆ° src/ç•Œé¢/assets/portraitsï¼‰
    â”œâ”€â”€ icons/                  # å›¾æ ‡èµ„æº
    â””â”€â”€ patterns/               # è£…é¥°å›¾æ¡ˆ
```

---

## å…«ã€å®ç°ä¼˜å…ˆçº§

### ç¬¬ä¸€é˜¶æ®µï¼šåŸºç¡€æ¡†æ¶

1. å¯åŠ¨é¡µé¢ç»„ä»¶
2. ä¸»æ¸¸æˆé¡µé¢æ¡†æ¶
3. è·¯ç”±ç³»ç»Ÿ
4. åŸºç¡€æ ·å¼ç³»ç»Ÿ

### ç¬¬äºŒé˜¶æ®µï¼šæ ¸å¿ƒåŠŸèƒ½

1. æ¶ˆæ¯æ˜¾ç¤ºåŒºç»„ä»¶
2. é€‰é¡¹äº¤äº’åŒºç»„ä»¶
3. MVUæ•°æ®ç»‘å®š
4. é…’é¦†æ¶ˆæ¯åŒæ­¥

### ç¬¬ä¸‰é˜¶æ®µï¼šè§’è‰²ç³»ç»Ÿ

1. è§’è‰²çŠ¶æ€æ ç»„ä»¶ï¼ˆå¯æŠ˜å ï¼‰
2. è§’è‰²è¯¦æƒ…é¡µ
3. è§’è‰²æ•°æ®åŒæ­¥

### ç¬¬å››é˜¶æ®µï¼šæ‰©å±•åŠŸèƒ½

1. å†å²æ¶ˆæ¯é¡µ
2. ä¸–ç•Œä¹¦ç®¡ç†é¡µ
3. è®¾ç½®é¡µ

### ç¬¬äº”é˜¶æ®µï¼šä¼˜åŒ–æ‰“ç£¨

1. ä¸»é¢˜åˆ‡æ¢
2. å­—ä½“åˆ‡æ¢
3. åŠ¨ç”»æ•ˆæœ
4. æ€§èƒ½ä¼˜åŒ–

---

## ä¹ã€å¾…åŠäº‹é¡¹

- [ ] ç½‘æ˜“äº‘éŸ³ä¹iframeå¤–é“¾æ’­æ”¾å™¨é›†æˆï¼ˆæš‚ä¸å®ç°ï¼‰
- [ ] å­˜æ¡£/è¯»æ¡£åŠŸèƒ½ï¼ˆå¾…è®¨è®ºï¼‰
- [ ] å¤šè¯­è¨€æ”¯æŒï¼ˆå¾…è®¨è®ºï¼‰

---

*æ–‡æ¡£ç‰ˆæœ¬: 2.0*
*æ›´æ–°æ—¥æœŸ: 2026-02-25*
*ä½œè€…: Kilo Code*
