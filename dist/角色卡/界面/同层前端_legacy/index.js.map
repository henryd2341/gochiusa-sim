{"version":3,"file":"index.js","mappings":"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","sources":["src://tavern_helper_template/external var \"_\"","src://tavern_helper_template/src/角色卡/界面/同层前端_legacy/stores/characterStore.ts","src://tavern_helper_template/src/角色卡/界面/同层前端_legacy/stores/gameStore.ts","src://tavern_helper_template/src/角色卡/界面/同层前端_legacy/stores/settingsStore.ts","src://tavern_helper_template/src/角色卡/界面/同层前端_legacy/utils/toast.ts","webpack://tavern_helper_template/./src/角色卡/界面/同层前端_legacy/components/CharacterDetail.vue?8c12","webpack://tavern_helper_template/src/角色卡/界面/同层前端_legacy/components/CharacterDetail.vue?3ef4","webpack://tavern_helper_template/./src/角色卡/界面/同层前端_legacy/components/CharacterAvatar.vue?092a","webpack://tavern_helper_template/src/角色卡/界面/同层前端_legacy/components/CharacterAvatar.vue?bc78","webpack://tavern_helper_template/./src/角色卡/界面/同层前端_legacy/components/CharacterBar.vue?2f45","webpack://tavern_helper_template/src/角色卡/界面/同层前端_legacy/components/CharacterBar.vue?9d6d","webpack://tavern_helper_template/./src/角色卡/界面/同层前端_legacy/components/MessageDisplay.vue?019e","webpack://tavern_helper_template/src/角色卡/界面/同层前端_legacy/components/MessageDisplay.vue?77d1","webpack://tavern_helper_template/./src/角色卡/界面/同层前端_legacy/components/OptionCard.vue?7aa5","webpack://tavern_helper_template/src/角色卡/界面/同层前端_legacy/components/OptionCard.vue?7f20","webpack://tavern_helper_template/./src/角色卡/界面/同层前端_legacy/components/CustomOptionInput.vue?b55d","webpack://tavern_helper_template/src/角色卡/界面/同层前端_legacy/components/CustomOptionInput.vue?be02","webpack://tavern_helper_template/./src/角色卡/界面/同层前端_legacy/components/OptionsPanel.vue?3821","webpack://tavern_helper_template/src/角色卡/界面/同层前端_legacy/components/OptionsPanel.vue?a5b7","webpack://tavern_helper_template/./src/角色卡/界面/同层前端_legacy/components/TopNavBar.vue?c54d","webpack://tavern_helper_template/src/角色卡/界面/同层前端_legacy/components/TopNavBar.vue?4aaa","webpack://tavern_helper_template/./src/角色卡/界面/同层前端_legacy/components/GameMain.vue?e89b","webpack://tavern_helper_template/src/角色卡/界面/同层前端_legacy/components/GameMain.vue?92ed","webpack://tavern_helper_template/./src/角色卡/界面/同层前端_legacy/components/HistoryMessages.vue?fb10","webpack://tavern_helper_template/src/角色卡/界面/同层前端_legacy/components/HistoryMessages.vue?5a91","webpack://tavern_helper_template/./src/角色卡/界面/同层前端_legacy/components/SettingsPage.vue?3b76","webpack://tavern_helper_template/src/角色卡/界面/同层前端_legacy/components/SettingsPage.vue?8b09","webpack://tavern_helper_template/./src/角色卡/界面/同层前端_legacy/components/StartScreen.vue?c60d","webpack://tavern_helper_template/src/角色卡/界面/同层前端_legacy/components/StartScreen.vue?5cc6","webpack://tavern_helper_template/./src/角色卡/界面/同层前端_legacy/components/WorldbookManager.vue?2f3b","webpack://tavern_helper_template/src/角色卡/界面/同层前端_legacy/components/WorldbookManager.vue?9a7d","src://tavern_helper_template/node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js","src://tavern_helper_template/external module \"https://testingcf.jsdelivr.net/npm/pinia/+esm\"","src://tavern_helper_template/external module \"https://testingcf.jsdelivr.net/npm/vue-router/+esm\"","src://tavern_helper_template/external module \"https://testingcf.jsdelivr.net/npm/vue/+esm\"","src://tavern_helper_template/webpack/bootstrap","src://tavern_helper_template/webpack/runtime/compat get default export","src://tavern_helper_template/webpack/runtime/define property getters","src://tavern_helper_template/webpack/runtime/hasOwnProperty shorthand","src://tavern_helper_template/webpack/runtime/make namespace object","webpack://tavern_helper_template/./src/角色卡/界面/同层前端_legacy/components/BackgroundLayer.vue?ca4e","webpack://tavern_helper_template/src/角色卡/界面/同层前端_legacy/components/BackgroundLayer.vue?c92e","webpack://tavern_helper_template/./src/角色卡/界面/同层前端_legacy/App.vue?d208","webpack://tavern_helper_template/src/角色卡/界面/同层前端_legacy/App.vue?9d8f","src://tavern_helper_template/src/角色卡/界面/同层前端_legacy/index.ts"],"sourcesContent":["const __WEBPACK_NAMESPACE_OBJECT__ = _;","import waitUntil from 'async-wait-until';\nimport _ from 'lodash';\nimport { defineStore } from 'pinia';\n// 角色名称映射（中文名 -> 英文文件名）\nexport const CHARACTER_NAME_MAP = {\n    保登心爱: 'qjltca',\n    香风智乃: '6t09pw',\n    天天座理世: 'n9szhx',\n    宇治松千夜: 'v4spnt',\n    桐间纱路: 'b982xz',\n    条河麻耶: 'bmw44n',\n    奈津惠: 'koovsy',\n    风衣叶冬优: 'lckv74',\n    神沙夏明: 'usclrp',\n    神沙映月: 'r10sh1',\n    狩手结良: 'a3uv0i',\n    青山蓝山: 'x18i00',\n    真手凛: 'kk59ir',\n    保登摩卡: 'hi872c',\n};\n// 角色颜色映射\nexport const CHARACTER_COLOR_MAP = {\n    保登心爱: 'var(--clr-cocoa)',\n    香风智乃: 'var(--clr-chino)',\n    天天座理世: 'var(--clr-rize)',\n    宇治松千夜: 'var(--clr-chiya)',\n    桐间纱路: 'var(--clr-syaro)',\n    条河麻耶: 'var(--clr-maya)',\n    奈津惠: 'var(--clr-megu)',\n    风衣叶冬优: 'var(--clr-fuyu)',\n    神沙夏明: 'var(--clr-natsume)',\n    神沙映月: 'var(--clr-eru)',\n    狩手结良: 'var(--clr-yura)',\n    青山蓝山: 'var(--clr-aoyama)',\n    真手凛: 'var(--clr-mate)',\n    保登摩卡: 'var(--clr-mocha)',\n};\nfunction isRecord(value) {\n    return typeof value === 'object' && value !== null;\n}\n// 获取角色立绘路径\nexport function getCharacterPortrait(name) {\n    const fileName = CHARACTER_NAME_MAP[name];\n    if (fileName) {\n        // 使用相对路径指向 assets/portraits\n        return `https://files.catbox.moe/${fileName}.png`;\n    }\n    return '';\n}\n// 获取角色颜色\nexport function getCharacterColor(name) {\n    return CHARACTER_COLOR_MAP[name] || 'var(--text-primary)';\n}\nexport const useCharacterStore = defineStore('character', () => {\n    // MVU 数据\n    const mvuData = ref(null);\n    const isInitialized = ref(false);\n    let stopMessageListener = null;\n    // 初始化 MVU 数据\n    async function initialize() {\n        if (isInitialized.value)\n            return;\n        try {\n            // 等待 MVU 框架初始化\n            await waitGlobalInitialized('Mvu');\n            // 等待消息楼层变量被正确设置\n            await waitUntil(() => {\n                const data = Mvu.getMvuData({ type: 'message', message_id: getCurrentMessageId() });\n                return _.has(data, 'stat_data');\n            });\n            // 获取数据\n            await refreshData();\n            isInitialized.value = true;\n            console.info('[角色数据] 初始化成功');\n        }\n        catch (e) {\n            console.error('[角色数据] 初始化失败:', e);\n        }\n    }\n    // 刷新数据\n    async function refreshData() {\n        try {\n            const data = Mvu.getMvuData({ type: 'message', message_id: getCurrentMessageId() });\n            const statData = _.get(data, 'stat_data');\n            if (isRecord(statData)) {\n                mvuData.value = statData;\n            }\n        }\n        catch (e) {\n            console.warn('[角色数据] 刷新失败:', e);\n        }\n    }\n    // 获取角色数据\n    function getCharacterData(name) {\n        if (!mvuData.value)\n            return null;\n        return mvuData.value[name];\n    }\n    // 获取当前场景角色列表\n    function getCurrentSceneCharacters() {\n        if (!mvuData.value)\n            return [];\n        const names = mvuData.value.当前场景角色;\n        return Array.isArray(names) ? names : [];\n    }\n    // 获取世界信息\n    function getWorldInfo() {\n        if (!mvuData.value)\n            return null;\n        return mvuData.value.世界;\n    }\n    // 获取主视角角色\n    function getMainPOV() {\n        if (!mvuData.value)\n            return '无';\n        return typeof mvuData.value._主视角 === 'string' ? mvuData.value._主视角 : '无';\n    }\n    // 监听消息变化刷新数据\n    function setupMessageListener() {\n        if (stopMessageListener)\n            return;\n        stopMessageListener = eventOn(tavern_events.CHARACTER_MESSAGE_RENDERED, async () => {\n            await refreshData();\n        });\n    }\n    function cleanupMessageListener() {\n        stopMessageListener?.stop();\n        stopMessageListener = null;\n    }\n    return {\n        mvuData,\n        isInitialized,\n        initialize,\n        refreshData,\n        getCharacterData,\n        getCurrentSceneCharacters,\n        getWorldInfo,\n        getMainPOV,\n        setupMessageListener,\n        cleanupMessageListener,\n    };\n});\n","import { defineStore } from 'pinia';\nexport const useGameStore = defineStore('game', () => {\n    // 页面状态\n    const currentPage = ref('start');\n    // 消息状态\n    const currentMessage = ref('');\n    const currentMessageId = ref(0);\n    // 选项状态\n    const options = ref([]);\n    // 角色状态\n    const currentCharacters = ref([]);\n    // UI 状态\n    const isCharacterBarCollapsed = ref(false);\n    const isFullscreen = ref(false);\n    const isLoading = ref(false);\n    const isGenerating = ref(false);\n    // 选中的角色（用于详情页）\n    const selectedCharacter = ref(null);\n    // 页面导航\n    function navigateTo(page) {\n        currentPage.value = page;\n    }\n    // 更新消息\n    function updateMessage(message, messageId) {\n        currentMessage.value = message;\n        currentMessageId.value = messageId;\n    }\n    // 更新选项\n    function updateOptions(newOptions) {\n        options.value = newOptions;\n    }\n    // 添加自定义选项\n    function addCustomOption(title, content) {\n        const newOption = {\n            id: `custom-${Date.now()}`,\n            title: title || '自定义行动',\n            content,\n            isCustom: true,\n        };\n        options.value.push(newOption);\n    }\n    // 移除选项\n    function removeOption(optionId) {\n        const index = options.value.findIndex(opt => opt.id === optionId);\n        if (index !== -1) {\n            options.value.splice(index, 1);\n        }\n    }\n    // 更新当前场景角色\n    function updateCurrentCharacters(characters) {\n        currentCharacters.value = characters;\n    }\n    // 切换角色栏折叠状态\n    function toggleCharacterBar() {\n        isCharacterBarCollapsed.value = !isCharacterBarCollapsed.value;\n    }\n    // 切换全屏\n    function toggleFullscreen() {\n        isFullscreen.value = !isFullscreen.value;\n        if (isFullscreen.value) {\n            document.documentElement.requestFullscreen?.();\n        }\n        else {\n            document.exitFullscreen?.();\n        }\n    }\n    // 选择角色\n    function selectCharacter(name) {\n        selectedCharacter.value = name;\n    }\n    // 设置加载状态\n    function setLoading(loading) {\n        isLoading.value = loading;\n    }\n    // 设置生成状态\n    function setGenerating(generating) {\n        isGenerating.value = generating;\n    }\n    return {\n        // State\n        currentPage,\n        currentMessage,\n        currentMessageId,\n        options,\n        currentCharacters,\n        isCharacterBarCollapsed,\n        isFullscreen,\n        isLoading,\n        isGenerating,\n        selectedCharacter,\n        // Actions\n        navigateTo,\n        updateMessage,\n        updateOptions,\n        addCustomOption,\n        removeOption,\n        updateCurrentCharacters,\n        toggleCharacterBar,\n        toggleFullscreen,\n        selectCharacter,\n        setLoading,\n        setGenerating,\n    };\n});\n","import { defineStore } from 'pinia';\n// 默认设置\nconst defaultSettings = {\n    messageDisplayMode: 'instant',\n    theme: 'warm',\n    fontScheme: 'default',\n    fontSize: 'medium',\n    enableAnimations: true,\n    typewriterEffect: true,\n    autoScroll: true,\n    showCharacterBar: true,\n    backgroundBlur: 8,\n    allowCustomOptions: true,\n};\nconst DISPLAY_MODE_MAP = {\n    instant: 'instant',\n    typewriter: 'typewriter',\n    segment: 'segment',\n    card: 'instant',\n    bubble: 'segment',\n    classic: 'instant',\n};\nconst THEME_MAP = {\n    warm: 'warm',\n    cool: 'cool',\n    'high-contrast': 'high-contrast',\n    'eye-care': 'eye-care',\n    light: 'warm',\n    dark: 'high-contrast',\n    sakura: 'warm',\n    ocean: 'cool',\n};\nconst FONT_SCHEME_MAP = {\n    default: 'default',\n    reading: 'reading',\n    artistic: 'artistic',\n    elegant: 'reading',\n    modern: 'default',\n    classic: 'artistic',\n};\nfunction normalizeDisplayMode(value) {\n    if (typeof value === 'string' && DISPLAY_MODE_MAP[value]) {\n        return DISPLAY_MODE_MAP[value];\n    }\n    return defaultSettings.messageDisplayMode;\n}\nfunction normalizeTheme(value) {\n    if (typeof value === 'string' && THEME_MAP[value]) {\n        return THEME_MAP[value];\n    }\n    return defaultSettings.theme;\n}\nfunction normalizeFontScheme(value) {\n    if (typeof value === 'string' && FONT_SCHEME_MAP[value]) {\n        return FONT_SCHEME_MAP[value];\n    }\n    return defaultSettings.fontScheme;\n}\nfunction normalizeFontSize(value) {\n    if (value === 'small' || value === 'medium' || value === 'large') {\n        return value;\n    }\n    if (typeof value === 'number') {\n        if (value <= 14)\n            return 'small';\n        if (value >= 18)\n            return 'large';\n        return 'medium';\n    }\n    return defaultSettings.fontSize;\n}\nfunction normalizeSettings(parsed) {\n    return {\n        messageDisplayMode: normalizeDisplayMode(parsed.messageDisplayMode),\n        theme: normalizeTheme(parsed.theme),\n        fontScheme: normalizeFontScheme(parsed.fontScheme),\n        fontSize: normalizeFontSize(parsed.fontSize),\n        enableAnimations: typeof parsed.enableAnimations === 'boolean' ? parsed.enableAnimations : defaultSettings.enableAnimations,\n        typewriterEffect: typeof parsed.typewriterEffect === 'boolean' ? parsed.typewriterEffect : defaultSettings.typewriterEffect,\n        autoScroll: typeof parsed.autoScroll === 'boolean' ? parsed.autoScroll : defaultSettings.autoScroll,\n        showCharacterBar: typeof parsed.showCharacterBar === 'boolean' ? parsed.showCharacterBar : defaultSettings.showCharacterBar,\n        backgroundBlur: typeof parsed.backgroundBlur === 'number' ? parsed.backgroundBlur : defaultSettings.backgroundBlur,\n        allowCustomOptions: typeof parsed.allowCustomOptions === 'boolean' ? parsed.allowCustomOptions : defaultSettings.allowCustomOptions,\n    };\n}\n// 从 localStorage 加载设置\nfunction loadSettings() {\n    try {\n        const saved = localStorage.getItem('gochiusa-game-settings');\n        if (saved) {\n            const parsed = JSON.parse(saved);\n            return normalizeSettings(parsed);\n        }\n    }\n    catch (e) {\n        console.warn('[设置] 加载设置失败:', e);\n    }\n    return { ...defaultSettings };\n}\nexport const useSettingsStore = defineStore('settings', () => {\n    const settings = ref(loadSettings());\n    // 更新设置\n    function updateSettings(newSettings) {\n        settings.value = { ...settings.value, ...newSettings };\n        saveSettings();\n    }\n    // 重置设置\n    function resetSettings() {\n        settings.value = { ...defaultSettings };\n        saveSettings();\n    }\n    // 保存设置到 localStorage\n    function saveSettings() {\n        try {\n            localStorage.setItem('gochiusa-game-settings', JSON.stringify(settings.value));\n        }\n        catch (e) {\n            console.warn('[设置] 保存设置失败:', e);\n        }\n    }\n    // 监听变化自动保存\n    watchEffect(() => {\n        saveSettings();\n    });\n    return {\n        settings,\n        updateSettings,\n        resetSettings,\n    };\n});\n","type ToastLevel = 'success' | 'error' | 'warning' | 'info';\n\ninterface ToastrLike {\n  success?: (msg: string) => void;\n  error?: (msg: string) => void;\n  warning?: (msg: string) => void;\n  info?: (msg: string) => void;\n}\n\nfunction canUseToastr(): boolean {\n  return typeof globalThis !== 'undefined' && typeof (globalThis as { toastr?: unknown }).toastr !== 'undefined';\n}\n\nfunction notify(level: ToastLevel, message: string) {\n  if (canUseToastr()) {\n    const toastrRef = (globalThis as unknown as { toastr?: ToastrLike }).toastr;\n    const handler = toastrRef?.[level];\n    if (typeof handler === 'function') {\n      handler(message);\n      return;\n    }\n  }\n\n  const logger = level === 'error' ? console.error : console.info;\n  logger(`[同层前端:${level}] ${message}`);\n}\n\nexport function toastSuccess(message: string) {\n  notify('success', message);\n}\n\nexport function toastError(message: string) {\n  notify('error', message);\n}\n","import { defineComponent as _defineComponent } from 'vue';\nimport { createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, unref as _unref, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, normalizeStyle as _normalizeStyle, createTextVNode as _createTextVNode, renderList as _renderList, Fragment as _Fragment } from \"vue\";\nconst _hoisted_1 = { class: \"character-detail\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"loading-state\"\n};\nconst _hoisted_3 = { class: \"detail-content\" };\nconst _hoisted_4 = { class: \"portrait-section\" };\nconst _hoisted_5 = [\"src\", \"alt\"];\nconst _hoisted_6 = {\n    key: 1,\n    class: \"portrait-placeholder\"\n};\nconst _hoisted_7 = { class: \"character-name\" };\nconst _hoisted_8 = { class: \"status-section\" };\nconst _hoisted_9 = { class: \"status-item\" };\nconst _hoisted_10 = { class: \"status-value\" };\nconst _hoisted_11 = { class: \"status-item\" };\nconst _hoisted_12 = { class: \"status-value\" };\nconst _hoisted_13 = { class: \"status-item\" };\nconst _hoisted_14 = { class: \"status-value\" };\nconst _hoisted_15 = {\n    key: 0,\n    class: \"items-section\"\n};\nconst _hoisted_16 = { class: \"items-list\" };\nconst _hoisted_17 = { class: \"item-info\" };\nconst _hoisted_18 = { class: \"item-name\" };\nconst _hoisted_19 = { class: \"item-desc\" };\nconst _hoisted_20 = { class: \"item-count\" };\nimport { useRoute, useRouter } from 'vue-router';\nimport { CHARACTER_COLOR_MAP, CHARACTER_NAME_MAP, useCharacterStore } from '../stores/characterStore';\n\nimport { computed, ref, onMounted } from 'vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'CharacterDetail',\n    setup(__props) {\n        const router = useRouter();\n        const route = useRoute();\n        const characterStore = useCharacterStore();\n        const characterName = computed(() => {\n            const name = route.params.name;\n            return decodeURIComponent(name);\n        });\n        const characterData = computed(() => {\n            return characterStore.getCharacterData(characterName.value);\n        });\n        const portraitUrl = computed(() => {\n            const fileName = CHARACTER_NAME_MAP[characterName.value];\n            if (fileName) {\n                return `https://files.catbox.moe/${fileName}.png`;\n            }\n            return '';\n        });\n        const characterColor = computed(() => {\n            return CHARACTER_COLOR_MAP[characterName.value] || 'var(--text-primary)';\n        });\n        const hasItems = computed(() => {\n            return characterData.value?.关键物品 && Object.keys(characterData.value.关键物品).length > 0;\n        });\n        const isLoading = ref(true);\n        onMounted(async () => {\n            await characterStore.refreshData();\n            isLoading.value = false;\n        });\n        function goBack() {\n            router.push('/game');\n        }\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createCommentVNode(\" Header \"),\n                _createElementVNode(\"header\", { class: \"detail-header\" }, [\n                    _createElementVNode(\"button\", {\n                        class: \"back-btn\",\n                        onClick: goBack\n                    }, [...(_cache[0] || (_cache[0] = [\n                            _createElementVNode(\"i\", { class: \"fa-solid fa-arrow-left\" }, null, -1 /* CACHED */)\n                        ]))]),\n                    _cache[1] || (_cache[1] = _createElementVNode(\"h1\", { class: \"header-title\" }, \"角色详情\", -1 /* CACHED */))\n                ]),\n                _createCommentVNode(\" Loading State \"),\n                (_unref(isLoading))\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [...(_cache[2] || (_cache[2] = [\n                            _createElementVNode(\"div\", { class: \"loading-spinner\" }, null, -1 /* CACHED */),\n                            _createElementVNode(\"span\", null, \"加载中...\", -1 /* CACHED */)\n                        ]))]))\n                    : (_unref(characterData))\n                        ? (_openBlock(), _createElementBlock(_Fragment, { key: 1 }, [\n                            _createCommentVNode(\" Content \"),\n                            _createElementVNode(\"main\", _hoisted_3, [\n                                _createCommentVNode(\" Portrait Section \"),\n                                _createElementVNode(\"div\", _hoisted_4, [\n                                    _createElementVNode(\"div\", {\n                                        class: \"portrait-container\",\n                                        style: _normalizeStyle({ '--character-color': _unref(characterColor) })\n                                    }, [\n                                        (_unref(portraitUrl))\n                                            ? (_openBlock(), _createElementBlock(\"img\", {\n                                                key: 0,\n                                                src: _unref(portraitUrl),\n                                                alt: _unref(characterName),\n                                                class: \"portrait-image\"\n                                            }, null, 8 /* PROPS */, _hoisted_5))\n                                            : (_openBlock(), _createElementBlock(\"div\", _hoisted_6, [\n                                                _createElementVNode(\"span\", null, _toDisplayString(_unref(characterName)?.charAt(0)), 1 /* TEXT */)\n                                            ]))\n                                    ], 4 /* STYLE */),\n                                    _createElementVNode(\"h2\", _hoisted_7, _toDisplayString(_unref(characterName)), 1 /* TEXT */)\n                                ]),\n                                _createCommentVNode(\" Status Section \"),\n                                _createElementVNode(\"div\", _hoisted_8, [\n                                    _createElementVNode(\"div\", _hoisted_9, [\n                                        _cache[3] || (_cache[3] = _createElementVNode(\"i\", { class: \"fa-solid fa-location-dot\" }, null, -1 /* CACHED */)),\n                                        _cache[4] || (_cache[4] = _createElementVNode(\"span\", { class: \"status-label\" }, \"位置\", -1 /* CACHED */)),\n                                        _createElementVNode(\"span\", _hoisted_10, _toDisplayString(_unref(characterData).当前位置 || '未知'), 1 /* TEXT */)\n                                    ]),\n                                    _createElementVNode(\"div\", _hoisted_11, [\n                                        _cache[5] || (_cache[5] = _createElementVNode(\"i\", { class: \"fa-solid fa-face-smile\" }, null, -1 /* CACHED */)),\n                                        _cache[6] || (_cache[6] = _createElementVNode(\"span\", { class: \"status-label\" }, \"心情\", -1 /* CACHED */)),\n                                        _createElementVNode(\"span\", _hoisted_12, _toDisplayString(_unref(characterData).心情状态 || '未知'), 1 /* TEXT */)\n                                    ]),\n                                    _createElementVNode(\"div\", _hoisted_13, [\n                                        _cache[7] || (_cache[7] = _createElementVNode(\"i\", { class: \"fa-solid fa-shirt\" }, null, -1 /* CACHED */)),\n                                        _cache[8] || (_cache[8] = _createElementVNode(\"span\", { class: \"status-label\" }, \"着装\", -1 /* CACHED */)),\n                                        _createElementVNode(\"span\", _hoisted_14, _toDisplayString(_unref(characterData).着装 || '未知'), 1 /* TEXT */)\n                                    ])\n                                ]),\n                                _createCommentVNode(\" Items Section \"),\n                                (_unref(hasItems))\n                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_15, [\n                                        _cache[10] || (_cache[10] = _createElementVNode(\"h3\", { class: \"section-title\" }, [\n                                            _createElementVNode(\"i\", { class: \"fa-solid fa-box\" }),\n                                            _createTextVNode(\" 关键物品 \")\n                                        ], -1 /* CACHED */)),\n                                        _createElementVNode(\"div\", _hoisted_16, [\n                                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(characterData).关键物品, (item, name) => {\n                                                return (_openBlock(), _createElementBlock(\"div\", {\n                                                    key: name,\n                                                    class: \"item-card\"\n                                                }, [\n                                                    _cache[9] || (_cache[9] = _createElementVNode(\"div\", { class: \"item-icon\" }, [\n                                                        _createElementVNode(\"i\", { class: \"fa-solid fa-cube\" })\n                                                    ], -1 /* CACHED */)),\n                                                    _createElementVNode(\"div\", _hoisted_17, [\n                                                        _createElementVNode(\"span\", _hoisted_18, _toDisplayString(name), 1 /* TEXT */),\n                                                        _createElementVNode(\"span\", _hoisted_19, _toDisplayString(item.描述), 1 /* TEXT */)\n                                                    ]),\n                                                    _createElementVNode(\"span\", _hoisted_20, \"x\" + _toDisplayString(item.数量), 1 /* TEXT */)\n                                                ]));\n                                            }), 128 /* KEYED_FRAGMENT */))\n                                        ])\n                                    ]))\n                                    : (_openBlock(), _createElementBlock(_Fragment, { key: 1 }, [\n                                        _createCommentVNode(\" Empty Items \"),\n                                        _cache[11] || (_cache[11] = _createElementVNode(\"div\", { class: \"empty-items\" }, [\n                                            _createElementVNode(\"i\", { class: \"fa-solid fa-box-open\" }),\n                                            _createElementVNode(\"span\", null, \"暂无关键物品\")\n                                        ], -1 /* CACHED */))\n                                    ], 2112 /* STABLE_FRAGMENT, DEV_ROOT_FRAGMENT */))\n                            ])\n                        ], 2112 /* STABLE_FRAGMENT, DEV_ROOT_FRAGMENT */))\n                        : (_openBlock(), _createElementBlock(_Fragment, { key: 2 }, [\n                            _createCommentVNode(\" Error State \"),\n                            _createElementVNode(\"div\", { class: \"error-state\" }, [\n                                _cache[12] || (_cache[12] = _createElementVNode(\"i\", { class: \"fa-solid fa-user-slash\" }, null, -1 /* CACHED */)),\n                                _cache[13] || (_cache[13] = _createElementVNode(\"p\", null, \"未找到角色信息\", -1 /* CACHED */)),\n                                _createElementVNode(\"button\", {\n                                    class: \"btn btn-primary\",\n                                    onClick: goBack\n                                }, \"返回\")\n                            ])\n                        ], 2112 /* STABLE_FRAGMENT, DEV_ROOT_FRAGMENT */))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./CharacterDetail.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./CharacterDetail.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./CharacterDetail.vue?vue&type=style&index=0&id=85c5bc3c&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-85c5bc3c\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, normalizeStyle as _normalizeStyle } from \"vue\";\n\nimport { ref } from 'vue';\nconst _hoisted_1 = { class: \"avatar-image\" };\nconst _hoisted_2 = [\"src\", \"alt\"];\nconst _hoisted_3 = {\n    key: 1,\n    class: \"avatar-placeholder\"\n};\nconst _hoisted_4 = { class: \"avatar-info\" };\nconst _hoisted_5 = { class: \"avatar-name\" };\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'CharacterAvatar',\n    props: {\n        name: {\n            type: String,\n            required: true,\n        },\n        portraitUrl: {\n            type: String,\n            default: '',\n        },\n        color: {\n            type: String,\n            default: 'var(--text-primary)',\n        },\n        size: {\n            type: String,\n            default: 'medium',\n        },\n    },\n    emits: [\"click\"],\n    setup(__props, { emit: __emit }) {\n        const props = __props;\n        const emit = __emit;\n        const imageError = ref(false);\n        function handleClick() {\n            emit('click', props.name);\n        }\n        function handleImageError() {\n            imageError.value = true;\n        }\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", {\n                class: \"character-avatar\",\n                style: _normalizeStyle({ '--character-color': __props.color }),\n                onClick: handleClick\n            }, [\n                _createElementVNode(\"div\", _hoisted_1, [\n                    (__props.portraitUrl)\n                        ? (_openBlock(), _createElementBlock(\"img\", {\n                            key: 0,\n                            src: __props.portraitUrl,\n                            alt: __props.name,\n                            onError: handleImageError\n                        }, null, 40 /* PROPS, NEED_HYDRATION */, _hoisted_2))\n                        : (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [\n                            _createElementVNode(\"span\", null, _toDisplayString(__props.name.charAt(0)), 1 /* TEXT */)\n                        ]))\n                ]),\n                _createElementVNode(\"div\", _hoisted_4, [\n                    _createElementVNode(\"span\", _hoisted_5, _toDisplayString(__props.name), 1 /* TEXT */)\n                ]),\n                _cache[0] || (_cache[0] = _createElementVNode(\"div\", { class: \"avatar-ring\" }, null, -1 /* CACHED */))\n            ], 4 /* STYLE */));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./CharacterAvatar.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./CharacterAvatar.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./CharacterAvatar.vue?vue&type=style&index=0&id=486d9764&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-486d9764\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, vShow as _vShow, withDirectives as _withDirectives, Transition as _Transition, withCtx as _withCtx, createVNode as _createVNode } from \"vue\";\nconst _hoisted_1 = { class: \"header-left\" };\nconst _hoisted_2 = { class: \"character-count\" };\nconst _hoisted_3 = { class: \"bar-content\" };\nconst _hoisted_4 = { class: \"characters-list\" };\nconst _hoisted_5 = {\n    key: 0,\n    class: \"empty-state\"\n};\nimport { CHARACTER_COLOR_MAP, CHARACTER_NAME_MAP } from '../stores/characterStore';\nimport CharacterAvatar from './CharacterAvatar.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'CharacterBar',\n    props: {\n        collapsed: {\n            type: Boolean,\n            default: false,\n        },\n        characters: {\n            type: Array,\n            default: () => [],\n        },\n    },\n    emits: [\"toggle\", \"selectCharacter\"],\n    setup(__props, { emit: __emit }) {\n        const props = __props;\n        const emit = __emit;\n        function toggle() {\n            emit('toggle');\n        }\n        function handleSelect(name) {\n            emit('selectCharacter', name);\n        }\n        function getPortraitUrl(name) {\n            const fileName = CHARACTER_NAME_MAP[name];\n            if (fileName) {\n                // 返回相对路径\n                return `https://files.catbox.moe/${fileName}.png`;\n            }\n            return '';\n        }\n        function getCharacterColor(name) {\n            return CHARACTER_COLOR_MAP[name] || 'var(--text-primary)';\n        }\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", {\n                class: _normalizeClass([\"character-bar\", { collapsed: __props.collapsed }])\n            }, [\n                _createElementVNode(\"div\", {\n                    class: \"bar-header\",\n                    onClick: toggle\n                }, [\n                    _createElementVNode(\"div\", _hoisted_1, [\n                        _cache[0] || (_cache[0] = _createElementVNode(\"i\", { class: \"fa-solid fa-users\" }, null, -1 /* CACHED */)),\n                        _cache[1] || (_cache[1] = _createElementVNode(\"span\", { class: \"header-title\" }, \"当前场景角色\", -1 /* CACHED */)),\n                        _createElementVNode(\"span\", _hoisted_2, _toDisplayString(__props.characters.length), 1 /* TEXT */)\n                    ]),\n                    _createElementVNode(\"i\", {\n                        class: _normalizeClass([\"fa-solid toggle-icon\", __props.collapsed ? 'fa-chevron-up' : 'fa-chevron-down'])\n                    }, null, 2 /* CLASS */)\n                ]),\n                _createVNode(_Transition, {\n                    name: \"expand\",\n                    persisted: \"\"\n                }, {\n                    default: _withCtx(() => [\n                        _withDirectives(_createElementVNode(\"div\", _hoisted_3, [\n                            _createElementVNode(\"div\", _hoisted_4, [\n                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(__props.characters, (name) => {\n                                    return (_openBlock(), _createBlock(CharacterAvatar, {\n                                        key: name,\n                                        name: name,\n                                        \"portrait-url\": getPortraitUrl(name),\n                                        color: getCharacterColor(name),\n                                        onClick: ($event) => (handleSelect(name))\n                                    }, null, 8 /* PROPS */, [\"name\", \"portrait-url\", \"color\", \"onClick\"]));\n                                }), 128 /* KEYED_FRAGMENT */))\n                            ]),\n                            (__props.characters.length === 0)\n                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [...(_cache[2] || (_cache[2] = [\n                                        _createElementVNode(\"i\", { class: \"fa-solid fa-user-slash\" }, null, -1 /* CACHED */),\n                                        _createElementVNode(\"span\", null, \"暂无角色\", -1 /* CACHED */)\n                                    ]))]))\n                                : _createCommentVNode(\"v-if\", true)\n                        ], 512 /* NEED_PATCH */), [\n                            [_vShow, !__props.collapsed]\n                        ])\n                    ]),\n                    _: 1 /* STABLE */\n                })\n            ], 2 /* CLASS */));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./CharacterBar.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./CharacterBar.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./CharacterBar.vue?vue&type=style&index=0&id=4d38ab19&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-4d38ab19\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createCommentVNode as _createCommentVNode, unref as _unref, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, Fragment as _Fragment, Transition as _Transition, withCtx as _withCtx, createVNode as _createVNode } from \"vue\";\n\nimport { ref, computed, watch } from 'vue';\nconst _hoisted_1 = { class: \"message-display\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"loading-state\"\n};\nconst _hoisted_3 = [\"innerHTML\"];\nconst _hoisted_4 = {\n    key: 1,\n    class: \"options-hint\"\n};\nconst _hoisted_5 = [\"innerHTML\"];\nconst _hoisted_6 = {\n    key: 0,\n    class: \"generating-indicator\"\n};\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'MessageDisplay',\n    props: {\n        message: {\n            type: String,\n            default: '',\n        },\n        messageId: {\n            type: Number,\n            default: 0,\n        },\n        displayMode: {\n            type: String,\n            default: 'instant',\n        },\n    },\n    setup(__props) {\n        const props = __props;\n        const contentRef = ref(null);\n        const isLoading = ref(false);\n        const isGenerating = ref(false);\n        // 解析消息内容\n        const optionsStartIndex = computed(() => {\n            return props.message.lastIndexOf('<roleplay_options>');\n        });\n        const optionsEndIndex = computed(() => {\n            return props.message.lastIndexOf('</roleplay_options>');\n        });\n        const hasOptions = computed(() => {\n            return optionsStartIndex.value !== -1;\n        });\n        const mainContent = computed(() => {\n            if (!props.message)\n                return '';\n            if (optionsStartIndex.value === -1)\n                return props.message.trim();\n            return props.message.slice(0, optionsStartIndex.value).trim();\n        });\n        const afterContent = computed(() => {\n            if (!props.message || optionsEndIndex.value === -1)\n                return '';\n            return props.message.slice(optionsEndIndex.value + 19).trim();\n        });\n        // 格式化内容\n        const formattedMainContent = computed(() => {\n            if (!mainContent.value)\n                return '';\n            return formatMessage(mainContent.value);\n        });\n        const formattedAfterContent = computed(() => {\n            if (!afterContent.value)\n                return '';\n            return formatMessage(afterContent.value);\n        });\n        // 格式化消息内容\n        function formatMessage(content) {\n            // 使用酒馆助手的格式化函数\n            let formatted = formatAsDisplayedMessage(content, {\n                message_id: props.messageId,\n            });\n            // 应用角色颜色\n            formatted = applyCharacterColors(formatted);\n            return formatted;\n        }\n        // 应用角色颜色\n        function applyCharacterColors(html) {\n            const characterNames = [\n                '保登心爱',\n                '香风智乃',\n                '天天座理世',\n                '宇治松千夜',\n                '桐间纱路',\n                '条河麻耶',\n                '奈津惠',\n                '风衣叶冬优',\n                '神沙夏明',\n                '神沙映月',\n                '狩手结良',\n                '青山蓝山',\n                '真手凛',\n                '保登摩卡',\n            ];\n            let result = html;\n            characterNames.forEach(name => {\n                const color = getCharacterColor(name);\n                // 匹配角色名后的引号内容\n                const regex = new RegExp(`(${name})[\"「『]([^\"」』]+)[\"」』]`, 'g');\n                result = result.replace(regex, `<span style=\"color: ${color}; font-weight: 500;\">$1</span>\"$2\"`);\n            });\n            return result;\n        }\n        // 获取角色颜色\n        function getCharacterColor(name) {\n            const colorMap = {\n                保登心爱: 'var(--clr-cocoa)',\n                香风智乃: 'var(--clr-chino)',\n                天天座理世: 'var(--clr-rize)',\n                宇治松千夜: 'var(--clr-chiya)',\n                桐间纱路: 'var(--clr-syaro)',\n                条河麻耶: 'var(--clr-maya)',\n                奈津惠: 'var(--clr-megu)',\n                风衣叶冬优: 'var(--clr-fuyu)',\n                神沙夏明: 'var(--clr-natsume)',\n                神沙映月: 'var(--clr-eru)',\n                狩手结良: 'var(--clr-yura)',\n                青山蓝山: 'var(--clr-aoyama)',\n                真手凛: 'var(--clr-mate)',\n                保登摩卡: 'var(--clr-mocha)',\n            };\n            return colorMap[name] || 'var(--text-primary)';\n        }\n        // 监听消息变化\n        watch(() => props.message, () => {\n            // Display mode handling - card, bubble, or classic\n            // Future: implement typewriter effect based on settings.typewriterEffect\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createCommentVNode(\" Loading State \"),\n                (_unref(isLoading))\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [...(_cache[0] || (_cache[0] = [\n                            _createElementVNode(\"div\", { class: \"loading-spinner\" }, null, -1 /* CACHED */),\n                            _createElementVNode(\"span\", null, \"加载中...\", -1 /* CACHED */)\n                        ]))]))\n                    : (!__props.message)\n                        ? (_openBlock(), _createElementBlock(_Fragment, { key: 1 }, [\n                            _createCommentVNode(\" Empty State \"),\n                            _cache[1] || (_cache[1] = _createElementVNode(\"div\", { class: \"empty-state\" }, [\n                                _createElementVNode(\"i\", { class: \"fa-solid fa-comments\" }),\n                                _createElementVNode(\"p\", null, \"等待AI回复...\")\n                            ], -1 /* CACHED */))\n                        ], 2112 /* STABLE_FRAGMENT, DEV_ROOT_FRAGMENT */))\n                        : (_openBlock(), _createElementBlock(_Fragment, { key: 2 }, [\n                            _createCommentVNode(\" Message Content \"),\n                            _createElementVNode(\"div\", {\n                                ref_key: \"contentRef\",\n                                ref: contentRef,\n                                class: \"message-content\"\n                            }, [\n                                _createCommentVNode(\" Main Content (before options) \"),\n                                (_unref(mainContent))\n                                    ? (_openBlock(), _createElementBlock(\"div\", {\n                                        key: 0,\n                                        class: \"main-text\",\n                                        innerHTML: _unref(formattedMainContent)\n                                    }, null, 8 /* PROPS */, _hoisted_3))\n                                    : _createCommentVNode(\"v-if\", true),\n                                _createCommentVNode(\" Options Section (hidden, will be extracted) \"),\n                                (_unref(hasOptions))\n                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, [...(_cache[2] || (_cache[2] = [\n                                            _createElementVNode(\"i\", { class: \"fa-solid fa-list-check\" }, null, -1 /* CACHED */),\n                                            _createElementVNode(\"span\", null, \"请从下方选择一个选项\", -1 /* CACHED */)\n                                        ]))]))\n                                    : _createCommentVNode(\"v-if\", true),\n                                _createCommentVNode(\" After Options Content \"),\n                                (_unref(afterContent))\n                                    ? (_openBlock(), _createElementBlock(\"div\", {\n                                        key: 2,\n                                        class: \"after-text\",\n                                        innerHTML: _unref(formattedAfterContent)\n                                    }, null, 8 /* PROPS */, _hoisted_5))\n                                    : _createCommentVNode(\"v-if\", true)\n                            ], 512 /* NEED_PATCH */)\n                        ], 2112 /* STABLE_FRAGMENT, DEV_ROOT_FRAGMENT */)),\n                _createCommentVNode(\" Generating Indicator \"),\n                _createVNode(_Transition, { name: \"fade\" }, {\n                    default: _withCtx(() => [\n                        (_unref(isGenerating))\n                            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_6, [...(_cache[3] || (_cache[3] = [\n                                    _createElementVNode(\"div\", { class: \"typing-dots\" }, [\n                                        _createElementVNode(\"span\"),\n                                        _createElementVNode(\"span\"),\n                                        _createElementVNode(\"span\")\n                                    ], -1 /* CACHED */),\n                                    _createElementVNode(\"span\", null, \"AI 正在思考...\", -1 /* CACHED */)\n                                ]))]))\n                            : _createCommentVNode(\"v-if\", true)\n                    ]),\n                    _: 1 /* STABLE */\n                })\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./MessageDisplay.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./MessageDisplay.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./MessageDisplay.vue?vue&type=style&index=0&id=3093e0e3&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-3093e0e3\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, withModifiers as _withModifiers, normalizeClass as _normalizeClass } from \"vue\";\nconst _hoisted_1 = { class: \"card-content\" };\nconst _hoisted_2 = { class: \"option-header\" };\nconst _hoisted_3 = { class: \"option-title\" };\nconst _hoisted_4 = {\n    key: 0,\n    class: \"fa-solid fa-pen custom-icon\"\n};\nconst _hoisted_5 = { class: \"option-content\" };\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'OptionCard',\n    props: {\n        option: {\n            type: Object,\n            required: true,\n        },\n        disabled: {\n            type: Boolean,\n            default: false,\n        },\n    },\n    emits: [\"select\", \"remove\"],\n    setup(__props, { emit: __emit }) {\n        const props = __props;\n        const emit = __emit;\n        function handleClick() {\n            if (props.disabled)\n                return;\n            emit('select', props.option);\n        }\n        function handleRemove() {\n            emit('remove', props.option.id);\n        }\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", {\n                class: _normalizeClass([\"option-card\", { disabled: __props.disabled, custom: __props.option.isCustom }]),\n                onClick: handleClick\n            }, [\n                _createElementVNode(\"div\", _hoisted_1, [\n                    _createElementVNode(\"div\", _hoisted_2, [\n                        _createElementVNode(\"span\", _hoisted_3, [\n                            (__props.option.isCustom)\n                                ? (_openBlock(), _createElementBlock(\"i\", _hoisted_4))\n                                : _createCommentVNode(\"v-if\", true),\n                            _createElementVNode(\"strong\", null, _toDisplayString(__props.option.title), 1 /* TEXT */)\n                        ]),\n                        (__props.option.isCustom)\n                            ? (_openBlock(), _createElementBlock(\"button\", {\n                                key: 0,\n                                class: \"remove-btn\",\n                                title: \"移除选项\",\n                                onClick: _withModifiers(handleRemove, [\"stop\"])\n                            }, [...(_cache[0] || (_cache[0] = [\n                                    _createElementVNode(\"i\", { class: \"fa-solid fa-times\" }, null, -1 /* CACHED */)\n                                ]))]))\n                            : _createCommentVNode(\"v-if\", true)\n                    ]),\n                    _cache[1] || (_cache[1] = _createElementVNode(\"hr\", { class: \"option-divider\" }, null, -1 /* CACHED */)),\n                    _createElementVNode(\"span\", _hoisted_5, _toDisplayString(__props.option.content), 1 /* TEXT */)\n                ]),\n                _cache[2] || (_cache[2] = _createElementVNode(\"div\", { class: \"card-hover-effect\" }, null, -1 /* CACHED */))\n            ], 2 /* CLASS */));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./OptionCard.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./OptionCard.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./OptionCard.vue?vue&type=style&index=0&id=08f32a66&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-08f32a66\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { unref as _unref, isRef as _isRef, vModelText as _vModelText, withKeys as _withKeys, createElementVNode as _createElementVNode, withDirectives as _withDirectives, withModifiers as _withModifiers, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\n\nimport { ref, computed } from 'vue';\nconst _hoisted_1 = { class: \"custom-option-input\" };\nconst _hoisted_2 = { class: \"input-group\" };\nconst _hoisted_3 = { class: \"input-group\" };\nconst _hoisted_4 = [\"onKeyup\"];\nconst _hoisted_5 = { class: \"char-count\" };\nconst _hoisted_6 = { class: \"input-actions\" };\nconst _hoisted_7 = [\"disabled\"];\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'CustomOptionInput',\n    emits: [\"submit\", \"cancel\"],\n    setup(__props, { emit: __emit }) {\n        const emit = __emit;\n        const title = ref('');\n        const content = ref('');\n        const canSubmit = computed(() => content.value.trim().length > 0);\n        function submit() {\n            if (!canSubmit.value)\n                return;\n            emit('submit', title.value.trim() || '自定义行动', content.value.trim());\n            reset();\n        }\n        function cancel() {\n            reset();\n            emit('cancel');\n        }\n        function reset() {\n            title.value = '';\n            content.value = '';\n        }\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _withDirectives(_createElementVNode(\"input\", {\n                        \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event) => (_isRef(title) ? (title).value = $event : null)),\n                        type: \"text\",\n                        class: \"input-field title-input\",\n                        placeholder: \"选项标题（可选）\",\n                        maxlength: \"50\",\n                        onKeyup: _withKeys(submit, [\"enter\"])\n                    }, null, 544 /* NEED_HYDRATION, NEED_PATCH */), [\n                        [_vModelText, _unref(title)]\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_3, [\n                    _withDirectives(_createElementVNode(\"textarea\", {\n                        \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event) => (_isRef(content) ? (content).value = $event : null)),\n                        class: \"input-field content-input\",\n                        placeholder: \"输入你的行动内容...\",\n                        rows: \"3\",\n                        maxlength: \"500\",\n                        onKeyup: _withKeys(_withModifiers(submit, [\"ctrl\"]), [\"enter\"])\n                    }, null, 40 /* PROPS, NEED_HYDRATION */, _hoisted_4), [\n                        [_vModelText, _unref(content)]\n                    ]),\n                    _createElementVNode(\"span\", _hoisted_5, _toDisplayString(_unref(content).length) + \"/500\", 1 /* TEXT */)\n                ]),\n                _createElementVNode(\"div\", _hoisted_6, [\n                    _createElementVNode(\"button\", {\n                        class: \"btn btn-ghost cancel-btn\",\n                        onClick: cancel\n                    }, [...(_cache[2] || (_cache[2] = [\n                            _createElementVNode(\"i\", { class: \"fa-solid fa-times\" }, null, -1 /* CACHED */),\n                            _createElementVNode(\"span\", null, \"取消\", -1 /* CACHED */)\n                        ]))]),\n                    _createElementVNode(\"button\", {\n                        class: \"btn btn-primary submit-btn\",\n                        disabled: !_unref(canSubmit),\n                        onClick: submit\n                    }, [...(_cache[3] || (_cache[3] = [\n                            _createElementVNode(\"i\", { class: \"fa-solid fa-check\" }, null, -1 /* CACHED */),\n                            _createElementVNode(\"span\", null, \"添加\", -1 /* CACHED */)\n                        ]))], 8 /* PROPS */, _hoisted_7)\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./CustomOptionInput.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./CustomOptionInput.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./CustomOptionInput.vue?vue&type=style&index=0&id=61a15228&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-61a15228\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, unref as _unref, createBlock as _createBlock, TransitionGroup as _TransitionGroup, withCtx as _withCtx, createVNode as _createVNode, createElementVNode as _createElementVNode, Transition as _Transition } from \"vue\";\nconst _hoisted_1 = { class: \"options-panel\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"custom-option-section\"\n};\nconst _hoisted_3 = {\n    key: 1,\n    class: \"empty-options\"\n};\nconst _hoisted_4 = {\n    key: 0,\n    class: \"hint\"\n};\nimport { useGameStore } from '../stores/gameStore';\nimport OptionCard from './OptionCard.vue';\nimport CustomOptionInput from './CustomOptionInput.vue';\n\nimport { ref, computed } from 'vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'OptionsPanel',\n    props: {\n        options: {\n            type: Array,\n            default: () => [],\n        },\n        allowCustom: {\n            type: Boolean,\n            default: true,\n        },\n    },\n    emits: [\"select\"],\n    setup(__props, { emit: __emit }) {\n        const props = __props;\n        const emit = __emit;\n        const gameStore = useGameStore();\n        const isAddingCustom = ref(false);\n        const isDisabled = computed(() => gameStore.isGenerating);\n        function handleSelect(option) {\n            if (isDisabled.value)\n                return;\n            emit('select', option);\n        }\n        function handleRemove(optionId) {\n            gameStore.removeOption(optionId);\n        }\n        function startAddingCustom() {\n            isAddingCustom.value = true;\n        }\n        function cancelAddingCustom() {\n            isAddingCustom.value = false;\n        }\n        function handleCustomSubmit(title, content) {\n            gameStore.addCustomOption(title, content);\n            isAddingCustom.value = false;\n        }\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createCommentVNode(\" Options List \"),\n                _createVNode(_TransitionGroup, {\n                    name: \"option-list\",\n                    tag: \"div\",\n                    class: \"options-list\"\n                }, {\n                    default: _withCtx(() => [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(__props.options, (option) => {\n                            return (_openBlock(), _createBlock(OptionCard, {\n                                key: option.id,\n                                option: option,\n                                disabled: _unref(isDisabled),\n                                onSelect: handleSelect,\n                                onRemove: handleRemove\n                            }, null, 8 /* PROPS */, [\"option\", \"disabled\"]));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ]),\n                    _: 1 /* STABLE */\n                }),\n                _createCommentVNode(\" Custom Option Input \"),\n                (__props.allowCustom)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n                        _createVNode(_Transition, { name: \"expand\" }, {\n                            default: _withCtx(() => [\n                                (!_unref(isAddingCustom))\n                                    ? (_openBlock(), _createElementBlock(\"div\", {\n                                        key: 0,\n                                        class: \"add-custom-btn\",\n                                        onClick: startAddingCustom\n                                    }, [...(_cache[0] || (_cache[0] = [\n                                            _createElementVNode(\"i\", { class: \"fa-solid fa-plus\" }, null, -1 /* CACHED */),\n                                            _createElementVNode(\"span\", null, \"添加自定义选项\", -1 /* CACHED */)\n                                        ]))]))\n                                    : (_openBlock(), _createBlock(CustomOptionInput, {\n                                        key: 1,\n                                        onSubmit: handleCustomSubmit,\n                                        onCancel: cancelAddingCustom\n                                    }))\n                            ]),\n                            _: 1 /* STABLE */\n                        })\n                    ]))\n                    : _createCommentVNode(\"v-if\", true),\n                _createCommentVNode(\" Empty State \"),\n                (__props.options.length === 0 && !_unref(isAddingCustom))\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [\n                        _cache[1] || (_cache[1] = _createElementVNode(\"i\", { class: \"fa-solid fa-hand-pointer\" }, null, -1 /* CACHED */)),\n                        _cache[2] || (_cache[2] = _createElementVNode(\"p\", null, \"暂无可选选项\", -1 /* CACHED */)),\n                        (__props.allowCustom)\n                            ? (_openBlock(), _createElementBlock(\"p\", _hoisted_4, \"点击上方按钮添加自定义行动\"))\n                            : _createCommentVNode(\"v-if\", true)\n                    ]))\n                    : _createCommentVNode(\"v-if\", true)\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./OptionsPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./OptionsPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./OptionsPanel.vue?vue&type=style&index=0&id=4780fd86&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-4780fd86\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, unref as _unref, normalizeClass as _normalizeClass, createCommentVNode as _createCommentVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, Transition as _Transition, withCtx as _withCtx, createVNode as _createVNode } from \"vue\";\nconst _hoisted_1 = { class: \"top-nav-bar\" };\nconst _hoisted_2 = { class: \"nav-right\" };\nconst _hoisted_3 = [\"title\"];\nconst _hoisted_4 = {\n    key: 0,\n    class: \"menu-dropdown\"\n};\nimport { useRouter } from 'vue-router';\nimport { useGameStore } from '../stores/gameStore';\n\nimport { ref, onMounted, onUnmounted } from 'vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'TopNavBar',\n    setup(__props) {\n        const router = useRouter();\n        const gameStore = useGameStore();\n        const isMenuOpen = ref(false);\n        function toggleMenu() {\n            isMenuOpen.value = !isMenuOpen.value;\n        }\n        function closeMenu() {\n            isMenuOpen.value = false;\n        }\n        function goToHistory() {\n            closeMenu();\n            router.push('/history');\n        }\n        function goToWorldbook() {\n            closeMenu();\n            router.push('/worldbook');\n        }\n        function goToSettings() {\n            closeMenu();\n            router.push('/settings');\n        }\n        function goToStart() {\n            closeMenu();\n            router.push('/');\n        }\n        function toggleFullscreen() {\n            gameStore.toggleFullscreen();\n        }\n        // 点击外部关闭菜单\n        onMounted(() => {\n            document.addEventListener('click', handleOutsideClick);\n        });\n        onUnmounted(() => {\n            document.removeEventListener('click', handleOutsideClick);\n        });\n        function handleOutsideClick(e) {\n            const target = e.target;\n            if (!target.closest('.top-nav-bar')) {\n                closeMenu();\n            }\n        }\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"header\", _hoisted_1, [\n                _createElementVNode(\"div\", { class: \"nav-left\" }, [\n                    _createElementVNode(\"button\", {\n                        class: \"nav-btn menu-btn\",\n                        title: \"菜单\",\n                        onClick: toggleMenu\n                    }, [...(_cache[0] || (_cache[0] = [\n                            _createElementVNode(\"i\", { class: \"fa-solid fa-bars\" }, null, -1 /* CACHED */)\n                        ]))]),\n                    _cache[1] || (_cache[1] = _createElementVNode(\"span\", { class: \"nav-title\" }, \"点兔同层前端\", -1 /* CACHED */))\n                ]),\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _createElementVNode(\"button\", {\n                        class: \"nav-btn\",\n                        title: \"历史消息\",\n                        onClick: goToHistory\n                    }, [...(_cache[2] || (_cache[2] = [\n                            _createElementVNode(\"i\", { class: \"fa-solid fa-clock-rotate-left\" }, null, -1 /* CACHED */)\n                        ]))]),\n                    _createElementVNode(\"button\", {\n                        class: \"nav-btn\",\n                        title: \"世界书管理\",\n                        onClick: goToWorldbook\n                    }, [...(_cache[3] || (_cache[3] = [\n                            _createElementVNode(\"i\", { class: \"fa-solid fa-book\" }, null, -1 /* CACHED */)\n                        ]))]),\n                    _createElementVNode(\"button\", {\n                        class: \"nav-btn\",\n                        title: \"设置\",\n                        onClick: goToSettings\n                    }, [...(_cache[4] || (_cache[4] = [\n                            _createElementVNode(\"i\", { class: \"fa-solid fa-gear\" }, null, -1 /* CACHED */)\n                        ]))]),\n                    _createElementVNode(\"button\", {\n                        class: \"nav-btn\",\n                        title: _unref(gameStore).isFullscreen ? '退出全屏' : '全屏',\n                        onClick: toggleFullscreen\n                    }, [\n                        _createElementVNode(\"i\", {\n                            class: _normalizeClass(_unref(gameStore).isFullscreen ? 'fa-solid fa-compress' : 'fa-solid fa-expand')\n                        }, null, 2 /* CLASS */)\n                    ], 8 /* PROPS */, _hoisted_3)\n                ]),\n                _createCommentVNode(\" Menu Dropdown \"),\n                _createVNode(_Transition, { name: \"dropdown\" }, {\n                    default: _withCtx(() => [\n                        (_unref(isMenuOpen))\n                            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, [\n                                _createElementVNode(\"button\", {\n                                    class: \"menu-item\",\n                                    onClick: goToHistory\n                                }, [...(_cache[5] || (_cache[5] = [\n                                        _createElementVNode(\"i\", { class: \"fa-solid fa-clock-rotate-left\" }, null, -1 /* CACHED */),\n                                        _createElementVNode(\"span\", null, \"历史消息\", -1 /* CACHED */)\n                                    ]))]),\n                                _createElementVNode(\"button\", {\n                                    class: \"menu-item\",\n                                    onClick: goToWorldbook\n                                }, [...(_cache[6] || (_cache[6] = [\n                                        _createElementVNode(\"i\", { class: \"fa-solid fa-book\" }, null, -1 /* CACHED */),\n                                        _createElementVNode(\"span\", null, \"世界书管理\", -1 /* CACHED */)\n                                    ]))]),\n                                _createElementVNode(\"button\", {\n                                    class: \"menu-item\",\n                                    onClick: goToSettings\n                                }, [...(_cache[7] || (_cache[7] = [\n                                        _createElementVNode(\"i\", { class: \"fa-solid fa-gear\" }, null, -1 /* CACHED */),\n                                        _createElementVNode(\"span\", null, \"设置\", -1 /* CACHED */)\n                                    ]))]),\n                                _cache[9] || (_cache[9] = _createElementVNode(\"hr\", { class: \"menu-divider\" }, null, -1 /* CACHED */)),\n                                _createElementVNode(\"button\", {\n                                    class: \"menu-item\",\n                                    onClick: goToStart\n                                }, [...(_cache[8] || (_cache[8] = [\n                                        _createElementVNode(\"i\", { class: \"fa-solid fa-house\" }, null, -1 /* CACHED */),\n                                        _createElementVNode(\"span\", null, \"返回首页\", -1 /* CACHED */)\n                                    ]))])\n                            ]))\n                            : _createCommentVNode(\"v-if\", true)\n                    ]),\n                    _: 1 /* STABLE */\n                }),\n                _createCommentVNode(\" Overlay \"),\n                _createVNode(_Transition, { name: \"fade\" }, {\n                    default: _withCtx(() => [\n                        (_unref(isMenuOpen))\n                            ? (_openBlock(), _createElementBlock(\"div\", {\n                                key: 0,\n                                class: \"menu-overlay\",\n                                onClick: closeMenu\n                            }))\n                            : _createCommentVNode(\"v-if\", true)\n                    ]),\n                    _: 1 /* STABLE */\n                })\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./TopNavBar.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./TopNavBar.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./TopNavBar.vue?vue&type=style&index=0&id=37fa88ec&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-37fa88ec\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createCommentVNode as _createCommentVNode, createVNode as _createVNode, unref as _unref, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = { class: \"game-main\" };\nconst _hoisted_2 = { class: \"main-content\" };\nimport { useRouter } from 'vue-router';\nimport { useCharacterStore } from '../stores/characterStore';\nimport { useGameStore } from '../stores/gameStore';\nimport { useSettingsStore } from '../stores/settingsStore';\nimport { toastError } from '../utils/toast';\nimport CharacterBar from './CharacterBar.vue';\nimport MessageDisplay from './MessageDisplay.vue';\nimport OptionsPanel from './OptionsPanel.vue';\nimport TopNavBar from './TopNavBar.vue';\n\nimport { onMounted } from 'vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'GameMain',\n    setup(__props) {\n        const router = useRouter();\n        const gameStore = useGameStore();\n        const settingsStore = useSettingsStore();\n        const characterStore = useCharacterStore();\n        // 初始化数据\n        onMounted(async () => {\n            await initializeGame();\n        });\n        async function initializeGame() {\n            try {\n                // 刷新角色数据\n                await characterStore.refreshData();\n                // 获取当前消息\n                await loadCurrentMessage();\n                // 更新当前场景角色\n                const characters = characterStore.getCurrentSceneCharacters();\n                gameStore.updateCurrentCharacters(characters);\n                console.info('[游戏主页面] 初始化完成');\n            }\n            catch (e) {\n                console.error('[游戏主页面] 初始化失败:', e);\n            }\n        }\n        // 加载当前消息\n        async function loadCurrentMessage() {\n            try {\n                // 获取最后一条AI消息\n                const lastMessageId = SillyTavern.chat.length - 1;\n                const messages = getChatMessages(lastMessageId);\n                if (messages.length > 0) {\n                    const msg = messages[0];\n                    if (msg.role === 'assistant') {\n                        gameStore.updateMessage(msg.message, lastMessageId);\n                        // 解析选项\n                        const options = parseOptions(msg.message);\n                        gameStore.updateOptions(options);\n                    }\n                }\n            }\n            catch (e) {\n                console.error('[游戏主页面] 加载消息失败:', e);\n            }\n        }\n        // 解析选项\n        function parseOptions(message) {\n            const optionsMatch = message.match(/<roleplay_options>(.*?)<\\/roleplay_options>/s);\n            if (!optionsMatch)\n                return [];\n            const text = optionsMatch[1];\n            const itemMatches = [...text.matchAll(/(.+?)[:：]\\s*(.+)/gm)];\n            return itemMatches.map((match, index) => ({\n                id: `option-${index}`,\n                title: match[1],\n                content: match[2].replace(/^\\$\\{(.+)\\}$/, '$1').replace(/^「(.+)」$/, '$1'),\n                isCustom: false,\n            }));\n        }\n        // 处理选项选择\n        async function handleSelectOption(option) {\n            if (gameStore.isGenerating)\n                return;\n            gameStore.setGenerating(true);\n            try {\n                // 在酒馆中创建用户消息\n                await createChatMessages([\n                    {\n                        role: 'user',\n                        message: option.content,\n                    },\n                ]);\n                // 触发AI生成\n                await triggerSlash('/trigger');\n                // 等待消息渲染完成后刷新\n                await new Promise(resolve => setTimeout(resolve, 500));\n                await loadCurrentMessage();\n                await characterStore.refreshData();\n                // 更新当前场景角色\n                const characters = characterStore.getCurrentSceneCharacters();\n                gameStore.updateCurrentCharacters(characters);\n            }\n            catch (e) {\n                console.error('[游戏主页面] 发送选项失败:', e);\n                toastError('发送失败，请重试');\n            }\n            finally {\n                gameStore.setGenerating(false);\n            }\n        }\n        // 处理角色选择\n        function handleSelectCharacter(name) {\n            gameStore.selectCharacter(name);\n            router.push(`/character/${encodeURIComponent(name)}`);\n        }\n        // 监听消息变化\n        eventOn(tavern_events.CHARACTER_MESSAGE_RENDERED, async (messageId) => {\n            if (messageId === gameStore.currentMessageId) {\n                await loadCurrentMessage();\n                await characterStore.refreshData();\n            }\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createCommentVNode(\" Top Navigation Bar \"),\n                _createVNode(TopNavBar),\n                _createCommentVNode(\" Main Content Area \"),\n                _createElementVNode(\"main\", _hoisted_2, [\n                    _createCommentVNode(\" Message Display Area \"),\n                    _createVNode(MessageDisplay, {\n                        message: _unref(gameStore).currentMessage,\n                        \"message-id\": _unref(gameStore).currentMessageId,\n                        \"display-mode\": _unref(settingsStore).settings.messageDisplayMode\n                    }, null, 8 /* PROPS */, [\"message\", \"message-id\", \"display-mode\"]),\n                    _createCommentVNode(\" Options Panel \"),\n                    _createVNode(OptionsPanel, {\n                        options: _unref(gameStore).options,\n                        \"allow-custom\": _unref(settingsStore).settings.allowCustomOptions,\n                        onSelect: handleSelectOption\n                    }, null, 8 /* PROPS */, [\"options\", \"allow-custom\"])\n                ]),\n                _createCommentVNode(\" Character Bar (Collapsible) \"),\n                _createVNode(CharacterBar, {\n                    collapsed: _unref(gameStore).isCharacterBarCollapsed,\n                    characters: _unref(gameStore).currentCharacters,\n                    onToggle: _unref(gameStore).toggleCharacterBar,\n                    onSelectCharacter: handleSelectCharacter\n                }, null, 8 /* PROPS */, [\"collapsed\", \"characters\", \"onToggle\"])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./GameMain.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./GameMain.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./GameMain.vue?vue&type=style&index=0&id=0570284a&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-0570284a\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, unref as _unref, isRef as _isRef, vModelText as _vModelText, withDirectives as _withDirectives, openBlock as _openBlock, createElementBlock as _createElementBlock, renderList as _renderList, Fragment as _Fragment, normalizeClass as _normalizeClass, normalizeStyle as _normalizeStyle, toDisplayString as _toDisplayString } from \"vue\";\nconst _hoisted_1 = { class: \"history-messages\" };\nconst _hoisted_2 = { class: \"search-section\" };\nconst _hoisted_3 = { class: \"search-input-wrapper\" };\nconst _hoisted_4 = {\n    key: 0,\n    class: \"loading-state\"\n};\nconst _hoisted_5 = { class: \"messages-list\" };\nconst _hoisted_6 = [\"onClick\"];\nconst _hoisted_7 = { class: \"message-info\" };\nconst _hoisted_8 = { class: \"message-header\" };\nconst _hoisted_9 = { class: \"message-role\" };\nconst _hoisted_10 = { class: \"message-id\" };\nconst _hoisted_11 = { class: \"message-preview\" };\nconst _hoisted_12 = [\"disabled\"];\nconst _hoisted_13 = {\n    key: 1,\n    class: \"empty-state\"\n};\nimport { useRouter } from 'vue-router';\n\nimport { ref, computed, onMounted } from 'vue';\nconst pageSize = 20;\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'HistoryMessages',\n    setup(__props) {\n        const router = useRouter();\n        const searchQuery = ref('');\n        const isLoading = ref(true);\n        const isLoadingMore = ref(false);\n        const messages = ref([]);\n        const hasMore = ref(true);\n        const currentPage = ref(0);\n        const filteredMessages = computed(() => {\n            if (!searchQuery.value)\n                return messages.value;\n            const query = searchQuery.value.toLowerCase();\n            return messages.value.filter(msg => msg.preview.toLowerCase().includes(query));\n        });\n        async function loadMessages() {\n            isLoading.value = true;\n            try {\n                const chatLength = SillyTavern.chat.length;\n                const start = Math.max(0, chatLength - (currentPage.value + 1) * pageSize);\n                const end = chatLength - currentPage.value * pageSize;\n                const newMessages = [];\n                for (let i = end - 1; i >= start; i--) {\n                    const msg = getChatMessages(i)[0];\n                    if (msg) {\n                        newMessages.push({\n                            id: i,\n                            role: msg.role,\n                            preview: truncateText(msg.message, 100),\n                            fullContent: msg.message,\n                        });\n                    }\n                }\n                messages.value = [...messages.value, ...newMessages];\n                hasMore.value = start > 0;\n            }\n            catch (e) {\n                console.error('[历史消息] 加载失败:', e);\n            }\n            finally {\n                isLoading.value = false;\n            }\n        }\n        async function loadMore() {\n            if (isLoadingMore.value || !hasMore.value)\n                return;\n            isLoadingMore.value = true;\n            currentPage.value++;\n            await loadMessages();\n            isLoadingMore.value = false;\n        }\n        function truncateText(text, maxLength) {\n            if (!text)\n                return '';\n            // 移除HTML标签\n            const cleanText = text.replace(/<[^>]*>/g, '').trim();\n            if (cleanText.length <= maxLength)\n                return cleanText;\n            return cleanText.slice(0, maxLength) + '...';\n        }\n        function getAvatarColor(role) {\n            switch (role) {\n                case 'user':\n                    return 'var(--clr-cocoa)';\n                case 'assistant':\n                    return 'var(--clr-chino)';\n                case 'system':\n                    return 'var(--text-muted)';\n                default:\n                    return 'var(--text-secondary)';\n            }\n        }\n        function getAvatarIcon(role) {\n            switch (role) {\n                case 'user':\n                    return 'fa-solid fa-user';\n                case 'assistant':\n                    return 'fa-solid fa-robot';\n                case 'system':\n                    return 'fa-solid fa-gear';\n                default:\n                    return 'fa-solid fa-message';\n            }\n        }\n        function getRoleLabel(role) {\n            switch (role) {\n                case 'user':\n                    return '用户';\n                case 'assistant':\n                    return 'AI';\n                case 'system':\n                    return '系统';\n                default:\n                    return '未知';\n            }\n        }\n        function viewMessage(id) {\n            // 使用 /chat-jump 跳转到指定消息\n            triggerSlash(`/chat-jump ${id}`);\n            router.push('/game');\n        }\n        function clearSearch() {\n            searchQuery.value = '';\n        }\n        function goBack() {\n            router.push('/game');\n        }\n        onMounted(() => {\n            loadMessages();\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createCommentVNode(\" Header \"),\n                _createElementVNode(\"header\", { class: \"history-header\" }, [\n                    _createElementVNode(\"button\", {\n                        class: \"back-btn\",\n                        onClick: goBack\n                    }, [...(_cache[1] || (_cache[1] = [\n                            _createElementVNode(\"i\", { class: \"fa-solid fa-arrow-left\" }, null, -1 /* CACHED */)\n                        ]))]),\n                    _cache[2] || (_cache[2] = _createElementVNode(\"h1\", { class: \"header-title\" }, \"历史消息\", -1 /* CACHED */))\n                ]),\n                _createCommentVNode(\" Search Bar \"),\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _createElementVNode(\"div\", _hoisted_3, [\n                        _cache[4] || (_cache[4] = _createElementVNode(\"i\", { class: \"fa-solid fa-search\" }, null, -1 /* CACHED */)),\n                        _withDirectives(_createElementVNode(\"input\", {\n                            \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event) => (_isRef(searchQuery) ? (searchQuery).value = $event : null)),\n                            type: \"text\",\n                            class: \"search-input\",\n                            placeholder: \"搜索消息内容...\"\n                        }, null, 512 /* NEED_PATCH */), [\n                            [_vModelText, _unref(searchQuery)]\n                        ]),\n                        (_unref(searchQuery))\n                            ? (_openBlock(), _createElementBlock(\"button\", {\n                                key: 0,\n                                class: \"clear-btn\",\n                                onClick: clearSearch\n                            }, [...(_cache[3] || (_cache[3] = [\n                                    _createElementVNode(\"i\", { class: \"fa-solid fa-times\" }, null, -1 /* CACHED */)\n                                ]))]))\n                            : _createCommentVNode(\"v-if\", true)\n                    ])\n                ]),\n                _createCommentVNode(\" Loading State \"),\n                (_unref(isLoading))\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, [...(_cache[5] || (_cache[5] = [\n                            _createElementVNode(\"div\", { class: \"loading-spinner\" }, null, -1 /* CACHED */),\n                            _createElementVNode(\"span\", null, \"加载中...\", -1 /* CACHED */)\n                        ]))]))\n                    : (_openBlock(), _createElementBlock(_Fragment, { key: 1 }, [\n                        _createCommentVNode(\" Messages List \"),\n                        _createElementVNode(\"main\", _hoisted_5, [\n                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(filteredMessages), (group) => {\n                                return (_openBlock(), _createElementBlock(\"div\", {\n                                    key: group.id,\n                                    class: \"message-group\",\n                                    onClick: ($event) => (viewMessage(group.id))\n                                }, [\n                                    _createElementVNode(\"div\", {\n                                        class: \"message-avatar\",\n                                        style: _normalizeStyle({ backgroundColor: getAvatarColor(group.role) })\n                                    }, [\n                                        _createElementVNode(\"i\", {\n                                            class: _normalizeClass(getAvatarIcon(group.role))\n                                        }, null, 2 /* CLASS */)\n                                    ], 4 /* STYLE */),\n                                    _createElementVNode(\"div\", _hoisted_7, [\n                                        _createElementVNode(\"div\", _hoisted_8, [\n                                            _createElementVNode(\"span\", _hoisted_9, _toDisplayString(getRoleLabel(group.role)), 1 /* TEXT */),\n                                            _createElementVNode(\"span\", _hoisted_10, \"第 \" + _toDisplayString(group.id) + \" 楼\", 1 /* TEXT */)\n                                        ]),\n                                        _createElementVNode(\"p\", _hoisted_11, _toDisplayString(group.preview), 1 /* TEXT */)\n                                    ]),\n                                    _cache[6] || (_cache[6] = _createElementVNode(\"i\", { class: \"fa-solid fa-chevron-right arrow-icon\" }, null, -1 /* CACHED */))\n                                ], 8 /* PROPS */, _hoisted_6));\n                            }), 128 /* KEYED_FRAGMENT */)),\n                            _createCommentVNode(\" Load More \"),\n                            (_unref(hasMore))\n                                ? (_openBlock(), _createElementBlock(\"button\", {\n                                    key: 0,\n                                    class: \"load-more-btn\",\n                                    disabled: _unref(isLoadingMore),\n                                    onClick: loadMore\n                                }, [\n                                    _createElementVNode(\"i\", {\n                                        class: _normalizeClass(_unref(isLoadingMore) ? 'fa-solid fa-spinner fa-spin' : 'fa-solid fa-arrow-down')\n                                    }, null, 2 /* CLASS */),\n                                    _createElementVNode(\"span\", null, _toDisplayString(_unref(isLoadingMore) ? '加载中...' : '加载更多'), 1 /* TEXT */)\n                                ], 8 /* PROPS */, _hoisted_12))\n                                : _createCommentVNode(\"v-if\", true),\n                            _createCommentVNode(\" Empty State \"),\n                            (_unref(filteredMessages).length === 0 && !_unref(isLoading))\n                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_13, [...(_cache[7] || (_cache[7] = [\n                                        _createElementVNode(\"i\", { class: \"fa-solid fa-inbox\" }, null, -1 /* CACHED */),\n                                        _createElementVNode(\"p\", null, \"暂无历史消息\", -1 /* CACHED */)\n                                    ]))]))\n                                : _createCommentVNode(\"v-if\", true)\n                        ])\n                    ], 2112 /* STABLE_FRAGMENT, DEV_ROOT_FRAGMENT */))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./HistoryMessages.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./HistoryMessages.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./HistoryMessages.vue?vue&type=style&index=0&id=359738f2&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-359738f2\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, unref as _unref, vModelSelect as _vModelSelect, withDirectives as _withDirectives, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, normalizeStyle as _normalizeStyle, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, vModelCheckbox as _vModelCheckbox, vModelText as _vModelText, createStaticVNode as _createStaticVNode } from \"vue\";\nconst _hoisted_1 = { class: \"settings-page\" };\nconst _hoisted_2 = { class: \"settings-content\" };\nconst _hoisted_3 = { class: \"settings-section\" };\nconst _hoisted_4 = { class: \"setting-item\" };\nconst _hoisted_5 = { class: \"setting-control\" };\nconst _hoisted_6 = { class: \"setting-item\" };\nconst _hoisted_7 = { class: \"setting-control\" };\nconst _hoisted_8 = { class: \"theme-options\" };\nconst _hoisted_9 = [\"onClick\"];\nconst _hoisted_10 = { class: \"theme-name\" };\nconst _hoisted_11 = { class: \"setting-item\" };\nconst _hoisted_12 = { class: \"setting-control\" };\nconst _hoisted_13 = { class: \"setting-item\" };\nconst _hoisted_14 = { class: \"setting-control\" };\nconst _hoisted_15 = { class: \"font-size-control\" };\nconst _hoisted_16 = { class: \"size-value\" };\nconst _hoisted_17 = { class: \"settings-section\" };\nconst _hoisted_18 = { class: \"setting-item\" };\nconst _hoisted_19 = { class: \"setting-control\" };\nconst _hoisted_20 = { class: \"toggle-switch\" };\nconst _hoisted_21 = { class: \"setting-item\" };\nconst _hoisted_22 = { class: \"setting-control\" };\nconst _hoisted_23 = { class: \"toggle-switch\" };\nconst _hoisted_24 = { class: \"settings-section\" };\nconst _hoisted_25 = { class: \"setting-item\" };\nconst _hoisted_26 = { class: \"setting-control\" };\nconst _hoisted_27 = { class: \"toggle-switch\" };\nconst _hoisted_28 = { class: \"setting-item\" };\nconst _hoisted_29 = { class: \"setting-control\" };\nconst _hoisted_30 = { class: \"toggle-switch\" };\nconst _hoisted_31 = { class: \"setting-item\" };\nconst _hoisted_32 = { class: \"setting-control\" };\nconst _hoisted_33 = { class: \"slider-control\" };\nconst _hoisted_34 = { class: \"slider-value\" };\nimport { useRouter } from 'vue-router';\nimport { useSettingsStore } from '../stores/settingsStore';\nimport { toastSuccess } from '../utils/toast';\n\nimport { computed } from 'vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'SettingsPage',\n    setup(__props) {\n        const router = useRouter();\n        const settingsStore = useSettingsStore();\n        const settings = settingsStore.settings;\n        const themes = [\n            { id: 'warm', name: '暖色', preview: 'linear-gradient(135deg, #fef3c7, #fde68a)' },\n            { id: 'cool', name: '冷色', preview: 'linear-gradient(135deg, #dbeafe, #bfdbfe)' },\n            { id: 'high-contrast', name: '高对比', preview: 'linear-gradient(135deg, #ffffff, #d8d8d8)' },\n            { id: 'eye-care', name: '护眼', preview: 'linear-gradient(135deg, #f5f0e6, #ebe5d9)' },\n        ];\n        const FONT_SIZE_ORDER = ['small', 'medium', 'large'];\n        const FONT_SIZE_LABEL = {\n            small: '小',\n            medium: '中',\n            large: '大',\n        };\n        const fontSizeLabel = computed(() => FONT_SIZE_LABEL[settings.fontSize]);\n        function setTheme(id) {\n            settings.theme = id;\n        }\n        function increaseFontSize() {\n            const index = FONT_SIZE_ORDER.indexOf(settings.fontSize);\n            if (index < FONT_SIZE_ORDER.length - 1) {\n                settings.fontSize = FONT_SIZE_ORDER[index + 1];\n            }\n        }\n        function decreaseFontSize() {\n            const index = FONT_SIZE_ORDER.indexOf(settings.fontSize);\n            if (index > 0) {\n                settings.fontSize = FONT_SIZE_ORDER[index - 1];\n            }\n        }\n        function resetSettings() {\n            settingsStore.resetSettings();\n            toastSuccess('设置已重置');\n        }\n        function goBack() {\n            router.push('/game');\n        }\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"header\", { class: \"settings-header\" }, [\n                    _createElementVNode(\"button\", {\n                        class: \"back-btn\",\n                        onClick: goBack\n                    }, [...(_cache[7] || (_cache[7] = [\n                            _createElementVNode(\"i\", { class: \"fa-solid fa-arrow-left\" }, null, -1 /* CACHED */)\n                        ]))]),\n                    _cache[8] || (_cache[8] = _createElementVNode(\"h1\", { class: \"header-title\" }, \"设置\", -1 /* CACHED */))\n                ]),\n                _createElementVNode(\"main\", _hoisted_2, [\n                    _createElementVNode(\"section\", _hoisted_3, [\n                        _cache[17] || (_cache[17] = _createElementVNode(\"h2\", { class: \"section-title\" }, [\n                            _createElementVNode(\"i\", { class: \"fa-solid fa-display\" }),\n                            _createTextVNode(\" 显示设置 \")\n                        ], -1 /* CACHED */)),\n                        _createElementVNode(\"div\", _hoisted_4, [\n                            _cache[10] || (_cache[10] = _createElementVNode(\"div\", { class: \"setting-info\" }, [\n                                _createElementVNode(\"span\", { class: \"setting-label\" }, \"消息显示模式\"),\n                                _createElementVNode(\"span\", { class: \"setting-desc\" }, \"选择消息的呈现方式\")\n                            ], -1 /* CACHED */)),\n                            _createElementVNode(\"div\", _hoisted_5, [\n                                _withDirectives(_createElementVNode(\"select\", {\n                                    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event) => ((_unref(settings).messageDisplayMode) = $event)),\n                                    class: \"setting-select\"\n                                }, [...(_cache[9] || (_cache[9] = [\n                                        _createElementVNode(\"option\", { value: \"instant\" }, \"即时显示\", -1 /* CACHED */),\n                                        _createElementVNode(\"option\", { value: \"typewriter\" }, \"打字机\", -1 /* CACHED */),\n                                        _createElementVNode(\"option\", { value: \"segment\" }, \"分段显示\", -1 /* CACHED */)\n                                    ]))], 512 /* NEED_PATCH */), [\n                                    [_vModelSelect, _unref(settings).messageDisplayMode]\n                                ])\n                            ])\n                        ]),\n                        _createElementVNode(\"div\", _hoisted_6, [\n                            _cache[11] || (_cache[11] = _createElementVNode(\"div\", { class: \"setting-info\" }, [\n                                _createElementVNode(\"span\", { class: \"setting-label\" }, \"主题\"),\n                                _createElementVNode(\"span\", { class: \"setting-desc\" }, \"选择界面配色方案\")\n                            ], -1 /* CACHED */)),\n                            _createElementVNode(\"div\", _hoisted_7, [\n                                _createElementVNode(\"div\", _hoisted_8, [\n                                    (_openBlock(), _createElementBlock(_Fragment, null, _renderList(themes, (theme) => {\n                                        return _createElementVNode(\"button\", {\n                                            key: theme.id,\n                                            class: _normalizeClass([\"theme-btn\", { active: _unref(settings).theme === theme.id }]),\n                                            onClick: ($event) => (setTheme(theme.id))\n                                        }, [\n                                            _createElementVNode(\"span\", {\n                                                class: \"theme-preview\",\n                                                style: _normalizeStyle({ background: theme.preview })\n                                            }, null, 4 /* STYLE */),\n                                            _createElementVNode(\"span\", _hoisted_10, _toDisplayString(theme.name), 1 /* TEXT */)\n                                        ], 10 /* CLASS, PROPS */, _hoisted_9);\n                                    }), 64 /* STABLE_FRAGMENT */))\n                                ])\n                            ])\n                        ]),\n                        _createElementVNode(\"div\", _hoisted_11, [\n                            _cache[13] || (_cache[13] = _createElementVNode(\"div\", { class: \"setting-info\" }, [\n                                _createElementVNode(\"span\", { class: \"setting-label\" }, \"字体方案\"),\n                                _createElementVNode(\"span\", { class: \"setting-desc\" }, \"选择界面字体风格\")\n                            ], -1 /* CACHED */)),\n                            _createElementVNode(\"div\", _hoisted_12, [\n                                _withDirectives(_createElementVNode(\"select\", {\n                                    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event) => ((_unref(settings).fontScheme) = $event)),\n                                    class: \"setting-select\"\n                                }, [...(_cache[12] || (_cache[12] = [\n                                        _createElementVNode(\"option\", { value: \"default\" }, \"默认字体\", -1 /* CACHED */),\n                                        _createElementVNode(\"option\", { value: \"reading\" }, \"阅读字体\", -1 /* CACHED */),\n                                        _createElementVNode(\"option\", { value: \"artistic\" }, \"艺术字体\", -1 /* CACHED */)\n                                    ]))], 512 /* NEED_PATCH */), [\n                                    [_vModelSelect, _unref(settings).fontScheme]\n                                ])\n                            ])\n                        ]),\n                        _createElementVNode(\"div\", _hoisted_13, [\n                            _cache[16] || (_cache[16] = _createElementVNode(\"div\", { class: \"setting-info\" }, [\n                                _createElementVNode(\"span\", { class: \"setting-label\" }, \"字体大小\"),\n                                _createElementVNode(\"span\", { class: \"setting-desc\" }, \"调整界面文字大小\")\n                            ], -1 /* CACHED */)),\n                            _createElementVNode(\"div\", _hoisted_14, [\n                                _createElementVNode(\"div\", _hoisted_15, [\n                                    _createElementVNode(\"button\", {\n                                        class: \"size-btn\",\n                                        onClick: decreaseFontSize\n                                    }, [...(_cache[14] || (_cache[14] = [\n                                            _createElementVNode(\"i\", { class: \"fa-solid fa-minus\" }, null, -1 /* CACHED */)\n                                        ]))]),\n                                    _createElementVNode(\"span\", _hoisted_16, _toDisplayString(_unref(fontSizeLabel)), 1 /* TEXT */),\n                                    _createElementVNode(\"button\", {\n                                        class: \"size-btn\",\n                                        onClick: increaseFontSize\n                                    }, [...(_cache[15] || (_cache[15] = [\n                                            _createElementVNode(\"i\", { class: \"fa-solid fa-plus\" }, null, -1 /* CACHED */)\n                                        ]))])\n                                ])\n                            ])\n                        ])\n                    ]),\n                    _createElementVNode(\"section\", _hoisted_17, [\n                        _cache[22] || (_cache[22] = _createElementVNode(\"h2\", { class: \"section-title\" }, [\n                            _createElementVNode(\"i\", { class: \"fa-solid fa-wand-magic-sparkles\" }),\n                            _createTextVNode(\" 动画设置 \")\n                        ], -1 /* CACHED */)),\n                        _createElementVNode(\"div\", _hoisted_18, [\n                            _cache[19] || (_cache[19] = _createElementVNode(\"div\", { class: \"setting-info\" }, [\n                                _createElementVNode(\"span\", { class: \"setting-label\" }, \"启用动画\"),\n                                _createElementVNode(\"span\", { class: \"setting-desc\" }, \"开启界面过渡动画效果\")\n                            ], -1 /* CACHED */)),\n                            _createElementVNode(\"div\", _hoisted_19, [\n                                _createElementVNode(\"label\", _hoisted_20, [\n                                    _withDirectives(_createElementVNode(\"input\", {\n                                        \"onUpdate:modelValue\": _cache[2] || (_cache[2] = ($event) => ((_unref(settings).enableAnimations) = $event)),\n                                        type: \"checkbox\"\n                                    }, null, 512 /* NEED_PATCH */), [\n                                        [_vModelCheckbox, _unref(settings).enableAnimations]\n                                    ]),\n                                    _cache[18] || (_cache[18] = _createElementVNode(\"span\", { class: \"toggle-slider\" }, null, -1 /* CACHED */))\n                                ])\n                            ])\n                        ]),\n                        _createElementVNode(\"div\", _hoisted_21, [\n                            _cache[21] || (_cache[21] = _createElementVNode(\"div\", { class: \"setting-info\" }, [\n                                _createElementVNode(\"span\", { class: \"setting-label\" }, \"打字机效果\"),\n                                _createElementVNode(\"span\", { class: \"setting-desc\" }, \"消息逐字显示效果\")\n                            ], -1 /* CACHED */)),\n                            _createElementVNode(\"div\", _hoisted_22, [\n                                _createElementVNode(\"label\", _hoisted_23, [\n                                    _withDirectives(_createElementVNode(\"input\", {\n                                        \"onUpdate:modelValue\": _cache[3] || (_cache[3] = ($event) => ((_unref(settings).typewriterEffect) = $event)),\n                                        type: \"checkbox\"\n                                    }, null, 512 /* NEED_PATCH */), [\n                                        [_vModelCheckbox, _unref(settings).typewriterEffect]\n                                    ]),\n                                    _cache[20] || (_cache[20] = _createElementVNode(\"span\", { class: \"toggle-slider\" }, null, -1 /* CACHED */))\n                                ])\n                            ])\n                        ])\n                    ]),\n                    _createElementVNode(\"section\", _hoisted_24, [\n                        _cache[28] || (_cache[28] = _createElementVNode(\"h2\", { class: \"section-title\" }, [\n                            _createElementVNode(\"i\", { class: \"fa-solid fa-hand-pointer\" }),\n                            _createTextVNode(\" 交互设置 \")\n                        ], -1 /* CACHED */)),\n                        _createElementVNode(\"div\", _hoisted_25, [\n                            _cache[24] || (_cache[24] = _createElementVNode(\"div\", { class: \"setting-info\" }, [\n                                _createElementVNode(\"span\", { class: \"setting-label\" }, \"自动滚动\"),\n                                _createElementVNode(\"span\", { class: \"setting-desc\" }, \"新消息时自动滚动到底部\")\n                            ], -1 /* CACHED */)),\n                            _createElementVNode(\"div\", _hoisted_26, [\n                                _createElementVNode(\"label\", _hoisted_27, [\n                                    _withDirectives(_createElementVNode(\"input\", {\n                                        \"onUpdate:modelValue\": _cache[4] || (_cache[4] = ($event) => ((_unref(settings).autoScroll) = $event)),\n                                        type: \"checkbox\"\n                                    }, null, 512 /* NEED_PATCH */), [\n                                        [_vModelCheckbox, _unref(settings).autoScroll]\n                                    ]),\n                                    _cache[23] || (_cache[23] = _createElementVNode(\"span\", { class: \"toggle-slider\" }, null, -1 /* CACHED */))\n                                ])\n                            ])\n                        ]),\n                        _createElementVNode(\"div\", _hoisted_28, [\n                            _cache[26] || (_cache[26] = _createElementVNode(\"div\", { class: \"setting-info\" }, [\n                                _createElementVNode(\"span\", { class: \"setting-label\" }, \"显示角色栏\"),\n                                _createElementVNode(\"span\", { class: \"setting-desc\" }, \"在界面底部显示角色状态栏\")\n                            ], -1 /* CACHED */)),\n                            _createElementVNode(\"div\", _hoisted_29, [\n                                _createElementVNode(\"label\", _hoisted_30, [\n                                    _withDirectives(_createElementVNode(\"input\", {\n                                        \"onUpdate:modelValue\": _cache[5] || (_cache[5] = ($event) => ((_unref(settings).showCharacterBar) = $event)),\n                                        type: \"checkbox\"\n                                    }, null, 512 /* NEED_PATCH */), [\n                                        [_vModelCheckbox, _unref(settings).showCharacterBar]\n                                    ]),\n                                    _cache[25] || (_cache[25] = _createElementVNode(\"span\", { class: \"toggle-slider\" }, null, -1 /* CACHED */))\n                                ])\n                            ])\n                        ]),\n                        _createElementVNode(\"div\", _hoisted_31, [\n                            _cache[27] || (_cache[27] = _createElementVNode(\"div\", { class: \"setting-info\" }, [\n                                _createElementVNode(\"span\", { class: \"setting-label\" }, \"背景模糊\"),\n                                _createElementVNode(\"span\", { class: \"setting-desc\" }, \"背景图片模糊效果\")\n                            ], -1 /* CACHED */)),\n                            _createElementVNode(\"div\", _hoisted_32, [\n                                _createElementVNode(\"div\", _hoisted_33, [\n                                    _withDirectives(_createElementVNode(\"input\", {\n                                        \"onUpdate:modelValue\": _cache[6] || (_cache[6] = ($event) => ((_unref(settings).backgroundBlur) = $event)),\n                                        type: \"range\",\n                                        min: \"0\",\n                                        max: \"20\",\n                                        class: \"setting-slider\"\n                                    }, null, 512 /* NEED_PATCH */), [\n                                        [\n                                            _vModelText,\n                                            _unref(settings).backgroundBlur,\n                                            void 0,\n                                            { number: true }\n                                        ]\n                                    ]),\n                                    _createElementVNode(\"span\", _hoisted_34, _toDisplayString(_unref(settings).backgroundBlur) + \"px\", 1 /* TEXT */)\n                                ])\n                            ])\n                        ])\n                    ]),\n                    _cache[30] || (_cache[30] = _createStaticVNode(\"<section class=\\\"settings-section\\\" data-v-88bcff2a><h2 class=\\\"section-title\\\" data-v-88bcff2a><i class=\\\"fa-solid fa-circle-info\\\" data-v-88bcff2a></i> 关于 </h2><div class=\\\"about-content\\\" data-v-88bcff2a><div class=\\\"about-logo\\\" data-v-88bcff2a><div class=\\\"logo-placeholder\\\" data-v-88bcff2a><i class=\\\"fa-solid fa-mug-hot\\\" data-v-88bcff2a></i></div></div><div class=\\\"about-info\\\" data-v-88bcff2a><h3 class=\\\"about-title\\\" data-v-88bcff2a>点兔互动界面</h3><p class=\\\"about-version\\\" data-v-88bcff2a>版本 1.0.0</p><p class=\\\"about-desc\\\" data-v-88bcff2a> 基于「请问您今天要来点兔子吗？」世界观的沉浸式文字冒险游戏界面。采用法式艺术风格设计，为您带来温馨治愈的互动体验。 </p></div></div></section>\", 1)),\n                    _createElementVNode(\"div\", { class: \"settings-footer\" }, [\n                        _createElementVNode(\"button\", {\n                            class: \"btn btn-danger\",\n                            onClick: resetSettings\n                        }, [...(_cache[29] || (_cache[29] = [\n                                _createElementVNode(\"i\", { class: \"fa-solid fa-rotate-left\" }, null, -1 /* CACHED */),\n                                _createTextVNode(\" 重置为默认设置 \", -1 /* CACHED */)\n                            ]))])\n                    ])\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./SettingsPage.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./SettingsPage.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./SettingsPage.vue?vue&type=style&index=0&id=88bcff2a&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-88bcff2a\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, unref as _unref, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, renderList as _renderList, Fragment as _Fragment, normalizeStyle as _normalizeStyle } from \"vue\";\nconst _hoisted_1 = { class: \"start-screen\" };\nconst _hoisted_2 = { class: \"start-content\" };\nconst _hoisted_3 = [\"disabled\"];\nconst _hoisted_4 = { class: \"decorative-rabbits\" };\nimport { useRouter } from 'vue-router';\nimport { useCharacterStore } from '../stores/characterStore';\nimport { useGameStore } from '../stores/gameStore';\nimport { toastError } from '../utils/toast';\n\nimport { ref } from 'vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'StartScreen',\n    setup(__props) {\n        const router = useRouter();\n        const characterStore = useCharacterStore();\n        const gameStore = useGameStore();\n        const isLoading = ref(false);\n        async function handleStart() {\n            if (isLoading.value)\n                return;\n            isLoading.value = true;\n            gameStore.setLoading(true);\n            try {\n                // 初始化角色数据\n                await characterStore.initialize();\n                characterStore.setupMessageListener();\n                // 导航到游戏主页面\n                router.push('/game');\n            }\n            catch (e) {\n                console.error('[启动] 初始化失败:', e);\n                toastError('初始化失败，请刷新页面重试');\n            }\n            finally {\n                isLoading.value = false;\n                gameStore.setLoading(false);\n            }\n        }\n        function getRabbitStyle(index) {\n            const positions = [\n                { left: '5%', top: '15%', size: '20px', delay: '0s' },\n                { left: '90%', top: '25%', size: '16px', delay: '0.5s' },\n                { left: '8%', top: '75%', size: '18px', delay: '1s' },\n                { left: '92%', top: '70%', size: '22px', delay: '1.5s' },\n                { left: '50%', top: '90%', size: '14px', delay: '2s' },\n            ];\n            const pos = positions[index - 1] || positions[0];\n            return {\n                left: pos.left,\n                top: pos.top,\n                width: pos.size,\n                height: pos.size,\n                animationDelay: pos.delay,\n            };\n        }\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _createCommentVNode(\" Logo \"),\n                    _cache[1] || (_cache[1] = _createElementVNode(\"div\", { class: \"logo-container animate-fadeInDown\" }, [\n                        _createElementVNode(\"svg\", {\n                            class: \"logo-svg\",\n                            viewBox: \"0 0 400 120\"\n                        }, [\n                            _createElementVNode(\"text\", {\n                                x: \"50%\",\n                                y: \"50%\",\n                                \"text-anchor\": \"middle\",\n                                \"dominant-baseline\": \"middle\",\n                                class: \"logo-text\"\n                            }, \" ご注文はうさぎですか？ \"),\n                            _createElementVNode(\"text\", {\n                                x: \"50%\",\n                                y: \"85%\",\n                                \"text-anchor\": \"middle\",\n                                \"dominant-baseline\": \"middle\",\n                                class: \"logo-subtitle\"\n                            }, \" 请问您今天要来点兔子吗？ \")\n                        ])\n                    ], -1 /* CACHED */)),\n                    _createCommentVNode(\" Press Start Button \"),\n                    _createElementVNode(\"button\", {\n                        class: \"press-start-btn animate-fadeInUp\",\n                        disabled: _unref(isLoading),\n                        onClick: handleStart\n                    }, [\n                        _createElementVNode(\"span\", {\n                            class: _normalizeClass([\"btn-text\", { 'animate-pulse': !_unref(isLoading) }])\n                        }, _toDisplayString(_unref(isLoading) ? '加载中...' : 'Press Start'), 3 /* TEXT, CLASS */),\n                        _cache[0] || (_cache[0] = _createElementVNode(\"span\", { class: \"btn-decor\" }, null, -1 /* CACHED */))\n                    ], 8 /* PROPS */, _hoisted_3),\n                    _createCommentVNode(\" Version Info \"),\n                    _cache[2] || (_cache[2] = _createElementVNode(\"div\", { class: \"version-info animate-fadeIn\" }, [\n                        _createElementVNode(\"span\", null, \"Version 1.0.0\"),\n                        _createElementVNode(\"span\", { class: \"separator\" }, \"|\"),\n                        _createElementVNode(\"span\", null, \"点兔同层前端\")\n                    ], -1 /* CACHED */))\n                ]),\n                _createCommentVNode(\" Decorative elements \"),\n                _createElementVNode(\"div\", _hoisted_4, [\n                    (_openBlock(), _createElementBlock(_Fragment, null, _renderList(5, (i) => {\n                        return _createElementVNode(\"svg\", {\n                            key: i,\n                            class: \"rabbit-icon\",\n                            style: _normalizeStyle(getRabbitStyle(i)),\n                            viewBox: \"0 0 24 24\"\n                        }, [...(_cache[3] || (_cache[3] = [\n                                _createElementVNode(\"path\", {\n                                    d: \"M12 2C9.5 2 7.5 4 7.5 6.5C7.5 7.5 7.8 8.4 8.3 9.1L6 14L9 12L12 16L15 12L18 14L15.7 9.1C16.2 8.4 16.5 7.5 16.5 6.5C16.5 4 14.5 2 12 2Z\",\n                                    fill: \"currentColor\"\n                                }, null, -1 /* CACHED */)\n                            ]))], 4 /* STYLE */);\n                    }), 64 /* STABLE_FRAGMENT */))\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./StartScreen.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./StartScreen.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./StartScreen.vue?vue&type=style&index=0&id=e5a8aa30&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-e5a8aa30\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, unref as _unref, isRef as _isRef, vModelText as _vModelText, withDirectives as _withDirectives, openBlock as _openBlock, createElementBlock as _createElementBlock, renderList as _renderList, Fragment as _Fragment, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, withModifiers as _withModifiers, Transition as _Transition, withCtx as _withCtx, createVNode as _createVNode } from \"vue\";\nconst _hoisted_1 = { class: \"worldbook-manager\" };\nconst _hoisted_2 = { class: \"search-section\" };\nconst _hoisted_3 = { class: \"search-input-wrapper\" };\nconst _hoisted_4 = {\n    key: 0,\n    class: \"loading-state\"\n};\nconst _hoisted_5 = { class: \"entries-list\" };\nconst _hoisted_6 = { class: \"entry-toggle\" };\nconst _hoisted_7 = { class: \"toggle-switch\" };\nconst _hoisted_8 = [\"checked\", \"onChange\"];\nconst _hoisted_9 = { class: \"entry-info\" };\nconst _hoisted_10 = { class: \"entry-header\" };\nconst _hoisted_11 = { class: \"entry-key\" };\nconst _hoisted_12 = { class: \"entry-comment\" };\nconst _hoisted_13 = [\"onClick\"];\nconst _hoisted_14 = {\n    key: 0,\n    class: \"empty-state\"\n};\nconst _hoisted_15 = { class: \"modal-header\" };\nconst _hoisted_16 = { class: \"modal-title\" };\nconst _hoisted_17 = { class: \"modal-body\" };\nconst _hoisted_18 = { class: \"detail-item\" };\nconst _hoisted_19 = { class: \"detail-value\" };\nconst _hoisted_20 = { class: \"detail-item\" };\nconst _hoisted_21 = { class: \"detail-value\" };\nconst _hoisted_22 = { class: \"detail-item\" };\nconst _hoisted_23 = { class: \"detail-content\" };\nconst _hoisted_24 = { class: \"modal-footer\" };\nimport { useRouter } from 'vue-router';\nimport { toastError, toastSuccess } from '../utils/toast';\n\nimport { ref, computed, onMounted } from 'vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'WorldbookManager',\n    setup(__props) {\n        const router = useRouter();\n        const searchQuery = ref('');\n        const isLoading = ref(true);\n        const entries = ref([]);\n        const selectedEntry = ref(null);\n        const worldbookName = ref(null);\n        const filteredEntries = computed(() => {\n            if (!searchQuery.value)\n                return entries.value;\n            const query = searchQuery.value.toLowerCase();\n            return entries.value.filter(entry => entry.name.toLowerCase().includes(query) ||\n                entry.comment?.toLowerCase().includes(query) ||\n                entry.content.toLowerCase().includes(query) ||\n                entry.keys.some(k => k.toLowerCase().includes(query)));\n        });\n        async function loadWorldbook() {\n            isLoading.value = true;\n            try {\n                // 获取当前角色卡绑定的世界书\n                const charWorldbooks = getCharWorldbookNames('current');\n                const wbName = charWorldbooks.primary;\n                if (!wbName) {\n                    console.log('[世界书] 当前角色卡没有绑定世界书');\n                    entries.value = [];\n                    return;\n                }\n                worldbookName.value = wbName;\n                const worldbook = await getWorldbook(wbName);\n                if (worldbook && Array.isArray(worldbook)) {\n                    entries.value = worldbook.map(entry => ({\n                        uid: entry.uid,\n                        name: entry.name || '未命名',\n                        keys: entry.strategy?.keys?.map(k => String(k)) || [],\n                        comment: entry.content?.slice(0, 100),\n                        content: entry.content || '',\n                        enabled: entry.enabled ?? true,\n                    }));\n                }\n            }\n            catch (e) {\n                console.error('[世界书] 加载失败:', e);\n            }\n            finally {\n                isLoading.value = false;\n            }\n        }\n        async function toggleEntry(entry) {\n            if (!worldbookName.value)\n                return;\n            try {\n                await updateWorldbookWith(worldbookName.value, worldbook => {\n                    return worldbook.map(e => {\n                        if (e.uid === entry.uid) {\n                            return { ...e, enabled: !entry.enabled };\n                        }\n                        return e;\n                    });\n                });\n                entry.enabled = !entry.enabled;\n                toastSuccess(entry.enabled ? '已启用条目' : '已禁用条目');\n            }\n            catch (e) {\n                console.error('[世界书] 切换状态失败:', e);\n                toastError('操作失败');\n            }\n        }\n        function viewEntry(entry) {\n            selectedEntry.value = entry;\n        }\n        function closeModal() {\n            selectedEntry.value = null;\n        }\n        function clearSearch() {\n            searchQuery.value = '';\n        }\n        function goBack() {\n            router.push('/game');\n        }\n        onMounted(() => {\n            loadWorldbook();\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createCommentVNode(\" Header \"),\n                _createElementVNode(\"header\", { class: \"wb-header\" }, [\n                    _createElementVNode(\"button\", {\n                        class: \"back-btn\",\n                        onClick: goBack\n                    }, [...(_cache[3] || (_cache[3] = [\n                            _createElementVNode(\"i\", { class: \"fa-solid fa-arrow-left\" }, null, -1 /* CACHED */)\n                        ]))]),\n                    _cache[4] || (_cache[4] = _createElementVNode(\"h1\", { class: \"header-title\" }, \"世界书管理\", -1 /* CACHED */))\n                ]),\n                _createCommentVNode(\" Search Bar \"),\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _createElementVNode(\"div\", _hoisted_3, [\n                        _cache[6] || (_cache[6] = _createElementVNode(\"i\", { class: \"fa-solid fa-search\" }, null, -1 /* CACHED */)),\n                        _withDirectives(_createElementVNode(\"input\", {\n                            \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event) => (_isRef(searchQuery) ? (searchQuery).value = $event : null)),\n                            type: \"text\",\n                            class: \"search-input\",\n                            placeholder: \"搜索条目...\"\n                        }, null, 512 /* NEED_PATCH */), [\n                            [_vModelText, _unref(searchQuery)]\n                        ]),\n                        (_unref(searchQuery))\n                            ? (_openBlock(), _createElementBlock(\"button\", {\n                                key: 0,\n                                class: \"clear-btn\",\n                                onClick: clearSearch\n                            }, [...(_cache[5] || (_cache[5] = [\n                                    _createElementVNode(\"i\", { class: \"fa-solid fa-times\" }, null, -1 /* CACHED */)\n                                ]))]))\n                            : _createCommentVNode(\"v-if\", true)\n                    ])\n                ]),\n                _createCommentVNode(\" Loading State \"),\n                (_unref(isLoading))\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, [...(_cache[7] || (_cache[7] = [\n                            _createElementVNode(\"div\", { class: \"loading-spinner\" }, null, -1 /* CACHED */),\n                            _createElementVNode(\"span\", null, \"加载中...\", -1 /* CACHED */)\n                        ]))]))\n                    : (_openBlock(), _createElementBlock(_Fragment, { key: 1 }, [\n                        _createCommentVNode(\" Entries List \"),\n                        _createElementVNode(\"main\", _hoisted_5, [\n                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(filteredEntries), (entry) => {\n                                return (_openBlock(), _createElementBlock(\"div\", {\n                                    key: entry.uid,\n                                    class: \"entry-card\"\n                                }, [\n                                    _createElementVNode(\"div\", _hoisted_6, [\n                                        _createElementVNode(\"label\", _hoisted_7, [\n                                            _createElementVNode(\"input\", {\n                                                type: \"checkbox\",\n                                                checked: entry.enabled,\n                                                onChange: ($event) => (toggleEntry(entry))\n                                            }, null, 40 /* PROPS, NEED_HYDRATION */, _hoisted_8),\n                                            _cache[8] || (_cache[8] = _createElementVNode(\"span\", { class: \"toggle-slider\" }, null, -1 /* CACHED */))\n                                        ])\n                                    ]),\n                                    _createElementVNode(\"div\", _hoisted_9, [\n                                        _createElementVNode(\"div\", _hoisted_10, [\n                                            _createElementVNode(\"span\", _hoisted_11, _toDisplayString(entry.name), 1 /* TEXT */),\n                                            _createElementVNode(\"span\", {\n                                                class: _normalizeClass([\"entry-status\", { enabled: entry.enabled, disabled: !entry.enabled }])\n                                            }, _toDisplayString(entry.enabled ? '已启用' : '已禁用'), 3 /* TEXT, CLASS */)\n                                        ]),\n                                        _createElementVNode(\"p\", _hoisted_12, _toDisplayString(entry.comment || '无描述'), 1 /* TEXT */)\n                                    ]),\n                                    _createElementVNode(\"button\", {\n                                        class: \"entry-action\",\n                                        title: \"查看详情\",\n                                        onClick: ($event) => (viewEntry(entry))\n                                    }, [...(_cache[9] || (_cache[9] = [\n                                            _createElementVNode(\"i\", { class: \"fa-solid fa-eye\" }, null, -1 /* CACHED */)\n                                        ]))], 8 /* PROPS */, _hoisted_13)\n                                ]));\n                            }), 128 /* KEYED_FRAGMENT */)),\n                            _createCommentVNode(\" Empty State \"),\n                            (_unref(filteredEntries).length === 0 && !_unref(isLoading))\n                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_14, [...(_cache[10] || (_cache[10] = [\n                                        _createElementVNode(\"i\", { class: \"fa-solid fa-book-open\" }, null, -1 /* CACHED */),\n                                        _createElementVNode(\"p\", null, \"暂无世界书条目\", -1 /* CACHED */)\n                                    ]))]))\n                                : _createCommentVNode(\"v-if\", true)\n                        ])\n                    ], 2112 /* STABLE_FRAGMENT, DEV_ROOT_FRAGMENT */)),\n                _createCommentVNode(\" Entry Detail Modal \"),\n                _createVNode(_Transition, { name: \"modal\" }, {\n                    default: _withCtx(() => [\n                        (_unref(selectedEntry))\n                            ? (_openBlock(), _createElementBlock(\"div\", {\n                                key: 0,\n                                class: \"modal-overlay\",\n                                onClick: closeModal\n                            }, [\n                                _createElementVNode(\"div\", {\n                                    class: \"modal-content\",\n                                    onClick: _cache[2] || (_cache[2] = _withModifiers(() => { }, [\"stop\"]))\n                                }, [\n                                    _createElementVNode(\"header\", _hoisted_15, [\n                                        _createElementVNode(\"h2\", _hoisted_16, _toDisplayString(_unref(selectedEntry).name), 1 /* TEXT */),\n                                        _createElementVNode(\"button\", {\n                                            class: \"modal-close\",\n                                            onClick: closeModal\n                                        }, [...(_cache[11] || (_cache[11] = [\n                                                _createElementVNode(\"i\", { class: \"fa-solid fa-times\" }, null, -1 /* CACHED */)\n                                            ]))])\n                                    ]),\n                                    _createElementVNode(\"div\", _hoisted_17, [\n                                        _createElementVNode(\"div\", _hoisted_18, [\n                                            _cache[12] || (_cache[12] = _createElementVNode(\"span\", { class: \"detail-label\" }, \"关键词\", -1 /* CACHED */)),\n                                            _createElementVNode(\"span\", _hoisted_19, _toDisplayString(_unref(selectedEntry).keys?.join(', ') || '无'), 1 /* TEXT */)\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_20, [\n                                            _cache[13] || (_cache[13] = _createElementVNode(\"span\", { class: \"detail-label\" }, \"描述\", -1 /* CACHED */)),\n                                            _createElementVNode(\"span\", _hoisted_21, _toDisplayString(_unref(selectedEntry).comment || '无'), 1 /* TEXT */)\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_22, [\n                                            _cache[14] || (_cache[14] = _createElementVNode(\"span\", { class: \"detail-label\" }, \"内容\", -1 /* CACHED */)),\n                                            _createElementVNode(\"pre\", _hoisted_23, _toDisplayString(_unref(selectedEntry).content), 1 /* TEXT */)\n                                        ])\n                                    ]),\n                                    _createElementVNode(\"footer\", _hoisted_24, [\n                                        _createElementVNode(\"button\", {\n                                            class: \"btn btn-secondary\",\n                                            onClick: closeModal\n                                        }, \"关闭\"),\n                                        _createElementVNode(\"button\", {\n                                            class: \"btn btn-primary\",\n                                            onClick: _cache[1] || (_cache[1] = ($event) => (toggleEntry(_unref(selectedEntry))))\n                                        }, _toDisplayString(_unref(selectedEntry).enabled ? '禁用' : '启用'), 1 /* TEXT */)\n                                    ])\n                                ])\n                            ]))\n                            : _createCommentVNode(\"v-if\", true)\n                    ]),\n                    _: 1 /* STABLE */\n                })\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./WorldbookManager.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./WorldbookManager.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./WorldbookManager.vue?vue&type=style&index=0&id=507cc824&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-507cc824\"]])\n\nexport default __exports__","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// runtime helper for setting properties on components\n// in a tree-shakable way\nexports.default = (sfc, props) => {\n    const target = sfc.__vccOpts || sfc;\n    for (const [key, val] of props) {\n        target[key] = val;\n    }\n    return target;\n};\n","var x = (y) => {\n\tvar x = {}; __webpack_require__.d(x, y); return x\n} \nvar y = (x) => (() => (x))\nmodule.exports = x({ [\"createPinia\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_pinia_esm_b723a504__.createPinia), [\"defineStore\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_pinia_esm_b723a504__.defineStore) });","var x = (y) => {\n\tvar x = {}; __webpack_require__.d(x, y); return x\n} \nvar y = (x) => (() => (x))\nmodule.exports = x({ [\"createMemoryHistory\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_router_esm_7a560a22__.createMemoryHistory), [\"createRouter\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_router_esm_7a560a22__.createRouter), [\"useRoute\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_router_esm_7a560a22__.useRoute), [\"useRouter\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_router_esm_7a560a22__.useRouter) });","var x = (y) => {\n\tvar x = {}; __webpack_require__.d(x, y); return x\n} \nvar y = (x) => (() => (x))\nmodule.exports = x({ [\"Fragment\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_esm_81736d96__.Fragment), [\"Transition\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_esm_81736d96__.Transition), [\"TransitionGroup\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_esm_81736d96__.TransitionGroup), [\"computed\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_esm_81736d96__.computed), [\"createApp\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_esm_81736d96__.createApp), [\"createBlock\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_esm_81736d96__.createBlock), [\"createCommentVNode\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_esm_81736d96__.createCommentVNode), [\"createElementBlock\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_esm_81736d96__.createElementBlock), [\"createElementVNode\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_esm_81736d96__.createElementVNode), [\"createStaticVNode\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_esm_81736d96__.createStaticVNode), [\"createTextVNode\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_esm_81736d96__.createTextVNode), [\"createVNode\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_esm_81736d96__.createVNode), [\"defineComponent\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_esm_81736d96__.defineComponent), [\"isRef\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_esm_81736d96__.isRef), [\"normalizeClass\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_esm_81736d96__.normalizeClass), [\"normalizeStyle\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_esm_81736d96__.normalizeStyle), [\"onMounted\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_esm_81736d96__.onMounted), [\"onUnmounted\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_esm_81736d96__.onUnmounted), [\"openBlock\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_esm_81736d96__.openBlock), [\"ref\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_esm_81736d96__.ref), [\"renderList\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_esm_81736d96__.renderList), [\"resolveComponent\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_esm_81736d96__.resolveComponent), [\"resolveDynamicComponent\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_esm_81736d96__.resolveDynamicComponent), [\"toDisplayString\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_esm_81736d96__.toDisplayString), [\"unref\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_esm_81736d96__.unref), [\"vModelCheckbox\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_esm_81736d96__.vModelCheckbox), [\"vModelSelect\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_esm_81736d96__.vModelSelect), [\"vModelText\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_esm_81736d96__.vModelText), [\"vShow\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_esm_81736d96__.vShow), [\"watch\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_esm_81736d96__.watch), [\"watchEffect\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_esm_81736d96__.watchEffect), [\"withCtx\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_esm_81736d96__.withCtx), [\"withDirectives\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_esm_81736d96__.withDirectives), [\"withKeys\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_esm_81736d96__.withKeys), [\"withModifiers\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_esm_81736d96__.withModifiers) });","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import { defineComponent as _defineComponent } from 'vue';\nimport { createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, renderList as _renderList, Fragment as _Fragment, normalizeStyle as _normalizeStyle, createStaticVNode as _createStaticVNode } from \"vue\";\nconst _hoisted_1 = { class: \"background-layer\" };\nconst _hoisted_2 = { class: \"particles\" };\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'BackgroundLayer',\n    setup(__props) {\n        function getParticleStyle(index) {\n            const positions = [\n                { left: '10%', top: '20%', delay: '0s', duration: '4s' },\n                { left: '80%', top: '15%', delay: '1s', duration: '5s' },\n                { left: '25%', top: '70%', delay: '2s', duration: '4.5s' },\n                { left: '70%', top: '60%', delay: '0.5s', duration: '5.5s' },\n                { left: '50%', top: '40%', delay: '1.5s', duration: '4s' },\n                { left: '35%', top: '85%', delay: '2.5s', duration: '5s' },\n            ];\n            const pos = positions[index - 1] || positions[0];\n            return {\n                left: pos.left,\n                top: pos.top,\n                animationDelay: pos.delay,\n                animationDuration: pos.duration,\n            };\n        }\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createCommentVNode(\" Base gradient \"),\n                _cache[0] || (_cache[0] = _createElementVNode(\"div\", { class: \"bg-gradient\" }, null, -1 /* CACHED */)),\n                _createCommentVNode(\" Decorative pattern overlay \"),\n                _cache[1] || (_cache[1] = _createElementVNode(\"div\", { class: \"bg-pattern\" }, null, -1 /* CACHED */)),\n                _createCommentVNode(\" Corner decorations \"),\n                _cache[2] || (_cache[2] = _createStaticVNode(\"<svg class=\\\"corner-decor corner-top-left\\\" width=\\\"120\\\" height=\\\"120\\\" viewBox=\\\"0 0 120 120\\\" data-v-34dbe2c4><path d=\\\"M0,0 Q60,10 50,50 T0,100\\\" fill=\\\"none\\\" stroke=\\\"var(--decor-gold)\\\" stroke-width=\\\"1.5\\\" opacity=\\\"0.3\\\" data-v-34dbe2c4></path><path d=\\\"M0,20 Q40,25 35,55 T0,90\\\" fill=\\\"none\\\" stroke=\\\"var(--decor-rose)\\\" stroke-width=\\\"1\\\" opacity=\\\"0.2\\\" data-v-34dbe2c4></path><circle cx=\\\"20\\\" cy=\\\"20\\\" r=\\\"3\\\" fill=\\\"var(--decor-gold)\\\" opacity=\\\"0.4\\\" data-v-34dbe2c4></circle></svg><svg class=\\\"corner-decor corner-top-right\\\" width=\\\"120\\\" height=\\\"120\\\" viewBox=\\\"0 0 120 120\\\" data-v-34dbe2c4><path d=\\\"M120,0 Q60,10 70,50 T120,100\\\" fill=\\\"none\\\" stroke=\\\"var(--decor-gold)\\\" stroke-width=\\\"1.5\\\" opacity=\\\"0.3\\\" data-v-34dbe2c4></path><path d=\\\"M120,20 Q80,25 85,55 T120,90\\\" fill=\\\"none\\\" stroke=\\\"var(--decor-rose)\\\" stroke-width=\\\"1\\\" opacity=\\\"0.2\\\" data-v-34dbe2c4></path><circle cx=\\\"100\\\" cy=\\\"20\\\" r=\\\"3\\\" fill=\\\"var(--decor-gold)\\\" opacity=\\\"0.4\\\" data-v-34dbe2c4></circle></svg><svg class=\\\"corner-decor corner-bottom-left\\\" width=\\\"120\\\" height=\\\"120\\\" viewBox=\\\"0 0 120 120\\\" data-v-34dbe2c4><path d=\\\"M0,120 Q60,110 50,70 T0,20\\\" fill=\\\"none\\\" stroke=\\\"var(--decor-gold)\\\" stroke-width=\\\"1.5\\\" opacity=\\\"0.3\\\" data-v-34dbe2c4></path><path d=\\\"M0,100 Q40,95 35,65 T0,30\\\" fill=\\\"none\\\" stroke=\\\"var(--decor-rose)\\\" stroke-width=\\\"1\\\" opacity=\\\"0.2\\\" data-v-34dbe2c4></path><circle cx=\\\"20\\\" cy=\\\"100\\\" r=\\\"3\\\" fill=\\\"var(--decor-gold)\\\" opacity=\\\"0.4\\\" data-v-34dbe2c4></circle></svg><svg class=\\\"corner-decor corner-bottom-right\\\" width=\\\"120\\\" height=\\\"120\\\" viewBox=\\\"0 0 120 120\\\" data-v-34dbe2c4><path d=\\\"M120,120 Q60,110 70,70 T120,20\\\" fill=\\\"none\\\" stroke=\\\"var(--decor-gold)\\\" stroke-width=\\\"1.5\\\" opacity=\\\"0.3\\\" data-v-34dbe2c4></path><path d=\\\"M120,100 Q80,95 85,65 T120,30\\\" fill=\\\"none\\\" stroke=\\\"var(--decor-rose)\\\" stroke-width=\\\"1\\\" opacity=\\\"0.2\\\" data-v-34dbe2c4></path><circle cx=\\\"100\\\" cy=\\\"100\\\" r=\\\"3\\\" fill=\\\"var(--decor-gold)\\\" opacity=\\\"0.4\\\" data-v-34dbe2c4></circle></svg>\", 4)),\n                _createCommentVNode(\" Floating particles \"),\n                _createElementVNode(\"div\", _hoisted_2, [\n                    (_openBlock(), _createElementBlock(_Fragment, null, _renderList(6, (i) => {\n                        return _createElementVNode(\"div\", {\n                            key: i,\n                            class: \"particle\",\n                            style: _normalizeStyle(getParticleStyle(i))\n                        }, null, 4 /* STYLE */);\n                    }), 64 /* STABLE_FRAGMENT */))\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./BackgroundLayer.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./BackgroundLayer.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./BackgroundLayer.vue?vue&type=style&index=0&id=34dbe2c4&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-34dbe2c4\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { unref as _unref, createVNode as _createVNode, resolveDynamicComponent as _resolveDynamicComponent, openBlock as _openBlock, createBlock as _createBlock, Transition as _Transition, withCtx as _withCtx, resolveComponent as _resolveComponent, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = [\"data-theme\", \"data-font\", \"data-font-size\"];\nimport BackgroundLayer from './components/BackgroundLayer.vue';\nimport { useSettingsStore } from './stores/settingsStore';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'App',\n    setup(__props) {\n        const settingsStore = useSettingsStore();\n        return (_ctx, _cache) => {\n            const _component_router_view = _resolveComponent(\"router-view\");\n            return (_openBlock(), _createElementBlock(\"div\", {\n                class: \"app-container\",\n                \"data-theme\": _unref(settingsStore).settings.theme,\n                \"data-font\": _unref(settingsStore).settings.fontScheme,\n                \"data-font-size\": _unref(settingsStore).settings.fontSize\n            }, [\n                _createVNode(BackgroundLayer),\n                _createVNode(_component_router_view, null, {\n                    default: _withCtx(({ Component }) => [\n                        _createVNode(_Transition, {\n                            name: \"page\",\n                            mode: \"out-in\"\n                        }, {\n                            default: _withCtx(() => [\n                                (_openBlock(), _createBlock(_resolveDynamicComponent(Component)))\n                            ]),\n                            _: 2 /* DYNAMIC */\n                        }, 1024 /* DYNAMIC_SLOTS */)\n                    ]),\n                    _: 1 /* STABLE */\n                })\n            ], 8 /* PROPS */, _hoisted_1));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./App.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./App.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./App.vue?vue&type=style&index=0&id=38159b61&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-38159b61\"]])\n\nexport default __exports__","import { createPinia } from 'pinia';\nimport { createApp } from 'vue';\nimport { createMemoryHistory, createRouter } from 'vue-router';\nimport App from './App.vue';\nimport './global.scss';\n\ntype JQueryLike = {\n  (handler: () => void): unknown;\n  (target: Window): { on: (event: string, handler: () => void) => void };\n};\n\n// 定义路由\nconst routes = [\n  {\n    path: '/',\n    name: 'start',\n    component: () => import('./components/StartScreen.vue'),\n  },\n  {\n    path: '/game',\n    name: 'game',\n    component: () => import('./components/GameMain.vue'),\n  },\n  {\n    path: '/character/:name',\n    name: 'character',\n    component: () => import('./components/CharacterDetail.vue'),\n  },\n  {\n    path: '/history',\n    name: 'history',\n    component: () => import('./components/HistoryMessages.vue'),\n  },\n  {\n    path: '/worldbook',\n    name: 'worldbook',\n    component: () => import('./components/WorldbookManager.vue'),\n  },\n  {\n    path: '/settings',\n    name: 'settings',\n    component: () => import('./components/SettingsPage.vue'),\n  },\n];\n\nconst router = createRouter({\n  history: createMemoryHistory(),\n  routes,\n});\n\n// 创建应用\nconst app = createApp(App);\napp.use(createPinia());\napp.use(router);\n\nfunction getJQuery(): JQueryLike | null {\n  const maybe$ = (globalThis as unknown as { $?: unknown }).$;\n  return typeof maybe$ === 'function' ? (maybe$ as JQueryLike) : null;\n}\n\nfunction onReady(handler: () => void) {\n  const $ = getJQuery();\n  if ($) {\n    $(handler);\n    return;\n  }\n\n  if (document.readyState === 'loading') {\n    document.addEventListener('DOMContentLoaded', handler, { once: true });\n  } else {\n    handler();\n  }\n}\n\nfunction onPageHide(handler: () => void) {\n  const $ = getJQuery();\n  if ($) {\n    $(window).on('pagehide', handler);\n    return;\n  }\n\n  window.addEventListener('pagehide', handler, { once: true });\n}\n\nfunction formatError(error: unknown): string {\n  if (error instanceof Error) {\n    return `${error.name}: ${error.message}`;\n  }\n  return String(error);\n}\n\nfunction renderFatalError(error: unknown) {\n  const appEl = document.getElementById('app');\n  if (!appEl) return;\n\n  const message = formatError(error);\n  appEl.innerHTML = `\n    <div style=\"padding: 16px; border: 1px solid #f0d4d4; border-radius: 8px; background: #fff7f7; color: #7a3030; font-size: 14px; line-height: 1.6;\">\n      <div style=\"font-weight: 700; margin-bottom: 8px;\">同层前端启动失败</div>\n      <div style=\"white-space: pre-wrap; word-break: break-word;\">${message}</div>\n    </div>\n  `;\n}\n\napp.config.errorHandler = error => {\n  console.error('[同层前端] Vue 运行时错误:', error);\n};\n\nrouter.onError(error => {\n  console.error('[同层前端] 路由错误:', error);\n});\n\nasync function bootstrap() {\n  // createMemoryHistory 在 iframe 场景下默认无初始位置，需要显式导航\n  await router.replace('/');\n  await router.isReady();\n  app.mount('#app');\n}\n\n// 挂载应用\nonReady(() => {\n  bootstrap()\n    .then(() => {\n      console.info('[同层前端] 界面加载成功');\n    })\n    .catch(error => {\n      console.error('[同层前端] 启动失败:', error);\n      renderFatalError(error);\n    });\n});\n\n// 卸载处理\nonPageHide(() => {\n  try {\n    app.unmount();\n    console.info('[同层前端] 界面卸载成功');\n  } catch (error) {\n    console.warn('[同层前端] 卸载异常:', error);\n  }\n});\n"],"names":["_","CHARACTER_NAME_MAP","CHARACTER_COLOR_MAP","useCharacterStore","defineStore","mvuData","ref","isInitialized","stopMessageListener","async","refreshData","data","Mvu","getMvuData","type","message_id","getCurrentMessageId","statData","value","e","console","warn","initialize","waitGlobalInitialized","info","error","getCharacterData","name","getCurrentSceneCharacters","names","Array","isArray","getWorldInfo","getMainPOV","setupMessageListener","eventOn","tavern_events","CHARACTER_MESSAGE_RENDERED","cleanupMessageListener","stop","useGameStore","currentPage","currentMessage","currentMessageId","options","currentCharacters","isCharacterBarCollapsed","isFullscreen","isLoading","isGenerating","selectedCharacter","navigateTo","page","updateMessage","message","messageId","updateOptions","newOptions","addCustomOption","title","content","newOption","id","Date","now","isCustom","push","removeOption","optionId","index","findIndex","opt","splice","updateCurrentCharacters","characters","toggleCharacterBar","toggleFullscreen","document","documentElement","requestFullscreen","exitFullscreen","selectCharacter","setLoading","loading","setGenerating","generating","defaultSettings","messageDisplayMode","theme","fontScheme","fontSize","enableAnimations","typewriterEffect","autoScroll","showCharacterBar","backgroundBlur","allowCustomOptions","DISPLAY_MODE_MAP","instant","typewriter","segment","card","bubble","classic","THEME_MAP","warm","cool","light","dark","sakura","ocean","FONT_SCHEME_MAP","default","reading","artistic","elegant","modern","normalizeTheme","normalizeFontScheme","normalizeFontSize","loadSettings","saved","localStorage","getItem","parsed","normalizeSettings","JSON","parse","useSettingsStore","settings","saveSettings","setItem","stringify","watchEffect","updateSettings","newSettings","resetSettings","notify","level","globalThis","toastr","toastrRef","handler","toastSuccess","toastError","_hoisted_1","class","_hoisted_2","key","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","__name","setup","__props","router","useRouter","route","useRoute","characterStore","characterName","computed","params","decodeURIComponent","characterData","portraitUrl","fileName","characterColor","hasItems","Object","keys","length","goBack","onMounted","_ctx","_cache","onClick","style","src","alt","charAt","item","props","String","required","color","size","emits","emit","__emit","imageError","handleClick","handleImageError","onError","collapsed","Boolean","toggle","getPortraitUrl","getCharacterColor","persisted","CharacterAvatar","$event","Number","displayMode","contentRef","optionsStartIndex","lastIndexOf","optionsEndIndex","hasOptions","mainContent","trim","slice","afterContent","formattedMainContent","formatMessage","formattedAfterContent","formatted","formatAsDisplayedMessage","html","result","forEach","regex","RegExp","replace","applyCharacterColors","watch","ref_key","innerHTML","option","disabled","handleRemove","custom","canSubmit","submit","reset","cancel","placeholder","maxlength","onKeyup","rows","allowCustom","gameStore","isAddingCustom","isDisabled","handleSelect","startAddingCustom","cancelAddingCustom","handleCustomSubmit","tag","OptionCard","onSelect","onRemove","CustomOptionInput","onSubmit","onCancel","isMenuOpen","toggleMenu","closeMenu","goToHistory","goToWorldbook","goToSettings","goToStart","handleOutsideClick","target","closest","addEventListener","onUnmounted","removeEventListener","settingsStore","loadCurrentMessage","lastMessageId","SillyTavern","chat","messages","getChatMessages","msg","role","optionsMatch","match","text","matchAll","map","parseOptions","handleSelectOption","createChatMessages","triggerSlash","Promise","resolve","setTimeout","toast","handleSelectCharacter","encodeURIComponent","initializeGame","TopNavBar","MessageDisplay","OptionsPanel","CharacterBar","onToggle","onSelectCharacter","searchQuery","isLoadingMore","hasMore","filteredMessages","query","toLowerCase","filter","preview","includes","loadMessages","chatLength","start","Math","max","end","newMessages","i","truncateText","fullContent","loadMore","maxLength","cleanText","getAvatarColor","getAvatarIcon","getRoleLabel","clearSearch","group","backgroundColor","_hoisted_21","_hoisted_22","_hoisted_23","_hoisted_24","_hoisted_25","_hoisted_26","_hoisted_27","_hoisted_28","_hoisted_29","_hoisted_30","_hoisted_31","_hoisted_32","_hoisted_33","_hoisted_34","themes","FONT_SIZE_ORDER","FONT_SIZE_LABEL","small","medium","large","fontSizeLabel","increaseFontSize","indexOf","decreaseFontSize","t","active","background","min","number","handleStart","getRabbitStyle","positions","left","top","delay","pos","width","height","animationDelay","viewBox","x","y","d","fill","entries","selectedEntry","worldbookName","filteredEntries","entry","comment","some","k","toggleEntry","updateWorldbookWith","worldbook","uid","enabled","closeModal","wbName","getCharWorldbookNames","primary","log","getWorldbook","strategy","loadWorldbook","checked","onChange","join","exports","sfc","__vccOpts","val","module","__webpack_require__","__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_pinia_esm_b723a504__","__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_router_esm_7a560a22__","__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_esm_81736d96__","__webpack_module_cache__","moduleId","cachedModule","undefined","__webpack_modules__","n","getter","__esModule","a","definition","o","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","r","Symbol","toStringTag","getParticleStyle","duration","animationDuration","_component_router_view","BackgroundLayer","Component","mode","routes","path","component","createRouter","history","createMemoryHistory","app","createApp","App","getJQuery","maybe$","$","renderFatalError","appEl","getElementById","Error","formatError","use","createPinia","config","errorHandler","readyState","once","onReady","isReady","mount","bootstrap","then","catch","window","on","onPageHide","unmount"],"sourceRoot":""}