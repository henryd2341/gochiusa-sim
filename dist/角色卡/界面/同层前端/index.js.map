{"version":3,"file":"index.js","mappings":"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","sources":["src://tavern_helper_template/src/角色卡/界面/同层前端/stores/characterStore.ts","src://tavern_helper_template/src/角色卡/界面/同层前端/stores/settingsStore.ts","src://tavern_helper_template/src/角色卡/界面/同层前端/stores/gameStore.ts","webpack://tavern_helper_template/./src/角色卡/界面/同层前端/components/MessageDisplay.vue?4809","webpack://tavern_helper_template/src/角色卡/界面/同层前端/components/MessageDisplay.vue?acba","webpack://tavern_helper_template/./src/角色卡/界面/同层前端/components/OptionsPanel.vue?0a20","webpack://tavern_helper_template/src/角色卡/界面/同层前端/components/OptionsPanel.vue?92dd","webpack://tavern_helper_template/./src/角色卡/界面/同层前端/components/GameMain.vue?fc65","webpack://tavern_helper_template/src/角色卡/界面/同层前端/components/GameMain.vue?c24f","webpack://tavern_helper_template/./src/角色卡/界面/同层前端/components/HistoryMessages.vue?e673","webpack://tavern_helper_template/src/角色卡/界面/同层前端/components/HistoryMessages.vue?927d","webpack://tavern_helper_template/./src/角色卡/界面/同层前端/components/SettingsPage.vue?ecab","webpack://tavern_helper_template/src/角色卡/界面/同层前端/components/SettingsPage.vue?3136","webpack://tavern_helper_template/./src/角色卡/界面/同层前端/components/StartScreen.vue?d0e6","webpack://tavern_helper_template/src/角色卡/界面/同层前端/components/StartScreen.vue?2b8e","src://tavern_helper_template/node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js","src://tavern_helper_template/external module \"https://testingcf.jsdelivr.net/npm/pinia/+esm\"","src://tavern_helper_template/external module \"https://testingcf.jsdelivr.net/npm/vue-router/+esm\"","src://tavern_helper_template/external module \"https://testingcf.jsdelivr.net/npm/vue/+esm\"","src://tavern_helper_template/webpack/bootstrap","src://tavern_helper_template/webpack/runtime/define property getters","src://tavern_helper_template/webpack/runtime/hasOwnProperty shorthand","src://tavern_helper_template/webpack/runtime/make namespace object","webpack://tavern_helper_template/./src/角色卡/界面/同层前端/components/TopNavBar.vue?ffc0","webpack://tavern_helper_template/src/角色卡/界面/同层前端/components/TopNavBar.vue?416f","webpack://tavern_helper_template/./src/角色卡/界面/同层前端/App.vue?3a2a","webpack://tavern_helper_template/src/角色卡/界面/同层前端/App.vue?f2cb","src://tavern_helper_template/src/角色卡/界面/同层前端/index.ts"],"sourcesContent":["import { defineStore } from 'pinia';\nimport { ref } from 'vue';\n\nexport interface MvuStatData extends Record<string, unknown> {\n  当前场景角色?: string[];\n  _主视角?: string;\n  世界?: Record<string, unknown>;\n}\n\nfunction resolveMessageId(input?: number): number {\n  if (typeof input === 'number' && Number.isFinite(input) && input >= 0) return input;\n  const latest = getLastMessageId();\n  return latest >= 0 ? latest : 0;\n}\n\nfunction toStatData(value: unknown): MvuStatData | null {\n  if (typeof value === 'object' && value !== null) return value as MvuStatData;\n  return null;\n}\n\nexport const useCharacterStore = defineStore('gochiusa-character-v3', () => {\n  const isReady = ref(false);\n  const mvuData = ref<MvuStatData | null>(null);\n\n  async function initialize(messageId?: number) {\n    if (!isReady.value) {\n      await waitGlobalInitialized('Mvu');\n      isReady.value = true;\n    }\n    await refresh(messageId);\n  }\n\n  async function refresh(messageId?: number) {\n    if (!isReady.value) {\n      await waitGlobalInitialized('Mvu');\n      isReady.value = true;\n    }\n\n    try {\n      const data = Mvu.getMvuData({ type: 'message', message_id: resolveMessageId(messageId) });\n      mvuData.value = toStatData(data?.stat_data);\n    } catch (error) {\n      console.warn('[同层前端_v3] 读取 MVU 数据失败:', error);\n      mvuData.value = null;\n    }\n  }\n\n  function getCurrentSceneCharacters(): string[] {\n    const names = mvuData.value?.当前场景角色;\n    return Array.isArray(names) ? names : [];\n  }\n\n  return {\n    isReady,\n    mvuData,\n    initialize,\n    refresh,\n    getCurrentSceneCharacters,\n  };\n});\n","import { defineStore } from 'pinia';\nimport { ref, watch } from 'vue';\n\nexport type ThemeMode = 'warm' | 'cool' | 'high-contrast' | 'eye-care';\nexport type FontScheme = 'default' | 'reading' | 'artistic';\nexport type FontSize = 'small' | 'medium' | 'large';\n\nexport interface UiSettings {\n  theme: ThemeMode;\n  fontScheme: FontScheme;\n  fontSize: FontSize;\n}\n\nconst STORAGE_KEY = 'gochiusa-sim.ui-settings.v3';\n\nconst defaultSettings: UiSettings = {\n  theme: 'warm',\n  fontScheme: 'default',\n  fontSize: 'medium',\n};\n\nfunction parseSettings(raw: string | null): UiSettings {\n  if (!raw) return { ...defaultSettings };\n\n  try {\n    const parsed = JSON.parse(raw) as Partial<UiSettings>;\n    return {\n      theme:\n        parsed.theme === 'warm' ||\n        parsed.theme === 'cool' ||\n        parsed.theme === 'high-contrast' ||\n        parsed.theme === 'eye-care'\n          ? parsed.theme\n          : defaultSettings.theme,\n      fontScheme:\n        parsed.fontScheme === 'default' || parsed.fontScheme === 'reading' || parsed.fontScheme === 'artistic'\n          ? parsed.fontScheme\n          : defaultSettings.fontScheme,\n      fontSize:\n        parsed.fontSize === 'small' || parsed.fontSize === 'medium' || parsed.fontSize === 'large'\n          ? parsed.fontSize\n          : defaultSettings.fontSize,\n    };\n  } catch {\n    return { ...defaultSettings };\n  }\n}\n\nexport const useSettingsStore = defineStore('gochiusa-settings-v3', () => {\n  const settings = ref<UiSettings>(parseSettings(localStorage.getItem(STORAGE_KEY)));\n\n  function updateSettings(next: Partial<UiSettings>) {\n    settings.value = { ...settings.value, ...next };\n  }\n\n  function resetSettings() {\n    settings.value = { ...defaultSettings };\n  }\n\n  watch(\n    settings,\n    value => {\n      try {\n        localStorage.setItem(STORAGE_KEY, JSON.stringify(value));\n      } catch {\n        // ignore storage write failures in sandboxed iframe\n      }\n    },\n    { deep: true },\n  );\n\n  return {\n    settings,\n    updateSettings,\n    resetSettings,\n  };\n});\n","import { defineStore } from 'pinia';\nimport { ref } from 'vue';\n\nexport interface RoleplayOption {\n  id: string;\n  title: string;\n  content: string;\n  isCustom?: boolean;\n}\n\nexport const useGameStore = defineStore('gochiusa-game-v3', () => {\n  const currentMessage = ref('');\n  const currentMessageId = ref(-1);\n  const options = ref<RoleplayOption[]>([]);\n  const isGenerating = ref(false);\n  const isLoading = ref(false);\n\n  function setMessage(message: string, messageId: number) {\n    currentMessage.value = message;\n    currentMessageId.value = messageId;\n  }\n\n  function setOptions(next: RoleplayOption[]) {\n    options.value = next;\n  }\n\n  function setGenerating(value: boolean) {\n    isGenerating.value = value;\n  }\n\n  function setLoading(value: boolean) {\n    isLoading.value = value;\n  }\n\n  return {\n    currentMessage,\n    currentMessageId,\n    options,\n    isGenerating,\n    isLoading,\n    setMessage,\n    setOptions,\n    setGenerating,\n    setLoading,\n  };\n});\n","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = { class: \"card message-display\" };\nconst _hoisted_2 = { class: \"head\" };\nconst _hoisted_3 = { class: \"content\" };\nimport { computed } from 'vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'MessageDisplay',\n    props: {\n        message: {},\n        messageId: {}\n    },\n    setup(__props) {\n        const props = __props;\n        const message = computed(() => props.message);\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"section\", _hoisted_1, [\n                _createElementVNode(\"header\", _hoisted_2, [\n                    _cache[0] || (_cache[0] = _createElementVNode(\"strong\", null, \"当前楼层：\", -1 /* CACHED */)),\n                    _createElementVNode(\"span\", null, _toDisplayString(__props.messageId >= 0 ? `#${__props.messageId}` : '暂无'), 1 /* TEXT */)\n                ]),\n                _createElementVNode(\"article\", _hoisted_3, _toDisplayString(message.value), 1 /* TEXT */)\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./MessageDisplay.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./MessageDisplay.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./MessageDisplay.vue?vue&type=style&index=0&id=43de0948&scoped=true&lang=scss\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-43de0948\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, renderList as _renderList, Fragment as _Fragment, toDisplayString as _toDisplayString, vModelText as _vModelText, withDirectives as _withDirectives } from \"vue\";\nconst _hoisted_1 = { class: \"card options-panel\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"empty\"\n};\nconst _hoisted_3 = {\n    key: 1,\n    class: \"list\"\n};\nconst _hoisted_4 = [\"disabled\", \"onClick\"];\nconst _hoisted_5 = { class: \"title\" };\nconst _hoisted_6 = { class: \"content\" };\nconst _hoisted_7 = { class: \"custom-row\" };\nconst _hoisted_8 = [\"disabled\"];\nimport { ref } from 'vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'OptionsPanel',\n    props: {\n        options: {},\n        disabled: { type: Boolean }\n    },\n    emits: [\"select\"],\n    setup(__props, { emit: __emit }) {\n        const props = __props;\n        const emit = __emit;\n        const customText = ref('');\n        function emitSelect(option) {\n            emit('select', option);\n        }\n        function submitCustom() {\n            const text = customText.value;\n            if (!text)\n                return;\n            emit('select', {\n                id: `custom-${Date.now()}`,\n                title: '自定义行动',\n                content: text,\n                isCustom: true,\n            });\n            customText.value = '';\n        }\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"section\", _hoisted_1, [\n                _cache[1] || (_cache[1] = _createElementVNode(\"header\", { class: \"head\" }, [\n                    _createElementVNode(\"strong\", null, \"可选行动\")\n                ], -1 /* CACHED */)),\n                (__props.options.length === 0)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, \"当前消息未解析出选项\"))\n                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(__props.options, (item) => {\n                            return (_openBlock(), _createElementBlock(\"button\", {\n                                key: item.id,\n                                class: \"option-btn\",\n                                disabled: __props.disabled,\n                                onClick: ($event) => (emitSelect(item))\n                            }, [\n                                _createElementVNode(\"span\", _hoisted_5, _toDisplayString(item.title), 1 /* TEXT */),\n                                _createElementVNode(\"span\", _hoisted_6, _toDisplayString(item.content), 1 /* TEXT */)\n                            ], 8 /* PROPS */, _hoisted_4));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ])),\n                _createElementVNode(\"div\", _hoisted_7, [\n                    _withDirectives(_createElementVNode(\"input\", {\n                        \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event) => ((customText).value = $event)),\n                        class: \"custom-input\",\n                        placeholder: \"输入自定义行动内容\"\n                    }, null, 512 /* NEED_PATCH */), [\n                        [\n                            _vModelText,\n                            customText.value,\n                            void 0,\n                            { trim: true }\n                        ]\n                    ]),\n                    _createElementVNode(\"button\", {\n                        class: \"custom-btn\",\n                        disabled: __props.disabled || !customText.value,\n                        onClick: submitCustom\n                    }, \"发送\", 8 /* PROPS */, _hoisted_8)\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./OptionsPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./OptionsPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./OptionsPanel.vue?vue&type=style&index=0&id=17d36e64&scoped=true&lang=scss\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-17d36e64\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { unref as _unref, createVNode as _createVNode, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = { class: \"meta card\" };\nconst _hoisted_2 = [\"disabled\"];\nimport { computed, onMounted, onUnmounted } from 'vue';\nimport { useCharacterStore } from '../stores/characterStore';\nimport { useGameStore } from '../stores/gameStore';\nimport MessageDisplay from './MessageDisplay.vue';\nimport OptionsPanel from './OptionsPanel.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'GameMain',\n    setup(__props) {\n        const gameStore = useGameStore();\n        const characterStore = useCharacterStore();\n        const sceneCharactersText = computed(() => {\n            const list = characterStore.getCurrentSceneCharacters();\n            return list.length > 0 ? list.join(' / ') : '无';\n        });\n        function parseOptionsFromMessage(message) {\n            const block = message.match(/<roleplay_options>([\\s\\S]*?)<\\/roleplay_options>/i);\n            if (!block)\n                return [];\n            const lines = block[1]\n                .split('\\n')\n                .map(line => line.trim())\n                .filter(Boolean);\n            const options = [];\n            for (let i = 0; i < lines.length; i += 1) {\n                const line = lines[i];\n                const matched = line.match(/^(.+?)[:：]\\s*(.+)$/);\n                if (!matched)\n                    continue;\n                options.push({\n                    id: `opt-${i}-${Date.now()}`,\n                    title: matched[1].trim(),\n                    content: matched[2]\n                        .trim()\n                        .replace(/^「(.+)」$/, '$1')\n                        .replace(/^\\$\\{(.+)\\}$/, '$1'),\n                });\n            }\n            return options;\n        }\n        async function loadLatestAssistantMessage() {\n            const latestId = getLastMessageId();\n            if (latestId < 0) {\n                gameStore.setMessage('', -1);\n                gameStore.setOptions([]);\n                return;\n            }\n            const messages = getChatMessages(latestId, { role: 'assistant', hide_state: 'all' });\n            const current = messages[0];\n            if (!current) {\n                gameStore.setMessage('', latestId);\n                gameStore.setOptions([]);\n                return;\n            }\n            gameStore.setMessage(current.message ?? '', latestId);\n            gameStore.setOptions(parseOptionsFromMessage(current.message ?? ''));\n        }\n        async function refreshAll() {\n            gameStore.setLoading(true);\n            try {\n                await characterStore.refresh();\n                await loadLatestAssistantMessage();\n            }\n            finally {\n                gameStore.setLoading(false);\n            }\n        }\n        async function handleSelect(option) {\n            if (gameStore.isGenerating)\n                return;\n            gameStore.setGenerating(true);\n            try {\n                await createChatMessages([\n                    {\n                        role: 'user',\n                        message: option.content,\n                    },\n                ]);\n                await triggerSlash('/trigger');\n                await refreshAll();\n            }\n            catch (error) {\n                console.error('[同层前端_v3] 发送选项失败:', error);\n            }\n            finally {\n                gameStore.setGenerating(false);\n            }\n        }\n        let stopRendered = null;\n        onMounted(async () => {\n            await characterStore.initialize();\n            await refreshAll();\n            stopRendered = eventOn(tavern_events.CHARACTER_MESSAGE_RENDERED, async () => {\n                await refreshAll();\n            });\n        });\n        onUnmounted(() => {\n            stopRendered?.stop();\n            stopRendered = null;\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"section\", null, [\n                _createVNode(MessageDisplay, {\n                    message: _unref(gameStore).currentMessage,\n                    \"message-id\": _unref(gameStore).currentMessageId\n                }, null, 8 /* PROPS */, [\"message\", \"message-id\"]),\n                _createVNode(OptionsPanel, {\n                    options: _unref(gameStore).options,\n                    disabled: _unref(gameStore).isGenerating,\n                    onSelect: handleSelect\n                }, null, 8 /* PROPS */, [\"options\", \"disabled\"]),\n                _createElementVNode(\"div\", _hoisted_1, [\n                    _createElementVNode(\"div\", null, \"主视角：\" + _toDisplayString(_unref(characterStore).mvuData?._主视角 ?? '未知'), 1 /* TEXT */),\n                    _createElementVNode(\"div\", null, \"当前场景角色：\" + _toDisplayString(sceneCharactersText.value), 1 /* TEXT */),\n                    _createElementVNode(\"button\", {\n                        class: \"refresh-btn\",\n                        disabled: _unref(gameStore).isLoading,\n                        onClick: refreshAll\n                    }, _toDisplayString(_unref(gameStore).isLoading ? '刷新中...' : '刷新消息'), 9 /* TEXT, PROPS */, _hoisted_2)\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./GameMain.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./GameMain.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./GameMain.vue?vue&type=style&index=0&id=5b37e016&scoped=true&lang=scss\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-5b37e016\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, vModelText as _vModelText, withDirectives as _withDirectives, openBlock as _openBlock, createElementBlock as _createElementBlock, renderList as _renderList, Fragment as _Fragment, toDisplayString as _toDisplayString } from \"vue\";\nconst _hoisted_1 = { class: \"card history\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"empty\"\n};\nconst _hoisted_3 = {\n    key: 1,\n    class: \"list\"\n};\nconst _hoisted_4 = [\"onClick\"];\nconst _hoisted_5 = { class: \"preview\" };\nimport { computed, onMounted, ref } from 'vue';\nimport { useRouter } from 'vue-router';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'HistoryMessages',\n    setup(__props) {\n        const router = useRouter();\n        const rows = ref([]);\n        const keyword = ref('');\n        const filtered = computed(() => {\n            const key = keyword.value.toLowerCase();\n            if (!key)\n                return rows.value;\n            return rows.value.filter(item => item.message.toLowerCase().includes(key));\n        });\n        async function reload() {\n            const lastId = getLastMessageId();\n            const next = [];\n            for (let i = lastId; i >= 0; i -= 1) {\n                const found = getChatMessages(i, { hide_state: 'all' })[0];\n                if (!found?.message)\n                    continue;\n                next.push({\n                    message_id: found.message_id,\n                    role: found.role,\n                    message: found.message,\n                });\n                if (next.length >= 80)\n                    break;\n            }\n            rows.value = next;\n        }\n        async function jumpTo(messageId) {\n            try {\n                await triggerSlash(`/chat-jump ${messageId}`);\n            }\n            catch (error) {\n                console.warn('[同层前端_v3] 历史跳转失败:', error);\n            }\n            await router.push('/game');\n        }\n        onMounted(async () => {\n            await reload();\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"section\", _hoisted_1, [\n                _createElementVNode(\"header\", { class: \"head\" }, [\n                    _cache[1] || (_cache[1] = _createElementVNode(\"h2\", null, \"历史消息\", -1 /* CACHED */)),\n                    _createElementVNode(\"button\", {\n                        class: \"btn\",\n                        onClick: reload\n                    }, \"刷新\")\n                ]),\n                _withDirectives(_createElementVNode(\"input\", {\n                    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event) => ((keyword).value = $event)),\n                    class: \"search\",\n                    placeholder: \"搜索消息内容...\"\n                }, null, 512 /* NEED_PATCH */), [\n                    [\n                        _vModelText,\n                        keyword.value,\n                        void 0,\n                        { trim: true }\n                    ]\n                ]),\n                (filtered.value.length === 0)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, \"暂无匹配消息\"))\n                    : (_openBlock(), _createElementBlock(\"ul\", _hoisted_3, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(filtered.value, (item) => {\n                            return (_openBlock(), _createElementBlock(\"li\", {\n                                key: item.message_id,\n                                class: \"item\"\n                            }, [\n                                _createElementVNode(\"button\", {\n                                    class: \"jump\",\n                                    onClick: ($event) => (jumpTo(item.message_id))\n                                }, \"#\" + _toDisplayString(item.message_id) + \" · \" + _toDisplayString(item.role), 9 /* TEXT, PROPS */, _hoisted_4),\n                                _createElementVNode(\"p\", _hoisted_5, _toDisplayString(item.message), 1 /* TEXT */)\n                            ]));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ]))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./HistoryMessages.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./HistoryMessages.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./HistoryMessages.vue?vue&type=style&index=0&id=b25c270c&scoped=true&lang=scss\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-b25c270c\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, unref as _unref, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = { class: \"card settings\" };\nconst _hoisted_2 = { class: \"group\" };\nconst _hoisted_3 = [\"value\"];\nconst _hoisted_4 = { class: \"group\" };\nconst _hoisted_5 = [\"value\"];\nconst _hoisted_6 = { class: \"group\" };\nconst _hoisted_7 = [\"value\"];\nimport { computed } from 'vue';\nimport { useSettingsStore } from '../stores/settingsStore';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'SettingsPage',\n    setup(__props) {\n        const settingsStore = useSettingsStore();\n        const settings = computed(() => settingsStore.settings);\n        function onThemeChange(event) {\n            const value = event.target.value;\n            settingsStore.updateSettings({ theme: value });\n        }\n        function onFontChange(event) {\n            const value = event.target.value;\n            settingsStore.updateSettings({ fontScheme: value });\n        }\n        function onSizeChange(event) {\n            const value = event.target.value;\n            settingsStore.updateSettings({ fontSize: value });\n        }\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"section\", _hoisted_1, [\n                _cache[7] || (_cache[7] = _createElementVNode(\"h2\", null, \"基础设置\", -1 /* CACHED */)),\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _cache[2] || (_cache[2] = _createElementVNode(\"label\", null, \"主题\", -1 /* CACHED */)),\n                    _createElementVNode(\"select\", {\n                        value: settings.value.theme,\n                        onChange: onThemeChange\n                    }, [...(_cache[1] || (_cache[1] = [\n                            _createElementVNode(\"option\", { value: \"warm\" }, \"暖色\", -1 /* CACHED */),\n                            _createElementVNode(\"option\", { value: \"cool\" }, \"冷色\", -1 /* CACHED */),\n                            _createElementVNode(\"option\", { value: \"high-contrast\" }, \"高对比\", -1 /* CACHED */),\n                            _createElementVNode(\"option\", { value: \"eye-care\" }, \"护眼\", -1 /* CACHED */)\n                        ]))], 40 /* PROPS, NEED_HYDRATION */, _hoisted_3)\n                ]),\n                _createElementVNode(\"div\", _hoisted_4, [\n                    _cache[4] || (_cache[4] = _createElementVNode(\"label\", null, \"字体方案\", -1 /* CACHED */)),\n                    _createElementVNode(\"select\", {\n                        value: settings.value.fontScheme,\n                        onChange: onFontChange\n                    }, [...(_cache[3] || (_cache[3] = [\n                            _createElementVNode(\"option\", { value: \"default\" }, \"默认\", -1 /* CACHED */),\n                            _createElementVNode(\"option\", { value: \"reading\" }, \"阅读\", -1 /* CACHED */),\n                            _createElementVNode(\"option\", { value: \"artistic\" }, \"艺术\", -1 /* CACHED */)\n                        ]))], 40 /* PROPS, NEED_HYDRATION */, _hoisted_5)\n                ]),\n                _createElementVNode(\"div\", _hoisted_6, [\n                    _cache[6] || (_cache[6] = _createElementVNode(\"label\", null, \"字号\", -1 /* CACHED */)),\n                    _createElementVNode(\"select\", {\n                        value: settings.value.fontSize,\n                        onChange: onSizeChange\n                    }, [...(_cache[5] || (_cache[5] = [\n                            _createElementVNode(\"option\", { value: \"small\" }, \"小\", -1 /* CACHED */),\n                            _createElementVNode(\"option\", { value: \"medium\" }, \"中\", -1 /* CACHED */),\n                            _createElementVNode(\"option\", { value: \"large\" }, \"大\", -1 /* CACHED */)\n                        ]))], 40 /* PROPS, NEED_HYDRATION */, _hoisted_7)\n                ]),\n                _createElementVNode(\"button\", {\n                    class: \"reset-btn\",\n                    onClick: _cache[0] || (_cache[0] =\n                        //@ts-ignore\n                        (...args) => (_unref(settingsStore).resetSettings && _unref(settingsStore).resetSettings(...args)))\n                }, \"恢复默认\")\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./SettingsPage.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./SettingsPage.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./SettingsPage.vue?vue&type=style&index=0&id=0d5715f9&scoped=true&lang=scss\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-0d5715f9\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = { class: \"card start\" };\nconst _hoisted_2 = [\"disabled\"];\nimport { ref } from 'vue';\nimport { useRouter } from 'vue-router';\nimport { useCharacterStore } from '../stores/characterStore';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'StartScreen',\n    setup(__props) {\n        const router = useRouter();\n        const characterStore = useCharacterStore();\n        const isLoading = ref(false);\n        async function handleStart() {\n            if (isLoading.value)\n                return;\n            isLoading.value = true;\n            try {\n                await characterStore.initialize();\n                await router.push('/game');\n            }\n            catch (error) {\n                console.error('[同层前端_v3] 启动页初始化失败:', error);\n            }\n            finally {\n                isLoading.value = false;\n            }\n        }\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"section\", _hoisted_1, [\n                _cache[0] || (_cache[0] = _createElementVNode(\"h1\", null, \"点兔同层前端 v3\", -1 /* CACHED */)),\n                _cache[1] || (_cache[1] = _createElementVNode(\"p\", null, \"先初始化 MVU 与消息状态，再进入主界面。\", -1 /* CACHED */)),\n                _createElementVNode(\"button\", {\n                    class: \"start-btn\",\n                    disabled: isLoading.value,\n                    onClick: handleStart\n                }, _toDisplayString(isLoading.value ? '初始化中...' : 'Press Start'), 9 /* TEXT, PROPS */, _hoisted_2)\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./StartScreen.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./StartScreen.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./StartScreen.vue?vue&type=style&index=0&id=233bb37e&scoped=true&lang=scss\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-233bb37e\"]])\n\nexport default __exports__","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// runtime helper for setting properties on components\n// in a tree-shakable way\nexports.default = (sfc, props) => {\n    const target = sfc.__vccOpts || sfc;\n    for (const [key, val] of props) {\n        target[key] = val;\n    }\n    return target;\n};\n","var x = (y) => {\n\tvar x = {}; __webpack_require__.d(x, y); return x\n} \nvar y = (x) => (() => (x))\nmodule.exports = x({ [\"createPinia\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_pinia_esm_b723a504__.createPinia), [\"defineStore\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_pinia_esm_b723a504__.defineStore) });","var x = (y) => {\n\tvar x = {}; __webpack_require__.d(x, y); return x\n} \nvar y = (x) => (() => (x))\nmodule.exports = x({ [\"createMemoryHistory\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_router_esm_7a560a22__.createMemoryHistory), [\"createRouter\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_router_esm_7a560a22__.createRouter), [\"useRoute\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_router_esm_7a560a22__.useRoute), [\"useRouter\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_router_esm_7a560a22__.useRouter) });","var x = (y) => {\n\tvar x = {}; __webpack_require__.d(x, y); return x\n} \nvar y = (x) => (() => (x))\nmodule.exports = x({ [\"Fragment\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_esm_81736d96__.Fragment), [\"computed\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_esm_81736d96__.computed), [\"createApp\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_esm_81736d96__.createApp), [\"createBlock\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_esm_81736d96__.createBlock), [\"createCommentVNode\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_esm_81736d96__.createCommentVNode), [\"createElementBlock\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_esm_81736d96__.createElementBlock), [\"createElementVNode\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_esm_81736d96__.createElementVNode), [\"createVNode\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_esm_81736d96__.createVNode), [\"defineComponent\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_esm_81736d96__.defineComponent), [\"onMounted\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_esm_81736d96__.onMounted), [\"onUnmounted\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_esm_81736d96__.onUnmounted), [\"openBlock\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_esm_81736d96__.openBlock), [\"ref\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_esm_81736d96__.ref), [\"renderList\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_esm_81736d96__.renderList), [\"resolveComponent\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_esm_81736d96__.resolveComponent), [\"toDisplayString\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_esm_81736d96__.toDisplayString), [\"unref\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_esm_81736d96__.unref), [\"vModelText\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_esm_81736d96__.vModelText), [\"watch\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_esm_81736d96__.watch), [\"withDirectives\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_esm_81736d96__.withDirectives) });","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = { class: \"top-nav card\" };\nimport { useRouter } from 'vue-router';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'TopNavBar',\n    setup(__props) {\n        const router = useRouter();\n        function goStart() {\n            void router.push('/');\n        }\n        function goGame() {\n            void router.push('/game');\n        }\n        function goHistory() {\n            void router.push('/history');\n        }\n        function goSettings() {\n            void router.push('/settings');\n        }\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"header\", _hoisted_1, [\n                _createElementVNode(\"button\", {\n                    class: \"btn\",\n                    onClick: goStart\n                }, \"首页\"),\n                _cache[0] || (_cache[0] = _createElementVNode(\"div\", { class: \"spacer\" }, null, -1 /* CACHED */)),\n                _createElementVNode(\"button\", {\n                    class: \"btn\",\n                    onClick: goGame\n                }, \"主界面\"),\n                _createElementVNode(\"button\", {\n                    class: \"btn\",\n                    onClick: goHistory\n                }, \"历史\"),\n                _createElementVNode(\"button\", {\n                    class: \"btn\",\n                    onClick: goSettings\n                }, \"设置\")\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./TopNavBar.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./TopNavBar.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./TopNavBar.vue?vue&type=style&index=0&id=62b2dca0&scoped=true&lang=scss\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-62b2dca0\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { unref as _unref, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, createElementVNode as _createElementVNode, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = [\"data-theme\", \"data-font\", \"data-font-size\"];\nconst _hoisted_2 = { class: \"app-main\" };\nimport { useRoute } from 'vue-router';\nimport TopNavBar from './components/TopNavBar.vue';\nimport { useSettingsStore } from './stores/settingsStore';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'App',\n    setup(__props) {\n        const route = useRoute();\n        const settingsStore = useSettingsStore();\n        return (_ctx, _cache) => {\n            const _component_router_view = _resolveComponent(\"router-view\");\n            return (_openBlock(), _createElementBlock(\"div\", {\n                class: \"app-shell\",\n                \"data-theme\": _unref(settingsStore).settings.theme,\n                \"data-font\": _unref(settingsStore).settings.fontScheme,\n                \"data-font-size\": _unref(settingsStore).settings.fontSize\n            }, [\n                (_unref(route).name !== 'start')\n                    ? (_openBlock(), _createBlock(TopNavBar, { key: 0 }))\n                    : _createCommentVNode(\"v-if\", true),\n                _createElementVNode(\"main\", _hoisted_2, [\n                    _createVNode(_component_router_view)\n                ])\n            ], 8 /* PROPS */, _hoisted_1));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./App.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./App.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./App.vue?vue&type=style&index=0&id=dea1f0fc&scoped=true&lang=scss\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-dea1f0fc\"]])\n\nexport default __exports__","import { createPinia } from 'pinia';\nimport { createApp } from 'vue';\nimport { createMemoryHistory, createRouter } from 'vue-router';\nimport App from './App.vue';\nimport './global.scss';\n\ntype JQueryLike = {\n  (handler: () => void): unknown;\n  (target: Window): { on: (event: string, handler: () => void) => void };\n};\n\nconst router = createRouter({\n  history: createMemoryHistory(),\n  routes: [\n    { path: '/', name: 'start', component: () => import('./components/StartScreen.vue') },\n    { path: '/game', name: 'game', component: () => import('./components/GameMain.vue') },\n    { path: '/history', name: 'history', component: () => import('./components/HistoryMessages.vue') },\n    { path: '/settings', name: 'settings', component: () => import('./components/SettingsPage.vue') },\n  ],\n});\n\nconst app = createApp(App);\napp.use(createPinia());\napp.use(router);\n\nfunction getJQuery(): JQueryLike | null {\n  const maybe$ = (globalThis as unknown as { $?: unknown }).$;\n  return typeof maybe$ === 'function' ? (maybe$ as JQueryLike) : null;\n}\n\nfunction onReady(handler: () => void) {\n  const $ = getJQuery();\n  if ($) {\n    $(handler);\n    return;\n  }\n\n  if (document.readyState === 'loading') {\n    document.addEventListener('DOMContentLoaded', handler, { once: true });\n  } else {\n    handler();\n  }\n}\n\nfunction onPageHide(handler: () => void) {\n  const $ = getJQuery();\n  if ($) {\n    $(window).on('pagehide', handler);\n    return;\n  }\n  window.addEventListener('pagehide', handler, { once: true });\n}\n\nfunction formatError(error: unknown): string {\n  if (error instanceof Error) return `${error.name}: ${error.message}`;\n  return String(error);\n}\n\nfunction renderFatalError(error: unknown) {\n  const appEl = document.getElementById('app');\n  if (!appEl) return;\n  appEl.innerHTML = `\n    <div style=\"padding:12px;border:1px solid #f0d4d4;border-radius:8px;background:#fff7f7;color:#7a3030;line-height:1.6;\">\n      <div style=\"font-weight:700;margin-bottom:6px;\">同层前端启动失败</div>\n      <div style=\"white-space:pre-wrap;word-break:break-word;\">${formatError(error)}</div>\n    </div>\n  `;\n}\n\nasync function bootstrap() {\n  await router.replace('/');\n  await router.isReady();\n  app.mount('#app');\n}\n\napp.config.errorHandler = error => {\n  console.error('[同层前端_v3] Vue 运行时错误:', error);\n};\n\nrouter.onError(error => {\n  console.error('[同层前端_v3] 路由错误:', error);\n});\n\nonReady(() => {\n  bootstrap().catch(error => {\n    console.error('[同层前端_v3] 启动失败:', error);\n    renderFatalError(error);\n  });\n});\n\nonPageHide(() => {\n  try {\n    app.unmount();\n  } catch (error) {\n    console.warn('[同层前端_v3] 卸载异常:', error);\n  }\n});\n"],"names":["resolveMessageId","input","Number","isFinite","latest","getLastMessageId","useCharacterStore","defineStore","isReady","ref","mvuData","async","refresh","messageId","value","waitGlobalInitialized","data","Mvu","getMvuData","type","message_id","stat_data","error","console","warn","initialize","getCurrentSceneCharacters","names","Array","isArray","STORAGE_KEY","defaultSettings","theme","fontScheme","fontSize","useSettingsStore","settings","raw","parsed","JSON","parse","parseSettings","localStorage","getItem","watch","setItem","stringify","deep","updateSettings","next","resetSettings","useGameStore","currentMessage","currentMessageId","options","isGenerating","isLoading","setMessage","message","setOptions","setGenerating","setLoading","_hoisted_1","class","_hoisted_2","_hoisted_3","__name","props","setup","__props","computed","_ctx","_cache","key","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","disabled","Boolean","emits","emit","__emit","customText","submitCustom","text","id","Date","now","title","content","isCustom","length","item","onClick","$event","placeholder","trim","gameStore","characterStore","sceneCharactersText","list","join","loadLatestAssistantMessage","latestId","current","getChatMessages","role","hide_state","block","match","lines","split","map","line","filter","i","matched","push","replace","parseOptionsFromMessage","refreshAll","handleSelect","option","createChatMessages","triggerSlash","stopRendered","onMounted","eventOn","tavern_events","CHARACTER_MESSAGE_RENDERED","onUnmounted","stop","MessageDisplay","OptionsPanel","onSelect","router","useRouter","rows","keyword","filtered","toLowerCase","includes","reload","found","settingsStore","onThemeChange","event","target","onFontChange","onSizeChange","onChange","args","handleStart","exports","sfc","__vccOpts","val","module","y","x","__webpack_require__","d","__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_pinia_esm_b723a504__","__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_router_esm_7a560a22__","__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_vue_esm_81736d96__","__webpack_module_cache__","moduleId","cachedModule","undefined","__webpack_modules__","definition","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","r","Symbol","toStringTag","goStart","goGame","goHistory","goSettings","route","useRoute","_component_router_view","name","TopNavBar","createRouter","history","createMemoryHistory","routes","path","component","app","createApp","App","getJQuery","maybe$","globalThis","$","renderFatalError","appEl","document","getElementById","innerHTML","Error","String","formatError","use","createPinia","config","errorHandler","onError","handler","readyState","addEventListener","once","onReady","mount","bootstrap","catch","window","on","onPageHide","unmount"],"sourceRoot":""}