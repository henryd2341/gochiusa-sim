{"version":3,"file":"index.js","mappings":"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","sources":["src://tavern_helper_template/external var \"Vue\"","webpack://tavern_helper_template/src/角色卡/前端界面/config/opening_by_perspective.yaml?f5d1","src://tavern_helper_template/src/角色卡/前端界面/App.vue","webpack://tavern_helper_template/src/角色卡/前端界面/App.vue?d43c","src://tavern_helper_template/src/角色卡/前端界面/index.ts"],"sourcesContent":["const __WEBPACK_NAMESPACE_OBJECT__ = Vue;","export default {perspectives:{'心爱':{description:'以保登心爱的情绪与语气观察事件发展，优先关注热情、主动与当下氛围。',opening:'你在清晨推开 Rabbit House 的门，熟悉的甜香与轻快脚步声同时向你迎来。'},'智乃':{description:'以香风智乃的克制与细腻感知推进剧情，优先关注细节与隐含情绪变化。',opening:'你端正地整理围裙与托盘，抬眼时，门铃正好响起，今天的第一位客人到了。'},'理世':{description:'以天天座理世的执行力推进剧情，优先处理秩序、任务与突发状况。',opening:'你快速扫视店内座位与动线，确认一切就绪后，今天的营业正式开始。'},'千夜':{description:'以宇治松千夜的温婉风格观察互动，优先关注礼节、安抚与氛围调和。',opening:'你轻轻摆好茶点，窗外风铃声细微晃动，一段柔和却重要的对话即将开始。'},'纱路':{description:'以桐间纱路的谨慎与责任感参与剧情，优先关注风险与规则边界。',opening:'你深呼吸后推门而入，尽量让自己的步伐显得从容，不让紧张暴露在表情里。'},'无':{description:'使用中立视角，不绑定具体角色语气，更适合观察多角色并行叙事。',opening:'午后钟声落下，你推门进入熟悉的咖啡馆，空气里有甜点与咖啡的暖香。'}}};","import { defineComponent as _defineComponent } from 'vue';\nimport { createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, Transition as _Transition, withCtx as _withCtx, createVNode as _createVNode, toDisplayString as _toDisplayString, renderList as _renderList, Fragment as _Fragment, vModelText as _vModelText, withModifiers as _withModifiers, withKeys as _withKeys, withDirectives as _withDirectives, normalizeStyle as _normalizeStyle, normalizeClass as _normalizeClass, vModelSelect as _vModelSelect } from \"vue\";\nconst _hoisted_1 = [\"data-theme\", \"data-reduced-motion\"];\nconst _hoisted_2 = {\n    key: 0,\n    class: \"splash-screen\"\n};\nconst _hoisted_3 = { id: \"region-top-nav\" };\nconst _hoisted_4 = { class: \"nav-actions\" };\nconst _hoisted_5 = { id: \"region-main-content\" };\nconst _hoisted_6 = { class: \"panel-story\" };\nconst _hoisted_7 = {\n    id: \"story-current-message\",\n    \"aria-live\": \"polite\"\n};\nconst _hoisted_8 = { class: \"panel-options\" };\nconst _hoisted_9 = { class: \"panel-header\" };\nconst _hoisted_10 = {\n    key: 0,\n    class: \"status-chip animate-pulse\"\n};\nconst _hoisted_11 = { class: \"option-list\" };\nconst _hoisted_12 = [\"disabled\", \"onClick\"];\nconst _hoisted_13 = { class: \"custom-input-group\" };\nconst _hoisted_14 = [\"disabled\", \"onKeydown\"];\nconst _hoisted_15 = [\"disabled\"];\nconst _hoisted_16 = { id: \"region-character-bar\" };\nconst _hoisted_17 = { class: \"character-scroll\" };\nconst _hoisted_18 = [\"onClick\"];\nconst _hoisted_19 = { class: \"char-avatar\" };\nconst _hoisted_20 = [\"src\", \"alt\", \"onError\"];\nconst _hoisted_21 = { class: \"char-name\" };\nconst _hoisted_22 = { class: \"quick-actions-mini\" };\nconst _hoisted_23 = [\"title\"];\nconst _hoisted_24 = [\"title\"];\nconst _hoisted_25 = { class: \"modal-shell\" };\nconst _hoisted_26 = { class: \"modal-header\" };\nconst _hoisted_27 = {\n    class: \"tab-nav\",\n    style: { \"display\": \"flex\", \"padding\": \"10px\", \"gap\": \"10px\", \"border-bottom\": \"1px solid var(--line-soft)\" }\n};\nconst _hoisted_28 = [\"onClick\"];\nconst _hoisted_29 = { class: \"modal-body\" };\nconst _hoisted_30 = {\n    key: 0,\n    class: \"tab-panel\"\n};\nconst _hoisted_31 = {\n    class: \"panel-tools\",\n    style: { \"display\": \"flex\", \"gap\": \"10px\", \"margin-bottom\": \"15px\" }\n};\nconst _hoisted_32 = {\n    class: \"history-list\",\n    style: { \"display\": \"flex\", \"flex-direction\": \"column\", \"gap\": \"10px\" }\n};\nconst _hoisted_33 = { style: { \"display\": \"flex\", \"justify-content\": \"space-between\", \"margin-bottom\": \"8px\", \"font-size\": \"0.85rem\", \"color\": \"var(--ink-1)\" } };\nconst _hoisted_34 = { style: { \"font-size\": \"0.95rem\", \"margin-bottom\": \"10px\" } };\nconst _hoisted_35 = [\"onClick\"];\nconst _hoisted_36 = { class: \"tab-panel\" };\nconst _hoisted_37 = {\n    class: \"panel-tools\",\n    style: { \"display\": \"flex\", \"flex-direction\": \"column\", \"gap\": \"10px\", \"margin-bottom\": \"15px\" }\n};\nconst _hoisted_38 = [\"value\"];\nconst _hoisted_39 = {\n    class: \"worldbook-list\",\n    style: { \"display\": \"flex\", \"flex-direction\": \"column\", \"gap\": \"10px\" }\n};\nconst _hoisted_40 = { style: { \"display\": \"flex\", \"justify-content\": \"space-between\", \"align-items\": \"center\", \"margin-bottom\": \"8px\" } };\nconst _hoisted_41 = { style: { \"color\": \"var(--accent-gold)\" } };\nconst _hoisted_42 = [\"onClick\"];\nconst _hoisted_43 = { style: { \"font-size\": \"0.9rem\", \"color\": \"var(--ink-1)\" } };\nconst _hoisted_44 = { class: \"tab-panel\" };\nconst _hoisted_45 = {\n    class: \"settings-grid\",\n    style: { \"display\": \"flex\", \"flex-direction\": \"column\", \"gap\": \"20px\" }\n};\nconst _hoisted_46 = { class: \"setting-item\" };\nconst _hoisted_47 = { style: { \"display\": \"flex\", \"gap\": \"10px\" } };\nconst _hoisted_48 = { class: \"setting-item\" };\nconst _hoisted_49 = { style: { \"display\": \"flex\", \"gap\": \"10px\" } };\nconst _hoisted_50 = { class: \"setting-item\" };\nconst _hoisted_51 = { style: { \"display\": \"flex\", \"gap\": \"10px\" } };\nconst _hoisted_52 = { class: \"tab-panel\" };\nconst _hoisted_53 = { style: { \"display\": \"flex\", \"gap\": \"20px\", \"flex-direction\": \"column\" } };\nconst _hoisted_54 = { style: { \"display\": \"flex\", \"gap\": \"10px\", \"overflow-x\": \"auto\", \"padding-bottom\": \"10px\" } };\nconst _hoisted_55 = [\"onClick\"];\nconst _hoisted_56 = {\n    class: \"card\",\n    style: { \"padding\": \"20px\", \"border\": \"1px solid var(--line-soft)\", \"border-radius\": \"16px\", \"background\": \"white\" }\n};\nconst _hoisted_57 = { style: { \"display\": \"flex\", \"gap\": \"20px\", \"align-items\": \"flex-start\" } };\nconst _hoisted_58 = [\"src\"];\nconst _hoisted_59 = { style: { \"margin-bottom\": \"5px\", \"color\": \"var(--accent-gold)\" } };\nconst _hoisted_60 = { style: { \"font-size\": \"0.9rem\", \"color\": \"var(--ink-1)\" } };\nconst _hoisted_61 = { style: { \"margin-top\": \"20px\", \"display\": \"grid\", \"grid-template-columns\": \"1fr 1fr\", \"gap\": \"15px\" } };\nconst _hoisted_62 = { style: { \"display\": \"block\", \"font-size\": \"0.8rem\", \"color\": \"var(--ink-muted)\" } };\nconst _hoisted_63 = { style: { \"font-weight\": \"600\" } };\nconst _hoisted_64 = {\n    key: 0,\n    class: \"modal-scrim\"\n};\nconst _hoisted_65 = {\n    class: \"modal-shell\",\n    style: { \"max-width\": \"800px\" }\n};\nconst _hoisted_66 = { class: \"modal-body\" };\nconst _hoisted_67 = { style: { \"display\": \"grid\", \"grid-template-columns\": \"repeat(auto-fit, minmax(180px, 1fr))\", \"gap\": \"15px\", \"margin-bottom\": \"30px\" } };\nconst _hoisted_68 = [\"onClick\"];\nconst _hoisted_69 = { style: { \"display\": \"block\", \"margin-bottom\": \"5px\", \"color\": \"var(--accent-gold)\" } };\nconst _hoisted_70 = { style: { \"font-size\": \"0.85rem\", \"color\": \"var(--ink-1)\" } };\nconst _hoisted_71 = {\n    key: 0,\n    class: \"card\",\n    style: { \"padding\": \"20px\", \"background\": \"var(--bg-1)\", \"border-radius\": \"12px\", \"margin-bottom\": \"20px\" }\n};\nconst _hoisted_72 = { style: { \"font-family\": \"'Noto Serif SC', serif\", \"line-height\": \"1.6\" } };\nconst _hoisted_73 = [\"disabled\"];\nimport { computed, nextTick, onBeforeUnmount, onMounted, ref, watch } from 'vue';\nimport openingConfigRaw from './config/opening_by_perspective.yaml';\nconst SETTINGS_STORAGE_KEY = 'gochiusa.frontend.settings.v2';\nconst PERSPECTIVE_VAR_PATH = '前端界面.主视角';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'App',\n    setup(__props) {\n        const perspectiveKeys = ['心爱', '智乃', '理世', '千夜', '纱路', '无'];\n        const fallbackOpeningConfig = {\n            perspectives: {\n                心爱: {\n                    description: '以保登心爱的情绪与语气观察事件发展，优先关注热情、主动与当下氛围。',\n                    opening: '你在清晨推开兔屋咖啡馆的大门，熟悉的甜香与轻快脚步声同时向你迎来。',\n                },\n                智乃: {\n                    description: '以香风智乃的克制与细腻感知推进剧情，优先关注细节与隐含情绪变化。',\n                    opening: '你端正地整理围裙与托盘，抬眼时，门铃正好响起，今天的第一位客人到了。',\n                },\n                理世: {\n                    description: '以天天座理世的执行力推进剧情，优先处理秩序、任务与突发状况。',\n                    opening: '你快速扫视店内座位与动线，确认一切就绪后，今天的营业正式开始。',\n                },\n                千夜: {\n                    description: '以宇治松千夜的温婉风格观察互动，优先关注礼节、安抚与氛围调和。',\n                    opening: '你轻轻摆好茶点，窗外风铃声细微晃动，一段柔和却重要的对话即将开始。',\n                },\n                纱路: {\n                    description: '以桐间纱路的谨慎与责任感参与剧情，优先关注风险与规则边界。',\n                    opening: '你深呼吸后推门而入，尽量让自己的步伐显得从容，不让紧张暴露在表情里。',\n                },\n                无: {\n                    description: '使用中立视角，不绑定具体角色语气，更适合观察多角色并行叙事。',\n                    opening: '午后钟声落下，你推门进入熟悉的咖啡馆，空气里有甜点与咖啡的暖香。',\n                },\n            },\n        };\n        const defaultSettings = {\n            theme: 'theme-latte-noir',\n            displayMode: 'instant',\n            fontScale: 'medium',\n            autoScroll: true,\n            reduceMotion: false,\n        };\n        function catboxImage(code) {\n            return `https://files.catbox.moe/${code}.png`;\n        }\n        const characterProfiles = [\n            {\n                key: 'cocoa',\n                name: '保登心爱',\n                color: 'var(--clr-cocoa)',\n                avatarUrl: catboxImage('qjltca'),\n                summary: '活力型引导角色，擅长快速拉近关系并推动场景气氛。',\n                mood: '开朗',\n                location: '兔屋咖啡馆前厅',\n                outfit: '咖啡厅制服',\n                relation: '友好',\n            },\n            {\n                key: 'chino',\n                name: '香风智乃',\n                color: 'var(--clr-chino)',\n                avatarUrl: catboxImage('6t09pw'),\n                summary: '观察型角色，擅长在安静场景中提供高价值细节。',\n                mood: '冷静',\n                location: '吧台内侧',\n                outfit: '咖啡厅制服',\n                relation: '信任建立中',\n            },\n            {\n                key: 'rize',\n                name: '天天座理世',\n                color: 'var(--clr-rize)',\n                avatarUrl: catboxImage('n9szhx'),\n                summary: '执行型角色，擅长处理节奏与秩序相关场景。',\n                mood: '专注',\n                location: '点单与出餐动线',\n                outfit: '咖啡厅制服',\n                relation: '可靠同伴',\n            },\n            {\n                key: 'chiya',\n                name: '宇治松千夜',\n                color: 'var(--clr-chiya)',\n                avatarUrl: catboxImage('v4spnt'),\n                summary: '情绪调和型角色，擅长缓冲冲突与提升舒适感。',\n                mood: '温和',\n                location: '甜点展示区',\n                outfit: '和风改良制服',\n                relation: '亲近',\n            },\n            {\n                key: 'syaro',\n                name: '桐间纱路',\n                color: 'var(--clr-syaro)',\n                avatarUrl: catboxImage('b982xz'),\n                summary: '谨慎型角色，适合调查、推理与高压交互场景。',\n                mood: '紧张但坚定',\n                location: '门厅与过道',\n                outfit: '学院日常装',\n                relation: '逐步加深',\n            },\n        ];\n        const perspectiveToCharacter = {\n            心爱: 'cocoa',\n            智乃: 'chino',\n            理世: 'rize',\n            千夜: 'chiya',\n            纱路: 'syaro',\n            无: 'cocoa',\n        };\n        function isPerspectiveKey(value) {\n            return perspectiveKeys.includes(value);\n        }\n        function normalizeOpeningConfig(input) {\n            const base = _.cloneDeep(fallbackOpeningConfig);\n            if (!input || typeof input !== 'object')\n                return base;\n            const raw = input.perspectives;\n            if (!raw || typeof raw !== 'object')\n                return base;\n            perspectiveKeys.forEach(key => {\n                const candidate = raw[key];\n                if (candidate &&\n                    typeof candidate.description === 'string' &&\n                    candidate.description.trim().length > 0 &&\n                    typeof candidate.opening === 'string' &&\n                    candidate.opening.trim().length > 0) {\n                    base.perspectives[key] = { description: candidate.description, opening: candidate.opening };\n                }\n            });\n            return base;\n        }\n        function loadSettings() {\n            try {\n                const raw = localStorage.getItem(SETTINGS_STORAGE_KEY);\n                if (!raw)\n                    return defaultSettings;\n                const parsed = JSON.parse(raw);\n                return {\n                    theme: parsed.theme === 'theme-midnight-salon' ? 'theme-midnight-salon' : 'theme-latte-noir',\n                    displayMode: parsed.displayMode === 'typewriter' || parsed.displayMode === 'segment' ? parsed.displayMode : 'instant',\n                    fontScale: parsed.fontScale === 'small' || parsed.fontScale === 'large' ? parsed.fontScale : 'medium',\n                    autoScroll: parsed.autoScroll !== false,\n                    reduceMotion: parsed.reduceMotion === true,\n                };\n            }\n            catch {\n                return defaultSettings;\n            }\n        }\n        function upsertMetaDescription(content) {\n            const selector = 'meta[name=\"description\"]';\n            let meta = document.head.querySelector(selector);\n            if (!meta) {\n                meta = document.createElement('meta');\n                meta.name = 'description';\n                document.head.appendChild(meta);\n            }\n            meta.content = content;\n        }\n        function segmentText(input) {\n            return input\n                .replace(/([。！？!?])(?=[^\\n])/g, '$1\\n')\n                .replace(/\\n{3,}/g, '\\n\\n')\n                .trim();\n        }\n        function roleLabel(role) {\n            if (role === 'assistant')\n                return '助手';\n            if (role === 'user')\n                return '玩家';\n            return '系统';\n        }\n        function truncateText(text, max = 120) {\n            if (text.length <= max)\n                return text;\n            return `${text.slice(0, max)}...`;\n        }\n        function onAvatarImageError(event, characterName) {\n            const target = event.target;\n            if (!target)\n                return;\n            target.onerror = null;\n            target.src = `https://api.dicebear.com/9.x/initials/svg?seed=${encodeURIComponent(characterName)}`;\n        }\n        function extractRoleplayOptions(message) {\n            const block = message.match(/<roleplay_options>([\\s\\S]*?)<\\/roleplay_options>/i)?.[1] ?? '';\n            if (!block.trim())\n                return [];\n            return [...block.matchAll(/(.+?)[:：]\\s*(.+)/g)].map((match, index) => ({\n                id: `opt-dynamic-${index + 1}`,\n                title: match[1].trim(),\n                content: match[2].trim(),\n            }));\n        }\n        const openingConfig = normalizeOpeningConfig(openingConfigRaw);\n        const settings = ref(loadSettings());\n        const isFeatureModalVisible = ref(false);\n        const activeTab = ref('history');\n        const showPerspectiveSelector = ref(false);\n        const isSplashScreenVisible = ref(true);\n        const selectedPerspective = ref(null);\n        const perspectiveConfirmed = ref(false);\n        const customOption = ref('');\n        const isFullscreen = ref(false);\n        const isBusyGenerating = ref(false);\n        const rawCurrentMessage = ref('正在等待剧情推进，请选择下一步行动。');\n        const displayedMessage = ref('正在等待剧情推进，请选择下一步行动。');\n        const activeCharacterKey = ref('cocoa');\n        const chatVariablesSnapshot = ref({});\n        const historyMessages = ref([]);\n        const historyDepth = ref(40);\n        const historyQuery = ref('');\n        const worldbookNames = ref([]);\n        const selectedWorldbookName = ref('');\n        const worldbookEntries = ref([]);\n        const worldbookQuery = ref('');\n        const worldbookError = ref('');\n        const isWorldbookLoading = ref(false);\n        const lastMessageId = ref(0);\n        const options = ref([\n            { id: 'opt-001', title: '向柜台点单', content: '你走向柜台，礼貌地询问今日推荐饮品。' },\n            { id: 'opt-002', title: '观察店内', content: '你放慢脚步，观察店内客人与角色之间的互动细节。' },\n            { id: 'opt-003', title: '主动搭话', content: '你选择与当前出场角色展开一段自然交流。' },\n        ]);\n        const tabs = [\n            { key: 'history', label: '历史消息' },\n            { key: 'worldbook', label: '世界书' },\n            { key: 'settings', label: '设置' },\n            { key: 'character', label: '角色详情' },\n        ];\n        const modalTitle = computed(() => {\n            return tabs.find(t => t.key === activeTab.value)?.label || '功能面板';\n        });\n        const fontScaleMap = {\n            small: '0.92',\n            medium: '1',\n            large: '1.08',\n        };\n        const pageRootStyle = computed(() => ({\n            '--font-scale': fontScaleMap[settings.value.fontScale],\n        }));\n        const perspectiveEntries = computed(() => {\n            return perspectiveKeys.map(key => ({\n                key,\n                ...openingConfig.perspectives[key],\n            }));\n        });\n        const selectedOpeningPreview = computed(() => {\n            const key = selectedPerspective.value;\n            if (!key)\n                return '请选择一个主视角后查看对应开场白。';\n            return openingConfig.perspectives[key].opening;\n        });\n        const historyFilteredMessages = computed(() => {\n            const keyword = historyQuery.value.trim().toLowerCase();\n            const sorted = [...historyMessages.value].sort((lhs, rhs) => rhs.message_id - lhs.message_id);\n            if (!keyword)\n                return sorted;\n            return sorted.filter(msg => {\n                const text = `${msg.name} ${msg.message}`.toLowerCase();\n                return text.includes(keyword);\n            });\n        });\n        const historyHasMore = computed(() => {\n            return historyDepth.value < lastMessageId.value + 1;\n        });\n        const filteredWorldbookEntries = computed(() => {\n            const keyword = worldbookQuery.value.trim().toLowerCase();\n            if (!keyword)\n                return worldbookEntries.value;\n            return worldbookEntries.value.filter(entry => {\n                const text = `${entry.name} ${entry.content}`.toLowerCase();\n                return text.includes(keyword);\n            });\n        });\n        const activeCharacter = computed(() => {\n            const match = characterProfiles.find(item => item.key === activeCharacterKey.value);\n            return match ?? characterProfiles[0];\n        });\n        const activeCharacterState = computed(() => {\n            const profile = activeCharacter.value;\n            const vars = chatVariablesSnapshot.value;\n            const mood = _.get(vars, `${profile.name}.心情`) ??\n                _.get(vars, `角色状态.${profile.name}.心情`) ??\n                _.get(vars, `角色.${profile.name}.心情`) ??\n                profile.mood;\n            const location = _.get(vars, `${profile.name}.位置`) ??\n                _.get(vars, `角色状态.${profile.name}.位置`) ??\n                _.get(vars, `角色.${profile.name}.位置`) ??\n                profile.location;\n            const outfit = _.get(vars, `${profile.name}.着装`) ??\n                _.get(vars, `角色状态.${profile.name}.着装`) ??\n                _.get(vars, `角色.${profile.name}.着装`) ??\n                profile.outfit;\n            const relation = _.get(vars, `${profile.name}.关系`) ??\n                _.get(vars, `角色状态.${profile.name}.关系`) ??\n                _.get(vars, `角色.${profile.name}.关系`) ??\n                profile.relation;\n            return {\n                当前心情: String(mood),\n                所在位置: String(location),\n                当前着装: String(outfit),\n                关系状态: String(relation),\n            };\n        });\n        const eventStops = [];\n        let typewriterTimer = null;\n        let lastFocusedElement = null;\n        function clearTypewriterTimer() {\n            if (typewriterTimer === null)\n                return;\n            window.clearInterval(typewriterTimer);\n            typewriterTimer = null;\n        }\n        function applyDisplayMessage(text) {\n            clearTypewriterTimer();\n            if (settings.value.displayMode === 'instant') {\n                displayedMessage.value = text;\n                return;\n            }\n            if (settings.value.displayMode === 'segment') {\n                displayedMessage.value = segmentText(text);\n                return;\n            }\n            const chars = Array.from(text);\n            displayedMessage.value = '';\n            let index = 0;\n            typewriterTimer = window.setInterval(() => {\n                index += 1;\n                displayedMessage.value = chars.slice(0, index).join('');\n                if (index >= chars.length) {\n                    clearTypewriterTimer();\n                }\n            }, settings.value.reduceMotion ? 8 : 20);\n        }\n        function saveSettings() {\n            localStorage.setItem(SETTINGS_STORAGE_KEY, JSON.stringify(settings.value));\n        }\n        function resetSettings() {\n            settings.value = _.cloneDeep(defaultSettings);\n            saveSettings();\n            toastr.success('设置已恢复默认值。');\n        }\n        function toggleDisplayMode() {\n            const chain = ['instant', 'typewriter', 'segment'];\n            const index = chain.indexOf(settings.value.displayMode);\n            settings.value.displayMode = chain[(index + 1) % chain.length];\n        }\n        function readPerspectiveFromChatVariables() {\n            try {\n                const vars = getVariables({ type: 'chat' });\n                const value = _.get(vars, PERSPECTIVE_VAR_PATH);\n                return isPerspectiveKey(value) ? value : null;\n            }\n            catch {\n                return null;\n            }\n        }\n        function syncLastMessageId() {\n            const value = getLastMessageId();\n            lastMessageId.value = value;\n            return value;\n        }\n        function persistPerspectiveToChatVariables(value) {\n            try {\n                updateVariablesWith(vars => {\n                    _.set(vars, PERSPECTIVE_VAR_PATH, value);\n                    return vars;\n                }, { type: 'chat' });\n            }\n            catch (error) {\n                console.warn('保存主视角到聊天变量失败:', error);\n            }\n        }\n        function shouldShowPerspectiveModal() {\n            return syncLastMessageId() === 0;\n        }\n        function getPerspectiveOpening() {\n            const key = selectedPerspective.value ?? '无';\n            return openingConfig.perspectives[key].opening;\n        }\n        function confirmPerspective() {\n            if (!selectedPerspective.value)\n                return;\n            perspectiveConfirmed.value = true;\n            showPerspectiveSelector.value = false;\n            persistPerspectiveToChatVariables(selectedPerspective.value);\n            const mapped = perspectiveToCharacter[selectedPerspective.value];\n            if (mapped)\n                activeCharacterKey.value = mapped;\n            if (syncLastMessageId() === 0) {\n                rawCurrentMessage.value = getPerspectiveOpening();\n                updateOptionsFromMessage(rawCurrentMessage.value);\n            }\n            toastr.success(`主视角已确定：${selectedPerspective.value}`);\n        }\n        function loadHistory(reset = false) {\n            if (reset) {\n                historyDepth.value = 40;\n            }\n            const lastId = syncLastMessageId();\n            const start = Math.max(0, lastId - historyDepth.value + 1);\n            const range = `${start}-${lastId}`;\n            historyMessages.value = getChatMessages(range, { hide_state: 'unhidden' });\n        }\n        function loadMoreHistory() {\n            historyDepth.value += 40;\n            loadHistory(false);\n        }\n        function useHistoryAsCustom(message) {\n            customOption.value = message;\n            closeFeatureModal();\n            toastr.info('已将历史消息填入自定义选项输入框。');\n        }\n        async function loadWorldbookNames() {\n            const names = [];\n            try {\n                const bind = getCharWorldbookNames('current');\n                names.push(...[bind.primary, ...bind.additional].filter((item) => Boolean(item)));\n            }\n            catch {\n                // 当前没有可用角色卡时会走到这里，使用全量世界书兜底\n            }\n            if (!names.length) {\n                names.push(...getWorldbookNames());\n            }\n            worldbookNames.value = Array.from(new Set(names));\n            if (!worldbookNames.value.length) {\n                selectedWorldbookName.value = '';\n                worldbookEntries.value = [];\n                return;\n            }\n            if (!worldbookNames.value.includes(selectedWorldbookName.value)) {\n                selectedWorldbookName.value = worldbookNames.value[0];\n            }\n        }\n        async function loadWorldbookEntries() {\n            if (!selectedWorldbookName.value) {\n                worldbookEntries.value = [];\n                return;\n            }\n            isWorldbookLoading.value = true;\n            worldbookError.value = '';\n            try {\n                worldbookEntries.value = await getWorldbook(selectedWorldbookName.value);\n            }\n            catch (error) {\n                worldbookError.value = '读取世界书失败，请检查绑定状态。';\n                console.error(error);\n            }\n            finally {\n                isWorldbookLoading.value = false;\n            }\n        }\n        async function reloadWorldbook() {\n            await loadWorldbookNames();\n            await loadWorldbookEntries();\n        }\n        async function toggleWorldbookEntryState(uid, enabled) {\n            if (!selectedWorldbookName.value)\n                return;\n            try {\n                worldbookEntries.value = await updateWorldbookWith(selectedWorldbookName.value, entries => {\n                    return entries.map(entry => {\n                        if (entry.uid !== uid)\n                            return entry;\n                        return { ...entry, enabled };\n                    });\n                });\n            }\n            catch (error) {\n                toastr.error('世界书条目状态更新失败。');\n                console.error(error);\n            }\n        }\n        function refreshChatVariablesSnapshot() {\n            try {\n                chatVariablesSnapshot.value = getVariables({ type: 'chat' });\n            }\n            catch {\n                chatVariablesSnapshot.value = {};\n            }\n        }\n        function updateOptionsFromMessage(message) {\n            const dynamic = extractRoleplayOptions(message);\n            if (dynamic.length > 0) {\n                options.value = dynamic;\n            }\n        }\n        function refreshLatestAssistantMessage() {\n            const lastId = syncLastMessageId();\n            const start = Math.max(0, lastId - 80);\n            const range = `${start}-${lastId}`;\n            const list = getChatMessages(range, { role: 'assistant', hide_state: 'unhidden' });\n            const latest = list.at(-1);\n            if (!latest || typeof latest.message !== 'string')\n                return;\n            rawCurrentMessage.value = latest.message;\n            updateOptionsFromMessage(latest.message);\n        }\n        function scrollStoryIfNeeded() {\n            if (!settings.value.autoScroll)\n                return;\n            const target = document.getElementById('story-current-message');\n            target?.scrollIntoView({ behavior: settings.value.reduceMotion ? 'auto' : 'smooth', block: 'nearest' });\n        }\n        async function handleOption(content) {\n            const clean = content.trim();\n            if (!clean) {\n                toastr.info('选项内容为空，无法发送。');\n                return;\n            }\n            if (showPerspectiveSelector.value || !perspectiveConfirmed.value) {\n                toastr.warning('请先完成主视角选择。');\n                return;\n            }\n            if (isBusyGenerating.value)\n                return;\n            isBusyGenerating.value = true;\n            try {\n                const isFirstTurn = syncLastMessageId() === 0;\n                await createChatMessages([{ role: 'user', message: clean }]);\n                const result = await generate({\n                    user_input: clean,\n                    should_stream: false,\n                    overrides: isFirstTurn\n                        ? {\n                            chat_history: {\n                                prompts: [{ role: 'assistant', content: getPerspectiveOpening() }],\n                            },\n                        }\n                        : undefined,\n                });\n                const latest = getChatMessages(-1)[0];\n                if (!latest || latest.role !== 'assistant') {\n                    await createChatMessages([{ role: 'assistant', message: result }]);\n                }\n                rawCurrentMessage.value = result;\n                refreshLatestAssistantMessage();\n                updateOptionsFromMessage(result);\n                syncLastMessageId();\n                loadHistory(false);\n                refreshChatVariablesSnapshot();\n                scrollStoryIfNeeded();\n            }\n            catch (error) {\n                toastr.error('发送选项或生成回复失败。');\n                console.error(error);\n            }\n            finally {\n                isBusyGenerating.value = false;\n            }\n        }\n        async function submitCustomOption() {\n            const value = customOption.value.trim();\n            if (!value) {\n                toastr.info('请先填写自定义选项内容。');\n                return;\n            }\n            options.value.unshift({\n                id: `opt-custom-${Date.now()}`,\n                title: '自定义行动',\n                content: value,\n            });\n            customOption.value = '';\n            await handleOption(value);\n        }\n        async function toggleFullscreen() {\n            try {\n                if (!document.fullscreenElement) {\n                    await document.documentElement.requestFullscreen();\n                    isFullscreen.value = true;\n                    return;\n                }\n                await document.exitFullscreen();\n                isFullscreen.value = false;\n            }\n            catch (error) {\n                toastr.warning('当前环境不支持全屏切换。');\n                console.warn(error);\n            }\n        }\n        function handleStart() {\n            isSplashScreenVisible.value = false;\n        }\n        function openFeatureModal(tab) {\n            lastFocusedElement = document.activeElement instanceof HTMLElement ? document.activeElement : null;\n            activeTab.value = tab;\n            isFeatureModalVisible.value = true;\n        }\n        function closeFeatureModal() {\n            isFeatureModalVisible.value = false;\n            nextTick(() => {\n                lastFocusedElement?.focus();\n            });\n        }\n        function openCharacterDetail(characterKey) {\n            activeCharacterKey.value = characterKey;\n            openFeatureModal('character');\n        }\n        function onGlobalKeydown(event) {\n            if (event.key !== 'Escape')\n                return;\n            if (showPerspectiveSelector.value)\n                return;\n            if (isFeatureModalVisible.value) {\n                closeFeatureModal();\n            }\n        }\n        async function initializeForCurrentChat() {\n            syncLastMessageId();\n            const cachedPerspective = readPerspectiveFromChatVariables();\n            showPerspectiveSelector.value = shouldShowPerspectiveModal() && !cachedPerspective;\n            selectedPerspective.value = showPerspectiveSelector.value ? cachedPerspective : (cachedPerspective ?? '无');\n            perspectiveConfirmed.value = !showPerspectiveSelector.value;\n            if (!showPerspectiveSelector.value && selectedPerspective.value) {\n                activeCharacterKey.value = perspectiveToCharacter[selectedPerspective.value];\n            }\n            refreshLatestAssistantMessage();\n            loadHistory(true);\n            refreshChatVariablesSnapshot();\n            await reloadWorldbook();\n        }\n        watch(() => settings.value, () => {\n            saveSettings();\n        }, { deep: true });\n        watch(() => [rawCurrentMessage.value, settings.value.displayMode, settings.value.reduceMotion], () => {\n            applyDisplayMessage(rawCurrentMessage.value);\n        }, { immediate: true });\n        watch(activeTab, tab => {\n            if (tab === 'history') {\n                loadHistory(false);\n                return;\n            }\n            if (tab === 'worldbook') {\n                void reloadWorldbook();\n                return;\n            }\n            if (tab === 'character') {\n                refreshChatVariablesSnapshot();\n            }\n        });\n        watch(selectedWorldbookName, () => {\n            void loadWorldbookEntries();\n        });\n        onMounted(() => {\n            document.title = '点兔文字交互界面';\n            upsertMetaDescription('高沉浸文字互动体验，支持选项驱动叙事、世界书联动与主视角开场注入。');\n            document.addEventListener('keydown', onGlobalKeydown);\n            void initializeForCurrentChat();\n            eventStops.push(eventOn(tavern_events.MESSAGE_RECEIVED, () => {\n                syncLastMessageId();\n                refreshLatestAssistantMessage();\n                loadHistory(false);\n                refreshChatVariablesSnapshot();\n            }).stop);\n            eventStops.push(eventOn(tavern_events.MESSAGE_EDITED, () => {\n                syncLastMessageId();\n                refreshLatestAssistantMessage();\n                loadHistory(false);\n            }).stop);\n            eventStops.push(eventOn(tavern_events.MESSAGE_SWIPED, () => {\n                syncLastMessageId();\n                refreshLatestAssistantMessage();\n            }).stop);\n            eventStops.push(eventOn(tavern_events.CHAT_CHANGED, () => {\n                void initializeForCurrentChat();\n                toastr.info('检测到聊天切换，界面数据已自动同步。');\n            }).stop);\n            eventStops.push(eventOn(tavern_events.WORLDINFO_UPDATED, () => {\n                void reloadWorldbook();\n            }).stop);\n        });\n        onBeforeUnmount(() => {\n            clearTypewriterTimer();\n            document.removeEventListener('keydown', onGlobalKeydown);\n            eventStops.forEach(stop => stop());\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", {\n                id: \"page-game-root\",\n                \"data-theme\": settings.value.theme,\n                \"data-font\": \"font-ui-default\",\n                \"data-reduced-motion\": settings.value.reduceMotion ? 'true' : 'false',\n                style: _normalizeStyle(pageRootStyle.value)\n            }, [\n                _createCommentVNode(\" Background Layer \"),\n                _cache[35] || (_cache[35] = _createElementVNode(\"div\", { class: \"background-layer\" }, [\n                    _createElementVNode(\"div\", { class: \"bg-pattern\" })\n                ], -1 /* CACHED */)),\n                _createCommentVNode(\" Splash Screen \"),\n                _createVNode(_Transition, { name: \"fade\" }, {\n                    default: _withCtx(() => [\n                        (isSplashScreenVisible.value)\n                            ? (_openBlock(), _createElementBlock(\"section\", _hoisted_2, [\n                                _cache[18] || (_cache[18] = _createElementVNode(\"div\", { class: \"splash-logo animate-fadeInDown\" }, [\n                                    _createElementVNode(\"h1\", { class: \"splash-title\" }, \"ご注文はうさぎですか？\"),\n                                    _createElementVNode(\"p\", { class: \"splash-subtitle\" }, \"BLOOM SIMULATOR\")\n                                ], -1 /* CACHED */)),\n                                _createElementVNode(\"button\", {\n                                    class: \"press-start-btn animate-fadeInUp\",\n                                    onClick: handleStart\n                                }, [...(_cache[17] || (_cache[17] = [\n                                        _createElementVNode(\"span\", { class: \"animate-pulse\" }, \"PRESS START\", -1 /* CACHED */)\n                                    ]))])\n                            ]))\n                            : _createCommentVNode(\"v-if\", true)\n                    ]),\n                    _: 1 /* STABLE */\n                }),\n                _createCommentVNode(\" Top Navigation \"),\n                _createElementVNode(\"header\", _hoisted_3, [\n                    _cache[22] || (_cache[22] = _createElementVNode(\"div\", { class: \"brand-logo\" }, [\n                        _createElementVNode(\"span\", { class: \"brand-main\" }, \"点兔叙事界面\"),\n                        _createElementVNode(\"span\", { class: \"brand-sub\" }, \"Gochiusa Narrative Interface\")\n                    ], -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_4, [\n                        _createElementVNode(\"button\", {\n                            class: \"nav-btn\",\n                            title: \"历史消息\",\n                            onClick: _cache[0] || (_cache[0] = ($event) => (openFeatureModal('history')))\n                        }, [...(_cache[19] || (_cache[19] = [\n                                _createElementVNode(\"i\", { class: \"fa-solid fa-clock-rotate-left\" }, null, -1 /* CACHED */),\n                                _createElementVNode(\"span\", null, \"历史\", -1 /* CACHED */)\n                            ]))]),\n                        _createElementVNode(\"button\", {\n                            class: \"nav-btn\",\n                            title: \"世界书\",\n                            onClick: _cache[1] || (_cache[1] = ($event) => (openFeatureModal('worldbook')))\n                        }, [...(_cache[20] || (_cache[20] = [\n                                _createElementVNode(\"i\", { class: \"fa-solid fa-book-open\" }, null, -1 /* CACHED */),\n                                _createElementVNode(\"span\", null, \"世界书\", -1 /* CACHED */)\n                            ]))]),\n                        _createElementVNode(\"button\", {\n                            class: \"nav-btn\",\n                            title: \"设置\",\n                            onClick: _cache[2] || (_cache[2] = ($event) => (openFeatureModal('settings')))\n                        }, [...(_cache[21] || (_cache[21] = [\n                                _createElementVNode(\"i\", { class: \"fa-solid fa-gear\" }, null, -1 /* CACHED */),\n                                _createElementVNode(\"span\", null, \"设置\", -1 /* CACHED */)\n                            ]))])\n                    ])\n                ]),\n                _createCommentVNode(\" Main Content \"),\n                _createElementVNode(\"main\", _hoisted_5, [\n                    _createCommentVNode(\" Story Panel \"),\n                    _createElementVNode(\"section\", _hoisted_6, [\n                        _createElementVNode(\"div\", { class: \"panel-header\" }, [\n                            _cache[24] || (_cache[24] = _createElementVNode(\"h2\", null, \"叙事消息\", -1 /* CACHED */)),\n                            _createElementVNode(\"div\", { class: \"header-tools\" }, [\n                                _createElementVNode(\"button\", {\n                                    class: \"btn nav-btn\",\n                                    onClick: refreshLatestAssistantMessage\n                                }, [...(_cache[23] || (_cache[23] = [\n                                        _createElementVNode(\"i\", { class: \"fa-solid fa-arrows-rotate\" }, null, -1 /* CACHED */),\n                                        _createElementVNode(\"span\", null, \"同步\", -1 /* CACHED */)\n                                    ]))])\n                            ])\n                        ]),\n                        _createElementVNode(\"article\", _hoisted_7, _toDisplayString(displayedMessage.value), 1 /* TEXT */)\n                    ]),\n                    _createCommentVNode(\" Options Panel \"),\n                    _createElementVNode(\"section\", _hoisted_8, [\n                        _createElementVNode(\"div\", _hoisted_9, [\n                            _cache[25] || (_cache[25] = _createElementVNode(\"h2\", null, \"可选行动\", -1 /* CACHED */)),\n                            (isBusyGenerating.value)\n                                ? (_openBlock(), _createElementBlock(\"span\", _hoisted_10, \"正在生成回复...\"))\n                                : _createCommentVNode(\"v-if\", true)\n                        ]),\n                        _createElementVNode(\"ul\", _hoisted_11, [\n                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(options.value, (option, index) => {\n                                return (_openBlock(), _createElementBlock(\"li\", {\n                                    key: option.id\n                                }, [\n                                    _createElementVNode(\"button\", {\n                                        class: \"option-card\",\n                                        disabled: isBusyGenerating.value,\n                                        onClick: ($event) => (handleOption(option.content))\n                                    }, [\n                                        _createElementVNode(\"strong\", null, \"Option \" + _toDisplayString(index + 1), 1 /* TEXT */),\n                                        _createElementVNode(\"span\", null, _toDisplayString(option.content), 1 /* TEXT */)\n                                    ], 8 /* PROPS */, _hoisted_12)\n                                ]));\n                            }), 128 /* KEYED_FRAGMENT */))\n                        ]),\n                        _createElementVNode(\"div\", _hoisted_13, [\n                            _withDirectives(_createElementVNode(\"textarea\", {\n                                \"onUpdate:modelValue\": _cache[3] || (_cache[3] = ($event) => ((customOption).value = $event)),\n                                placeholder: \"输入自定义行动...\",\n                                disabled: isBusyGenerating.value,\n                                onKeydown: _withKeys(_withModifiers(submitCustomOption, [\"prevent\"]), [\"enter\"])\n                            }, null, 40 /* PROPS, NEED_HYDRATION */, _hoisted_14), [\n                                [_vModelText, customOption.value]\n                            ]),\n                            _createElementVNode(\"button\", {\n                                class: \"btn-send\",\n                                disabled: isBusyGenerating.value,\n                                onClick: submitCustomOption\n                            }, [...(_cache[26] || (_cache[26] = [\n                                    _createElementVNode(\"i\", { class: \"fa-solid fa-paper-plane\" }, null, -1 /* CACHED */)\n                                ]))], 8 /* PROPS */, _hoisted_15)\n                        ])\n                    ])\n                ]),\n                _createCommentVNode(\" Bottom Character Bar \"),\n                _createElementVNode(\"footer\", _hoisted_16, [\n                    _createElementVNode(\"div\", _hoisted_17, [\n                        (_openBlock(), _createElementBlock(_Fragment, null, _renderList(characterProfiles, (item) => {\n                            return _createElementVNode(\"div\", {\n                                key: item.key,\n                                class: \"char-chip\",\n                                style: _normalizeStyle({ '--chip-color': item.color }),\n                                onClick: ($event) => (openCharacterDetail(item.key))\n                            }, [\n                                _createElementVNode(\"div\", _hoisted_19, [\n                                    _createElementVNode(\"img\", {\n                                        src: item.avatarUrl,\n                                        alt: item.name,\n                                        onError: ($event) => (onAvatarImageError($event, item.name))\n                                    }, null, 40 /* PROPS, NEED_HYDRATION */, _hoisted_20)\n                                ]),\n                                _createElementVNode(\"span\", _hoisted_21, _toDisplayString(item.name), 1 /* TEXT */)\n                            ], 12 /* STYLE, PROPS */, _hoisted_18);\n                        }), 64 /* STABLE_FRAGMENT */))\n                    ]),\n                    _createElementVNode(\"div\", _hoisted_22, [\n                        _createElementVNode(\"button\", {\n                            class: \"mini-btn\",\n                            title: isFullscreen.value ? '退出全屏' : '全屏',\n                            onClick: toggleFullscreen\n                        }, [\n                            _createElementVNode(\"i\", {\n                                class: _normalizeClass([\"fa-solid\", isFullscreen.value ? 'fa-compress' : 'fa-expand'])\n                            }, null, 2 /* CLASS */)\n                        ], 8 /* PROPS */, _hoisted_23),\n                        _createElementVNode(\"button\", {\n                            class: \"mini-btn\",\n                            title: settings.value.autoScroll ? '关闭自动滚动' : '开启自动滚动',\n                            onClick: _cache[4] || (_cache[4] = ($event) => (settings.value.autoScroll = !settings.value.autoScroll))\n                        }, [\n                            _createElementVNode(\"i\", {\n                                class: _normalizeClass([\"fa-solid\", settings.value.autoScroll ? 'fa-angles-down' : 'fa-minus'])\n                            }, null, 2 /* CLASS */)\n                        ], 8 /* PROPS */, _hoisted_24),\n                        _createElementVNode(\"button\", {\n                            class: \"mini-btn\",\n                            title: \"切换显示模式\",\n                            onClick: toggleDisplayMode\n                        }, [...(_cache[27] || (_cache[27] = [\n                                _createElementVNode(\"i\", { class: \"fa-solid fa-font\" }, null, -1 /* CACHED */)\n                            ]))])\n                    ])\n                ]),\n                _createCommentVNode(\" Modals \"),\n                _createVNode(_Transition, { name: \"fade\" }, {\n                    default: _withCtx(() => [\n                        (isFeatureModalVisible.value)\n                            ? (_openBlock(), _createElementBlock(\"div\", {\n                                key: 0,\n                                class: \"modal-scrim\",\n                                onClick: _withModifiers(closeFeatureModal, [\"self\"])\n                            }, [\n                                _createElementVNode(\"div\", _hoisted_25, [\n                                    _createElementVNode(\"header\", _hoisted_26, [\n                                        _createElementVNode(\"h2\", null, _toDisplayString(modalTitle.value), 1 /* TEXT */),\n                                        _createElementVNode(\"button\", {\n                                            class: \"nav-btn\",\n                                            onClick: closeFeatureModal\n                                        }, [...(_cache[28] || (_cache[28] = [\n                                                _createElementVNode(\"i\", { class: \"fa-solid fa-xmark\" }, null, -1 /* CACHED */)\n                                            ]))])\n                                    ]),\n                                    _createElementVNode(\"nav\", _hoisted_27, [\n                                        (_openBlock(), _createElementBlock(_Fragment, null, _renderList(tabs, (tab) => {\n                                            return _createElementVNode(\"button\", {\n                                                key: tab.key,\n                                                class: _normalizeClass([\"btn\", { active: activeTab.value === tab.key }]),\n                                                style: { \"flex\": \"1\", \"padding\": \"8px\", \"border-radius\": \"8px\", \"border\": \"1px solid var(--line-soft)\", \"background\": \"none\", \"cursor\": \"pointer\" },\n                                                onClick: ($event) => (activeTab.value = tab.key)\n                                            }, _toDisplayString(tab.label), 11 /* TEXT, CLASS, PROPS */, _hoisted_28);\n                                        }), 64 /* STABLE_FRAGMENT */))\n                                    ]),\n                                    _createElementVNode(\"div\", _hoisted_29, [\n                                        _createCommentVNode(\" History Tab \"),\n                                        (activeTab.value === 'history')\n                                            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_30, [\n                                                _createElementVNode(\"div\", _hoisted_31, [\n                                                    _withDirectives(_createElementVNode(\"input\", {\n                                                        \"onUpdate:modelValue\": _cache[5] || (_cache[5] = ($event) => ((historyQuery).value = $event)),\n                                                        type: \"search\",\n                                                        placeholder: \"搜索历史消息...\",\n                                                        style: { \"flex\": \"1\", \"padding\": \"8px\", \"border-radius\": \"8px\", \"border\": \"1px solid var(--line-soft)\" }\n                                                    }, null, 512 /* NEED_PATCH */), [\n                                                        [\n                                                            _vModelText,\n                                                            historyQuery.value,\n                                                            void 0,\n                                                            { trim: true }\n                                                        ]\n                                                    ]),\n                                                    _createElementVNode(\"button\", {\n                                                        class: \"btn\",\n                                                        onClick: _cache[6] || (_cache[6] = ($event) => (loadHistory(true)))\n                                                    }, \"刷新\")\n                                                ]),\n                                                _createElementVNode(\"div\", _hoisted_32, [\n                                                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(historyFilteredMessages.value, (msg) => {\n                                                        return (_openBlock(), _createElementBlock(\"div\", {\n                                                            key: msg.message_id,\n                                                            class: \"card\",\n                                                            style: { \"padding\": \"15px\", \"border\": \"1px solid var(--line-soft)\", \"border-radius\": \"12px\", \"background\": \"white\" }\n                                                        }, [\n                                                            _createElementVNode(\"div\", _hoisted_33, [\n                                                                _createElementVNode(\"span\", null, \"#\" + _toDisplayString(msg.message_id) + \" \" + _toDisplayString(msg.name || roleLabel(msg.role)), 1 /* TEXT */)\n                                                            ]),\n                                                            _createElementVNode(\"p\", _hoisted_34, _toDisplayString(truncateText(msg.message, 200)), 1 /* TEXT */),\n                                                            _createElementVNode(\"button\", {\n                                                                class: \"btn\",\n                                                                style: { \"font-size\": \"0.8rem\", \"padding\": \"4px 10px\" },\n                                                                onClick: ($event) => (useHistoryAsCustom(msg.message))\n                                                            }, \" 引用 \", 8 /* PROPS */, _hoisted_35)\n                                                        ]));\n                                                    }), 128 /* KEYED_FRAGMENT */)),\n                                                    (historyHasMore.value)\n                                                        ? (_openBlock(), _createElementBlock(\"button\", {\n                                                            key: 0,\n                                                            class: \"btn\",\n                                                            onClick: loadMoreHistory\n                                                        }, \"加载更多\"))\n                                                        : _createCommentVNode(\"v-if\", true)\n                                                ])\n                                            ]))\n                                            : (activeTab.value === 'worldbook')\n                                                ? (_openBlock(), _createElementBlock(_Fragment, { key: 1 }, [\n                                                    _createCommentVNode(\" Worldbook Tab \"),\n                                                    _createElementVNode(\"div\", _hoisted_36, [\n                                                        _createElementVNode(\"div\", _hoisted_37, [\n                                                            _withDirectives(_createElementVNode(\"select\", {\n                                                                \"onUpdate:modelValue\": _cache[7] || (_cache[7] = ($event) => ((selectedWorldbookName).value = $event)),\n                                                                style: { \"padding\": \"8px\", \"border-radius\": \"8px\", \"border\": \"1px solid var(--line-soft)\" }\n                                                            }, [\n                                                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(worldbookNames.value, (name) => {\n                                                                    return (_openBlock(), _createElementBlock(\"option\", {\n                                                                        key: name,\n                                                                        value: name\n                                                                    }, _toDisplayString(name), 9 /* TEXT, PROPS */, _hoisted_38));\n                                                                }), 128 /* KEYED_FRAGMENT */))\n                                                            ], 512 /* NEED_PATCH */), [\n                                                                [_vModelSelect, selectedWorldbookName.value]\n                                                            ]),\n                                                            _withDirectives(_createElementVNode(\"input\", {\n                                                                \"onUpdate:modelValue\": _cache[8] || (_cache[8] = ($event) => ((worldbookQuery).value = $event)),\n                                                                type: \"search\",\n                                                                placeholder: \"搜索条目...\",\n                                                                style: { \"padding\": \"8px\", \"border-radius\": \"8px\", \"border\": \"1px solid var(--line-soft)\" }\n                                                            }, null, 512 /* NEED_PATCH */), [\n                                                                [\n                                                                    _vModelText,\n                                                                    worldbookQuery.value,\n                                                                    void 0,\n                                                                    { trim: true }\n                                                                ]\n                                                            ])\n                                                        ]),\n                                                        _createElementVNode(\"div\", _hoisted_39, [\n                                                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(filteredWorldbookEntries.value, (entry) => {\n                                                                return (_openBlock(), _createElementBlock(\"div\", {\n                                                                    key: entry.uid,\n                                                                    class: \"card\",\n                                                                    style: { \"padding\": \"15px\", \"border\": \"1px solid var(--line-soft)\", \"border-radius\": \"12px\", \"background\": \"white\" }\n                                                                }, [\n                                                                    _createElementVNode(\"div\", _hoisted_40, [\n                                                                        _createElementVNode(\"strong\", _hoisted_41, _toDisplayString(entry.name), 1 /* TEXT */),\n                                                                        _createElementVNode(\"button\", {\n                                                                            class: \"btn\",\n                                                                            style: _normalizeStyle({ color: entry.enabled ? 'green' : 'red' }),\n                                                                            onClick: ($event) => (toggleWorldbookEntryState(entry.uid, !entry.enabled))\n                                                                        }, _toDisplayString(entry.enabled ? '已启用' : '已禁用'), 13 /* TEXT, STYLE, PROPS */, _hoisted_42)\n                                                                    ]),\n                                                                    _createElementVNode(\"p\", _hoisted_43, _toDisplayString(truncateText(entry.content, 150)), 1 /* TEXT */)\n                                                                ]));\n                                                            }), 128 /* KEYED_FRAGMENT */))\n                                                        ])\n                                                    ])\n                                                ], 2112 /* STABLE_FRAGMENT, DEV_ROOT_FRAGMENT */))\n                                                : (activeTab.value === 'settings')\n                                                    ? (_openBlock(), _createElementBlock(_Fragment, { key: 2 }, [\n                                                        _createCommentVNode(\" Settings Tab \"),\n                                                        _createElementVNode(\"div\", _hoisted_44, [\n                                                            _createElementVNode(\"div\", _hoisted_45, [\n                                                                _createElementVNode(\"div\", _hoisted_46, [\n                                                                    _cache[29] || (_cache[29] = _createElementVNode(\"label\", { style: { \"display\": \"block\", \"margin-bottom\": \"8px\", \"font-weight\": \"600\" } }, \"主题风格\", -1 /* CACHED */)),\n                                                                    _createElementVNode(\"div\", _hoisted_47, [\n                                                                        _createElementVNode(\"button\", {\n                                                                            class: _normalizeClass([\"btn\", { active: settings.value.theme === 'theme-latte-noir' }]),\n                                                                            onClick: _cache[9] || (_cache[9] = ($event) => (settings.value.theme = 'theme-latte-noir'))\n                                                                        }, \" 奶油白昼 \", 2 /* CLASS */),\n                                                                        _createElementVNode(\"button\", {\n                                                                            class: _normalizeClass([\"btn\", { active: settings.value.theme === 'theme-midnight-salon' }]),\n                                                                            onClick: _cache[10] || (_cache[10] = ($event) => (settings.value.theme = 'theme-midnight-salon'))\n                                                                        }, \" 午夜沙龙 \", 2 /* CLASS */)\n                                                                    ])\n                                                                ]),\n                                                                _createElementVNode(\"div\", _hoisted_48, [\n                                                                    _cache[30] || (_cache[30] = _createElementVNode(\"label\", { style: { \"display\": \"block\", \"margin-bottom\": \"8px\", \"font-weight\": \"600\" } }, \"显示模式\", -1 /* CACHED */)),\n                                                                    _createElementVNode(\"div\", _hoisted_49, [\n                                                                        _createElementVNode(\"button\", {\n                                                                            class: _normalizeClass([\"btn\", { active: settings.value.displayMode === 'instant' }]),\n                                                                            onClick: _cache[11] || (_cache[11] = ($event) => (settings.value.displayMode = 'instant'))\n                                                                        }, \" 即时 \", 2 /* CLASS */),\n                                                                        _createElementVNode(\"button\", {\n                                                                            class: _normalizeClass([\"btn\", { active: settings.value.displayMode === 'typewriter' }]),\n                                                                            onClick: _cache[12] || (_cache[12] = ($event) => (settings.value.displayMode = 'typewriter'))\n                                                                        }, \" 打字机 \", 2 /* CLASS */),\n                                                                        _createElementVNode(\"button\", {\n                                                                            class: _normalizeClass([\"btn\", { active: settings.value.displayMode === 'segment' }]),\n                                                                            onClick: _cache[13] || (_cache[13] = ($event) => (settings.value.displayMode = 'segment'))\n                                                                        }, \" 分段 \", 2 /* CLASS */)\n                                                                    ])\n                                                                ]),\n                                                                _createElementVNode(\"div\", _hoisted_50, [\n                                                                    _cache[31] || (_cache[31] = _createElementVNode(\"label\", { style: { \"display\": \"block\", \"margin-bottom\": \"8px\", \"font-weight\": \"600\" } }, \"字体大小\", -1 /* CACHED */)),\n                                                                    _createElementVNode(\"div\", _hoisted_51, [\n                                                                        _createElementVNode(\"button\", {\n                                                                            class: _normalizeClass([\"btn\", { active: settings.value.fontScale === 'small' }]),\n                                                                            onClick: _cache[14] || (_cache[14] = ($event) => (settings.value.fontScale = 'small'))\n                                                                        }, \" 小 \", 2 /* CLASS */),\n                                                                        _createElementVNode(\"button\", {\n                                                                            class: _normalizeClass([\"btn\", { active: settings.value.fontScale === 'medium' }]),\n                                                                            onClick: _cache[15] || (_cache[15] = ($event) => (settings.value.fontScale = 'medium'))\n                                                                        }, \" 中 \", 2 /* CLASS */),\n                                                                        _createElementVNode(\"button\", {\n                                                                            class: _normalizeClass([\"btn\", { active: settings.value.fontScale === 'large' }]),\n                                                                            onClick: _cache[16] || (_cache[16] = ($event) => (settings.value.fontScale = 'large'))\n                                                                        }, \" 大 \", 2 /* CLASS */)\n                                                                    ])\n                                                                ]),\n                                                                _createElementVNode(\"button\", {\n                                                                    class: \"btn\",\n                                                                    style: { \"margin-top\": \"20px\", \"background\": \"#ff4d4f\", \"color\": \"white\", \"border\": \"none\" },\n                                                                    onClick: resetSettings\n                                                                }, \" 重置所有设置 \")\n                                                            ])\n                                                        ])\n                                                    ], 2112 /* STABLE_FRAGMENT, DEV_ROOT_FRAGMENT */))\n                                                    : (activeTab.value === 'character')\n                                                        ? (_openBlock(), _createElementBlock(_Fragment, { key: 3 }, [\n                                                            _createCommentVNode(\" Character Tab \"),\n                                                            _createElementVNode(\"div\", _hoisted_52, [\n                                                                _createElementVNode(\"div\", _hoisted_53, [\n                                                                    _createElementVNode(\"div\", _hoisted_54, [\n                                                                        (_openBlock(), _createElementBlock(_Fragment, null, _renderList(characterProfiles, (item) => {\n                                                                            return _createElementVNode(\"button\", {\n                                                                                key: item.key,\n                                                                                class: _normalizeClass([\"btn\", { active: activeCharacterKey.value === item.key }]),\n                                                                                onClick: ($event) => (activeCharacterKey.value = item.key)\n                                                                            }, _toDisplayString(item.name), 11 /* TEXT, CLASS, PROPS */, _hoisted_55);\n                                                                        }), 64 /* STABLE_FRAGMENT */))\n                                                                    ]),\n                                                                    _createElementVNode(\"div\", _hoisted_56, [\n                                                                        _createElementVNode(\"div\", _hoisted_57, [\n                                                                            _createElementVNode(\"img\", {\n                                                                                src: activeCharacter.value.avatarUrl,\n                                                                                style: { \"width\": \"100px\", \"height\": \"100px\", \"border-radius\": \"12px\", \"object-fit\": \"cover\", \"border\": \"2px solid var(--accent-gold)\" }\n                                                                            }, null, 8 /* PROPS */, _hoisted_58),\n                                                                            _createElementVNode(\"div\", null, [\n                                                                                _createElementVNode(\"h3\", _hoisted_59, _toDisplayString(activeCharacter.value.name), 1 /* TEXT */),\n                                                                                _createElementVNode(\"p\", _hoisted_60, _toDisplayString(activeCharacter.value.summary), 1 /* TEXT */)\n                                                                            ])\n                                                                        ]),\n                                                                        _createElementVNode(\"div\", _hoisted_61, [\n                                                                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(activeCharacterState.value, (val, label) => {\n                                                                                return (_openBlock(), _createElementBlock(\"div\", { key: label }, [\n                                                                                    _createElementVNode(\"span\", _hoisted_62, _toDisplayString(label), 1 /* TEXT */),\n                                                                                    _createElementVNode(\"span\", _hoisted_63, _toDisplayString(val), 1 /* TEXT */)\n                                                                                ]));\n                                                                            }), 128 /* KEYED_FRAGMENT */))\n                                                                        ])\n                                                                    ])\n                                                                ])\n                                                            ])\n                                                        ], 2112 /* STABLE_FRAGMENT, DEV_ROOT_FRAGMENT */))\n                                                        : _createCommentVNode(\"v-if\", true)\n                                    ])\n                                ])\n                            ]))\n                            : _createCommentVNode(\"v-if\", true)\n                    ]),\n                    _: 1 /* STABLE */\n                }),\n                _createCommentVNode(\" Perspective Selector \"),\n                _createVNode(_Transition, { name: \"fade\" }, {\n                    default: _withCtx(() => [\n                        (showPerspectiveSelector.value)\n                            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_64, [\n                                _createElementVNode(\"div\", _hoisted_65, [\n                                    _cache[34] || (_cache[34] = _createElementVNode(\"header\", { class: \"modal-header\" }, [\n                                        _createElementVNode(\"h2\", null, \"请选择主视角\")\n                                    ], -1 /* CACHED */)),\n                                    _createElementVNode(\"div\", _hoisted_66, [\n                                        _cache[33] || (_cache[33] = _createElementVNode(\"p\", { style: { \"margin-bottom\": \"20px\", \"color\": \"var(--ink-1)\" } }, \" 首次进入当前聊天，请选择一个主视角以注入对应的开场白。 \", -1 /* CACHED */)),\n                                        _createElementVNode(\"div\", _hoisted_67, [\n                                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(perspectiveEntries.value, (item) => {\n                                                return (_openBlock(), _createElementBlock(\"button\", {\n                                                    key: item.key,\n                                                    class: \"card\",\n                                                    style: _normalizeStyle({\n                                                        border: selectedPerspective.value === item.key ? '2px solid var(--accent-gold)' : '1px solid var(--line-soft)',\n                                                        padding: '15px',\n                                                        cursor: 'pointer',\n                                                        background: 'white',\n                                                        textAlign: 'left',\n                                                    }),\n                                                    onClick: ($event) => (selectedPerspective.value = item.key)\n                                                }, [\n                                                    _createElementVNode(\"strong\", _hoisted_69, _toDisplayString(item.key), 1 /* TEXT */),\n                                                    _createElementVNode(\"span\", _hoisted_70, _toDisplayString(item.description), 1 /* TEXT */)\n                                                ], 12 /* STYLE, PROPS */, _hoisted_68));\n                                            }), 128 /* KEYED_FRAGMENT */))\n                                        ]),\n                                        (selectedPerspective.value)\n                                            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_71, [\n                                                _cache[32] || (_cache[32] = _createElementVNode(\"h3\", { style: { \"font-size\": \"0.9rem\", \"margin-bottom\": \"10px\", \"color\": \"var(--ink-1)\" } }, \"开场白预览：\", -1 /* CACHED */)),\n                                                _createElementVNode(\"p\", _hoisted_72, _toDisplayString(selectedOpeningPreview.value), 1 /* TEXT */)\n                                            ]))\n                                            : _createCommentVNode(\"v-if\", true),\n                                        _createElementVNode(\"button\", {\n                                            class: \"btn-send\",\n                                            style: { \"width\": \"100%\", \"padding\": \"15px\", \"font-size\": \"1.1rem\" },\n                                            disabled: !selectedPerspective.value,\n                                            onClick: confirmPerspective\n                                        }, \" 确认并开始故事 \", 8 /* PROPS */, _hoisted_73)\n                                    ])\n                                ])\n                            ]))\n                            : _createCommentVNode(\"v-if\", true)\n                    ]),\n                    _: 1 /* STABLE */\n                })\n            ], 12 /* STYLE, PROPS */, _hoisted_1));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./App.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./App.vue?vue&type=script&setup=true&lang=ts\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { createPinia } from 'pinia';\nimport { createApp } from 'vue';\nimport App from './App.vue';\nimport './main.css';\n\n$(() => {\n  const app = createApp(App).use(createPinia());\n  app.mount('#app');\n  $(window).on('pagehide', () => app.unmount());\n});\n"],"names":["Vue","perspectives","description","opening","_hoisted_1","_hoisted_2","key","class","_hoisted_3","id","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","_hoisted_22","_hoisted_23","_hoisted_24","_hoisted_25","_hoisted_26","_hoisted_27","style","_hoisted_28","_hoisted_29","_hoisted_30","_hoisted_31","_hoisted_32","_hoisted_33","_hoisted_34","_hoisted_35","_hoisted_36","_hoisted_37","_hoisted_38","_hoisted_39","_hoisted_40","_hoisted_41","_hoisted_42","_hoisted_43","_hoisted_44","_hoisted_45","_hoisted_46","_hoisted_47","_hoisted_48","_hoisted_49","_hoisted_50","_hoisted_51","_hoisted_52","_hoisted_53","_hoisted_54","_hoisted_55","_hoisted_56","_hoisted_57","_hoisted_58","_hoisted_59","_hoisted_60","_hoisted_61","_hoisted_62","_hoisted_63","_hoisted_64","_hoisted_65","_hoisted_66","_hoisted_67","_hoisted_68","_hoisted_69","_hoisted_70","_hoisted_71","_hoisted_72","_hoisted_73","SETTINGS_STORAGE_KEY","PERSPECTIVE_VAR_PATH","__name","setup","__props","perspectiveKeys","fallbackOpeningConfig","defaultSettings","theme","displayMode","fontScale","autoScroll","reduceMotion","catboxImage","code","characterProfiles","name","color","avatarUrl","summary","mood","location","outfit","relation","perspectiveToCharacter","truncateText","text","max","length","slice","openingConfig","input","base","_","cloneDeep","raw","forEach","candidate","trim","normalizeOpeningConfig","settings","ref","localStorage","getItem","parsed","JSON","parse","loadSettings","isFeatureModalVisible","activeTab","showPerspectiveSelector","isSplashScreenVisible","selectedPerspective","perspectiveConfirmed","customOption","isFullscreen","isBusyGenerating","rawCurrentMessage","displayedMessage","activeCharacterKey","chatVariablesSnapshot","historyMessages","historyDepth","historyQuery","worldbookNames","selectedWorldbookName","worldbookEntries","worldbookQuery","worldbookError","isWorldbookLoading","lastMessageId","options","title","content","tabs","label","modalTitle","computed","find","t","value","fontScaleMap","small","medium","large","pageRootStyle","perspectiveEntries","map","selectedOpeningPreview","historyFilteredMessages","keyword","toLowerCase","sorted","sort","lhs","rhs","message_id","filter","msg","message","includes","historyHasMore","filteredWorldbookEntries","entry","activeCharacter","item","activeCharacterState","profile","vars","get","String","eventStops","typewriterTimer","lastFocusedElement","clearTypewriterTimer","window","clearInterval","saveSettings","setItem","stringify","resetSettings","toastr","success","toggleDisplayMode","chain","index","indexOf","readPerspectiveFromChatVariables","getVariables","type","isPerspectiveKey","syncLastMessageId","getLastMessageId","getPerspectiveOpening","confirmPerspective","updateVariablesWith","set","error","console","warn","persistPerspectiveToChatVariables","mapped","updateOptionsFromMessage","loadHistory","reset","lastId","range","Math","getChatMessages","hide_state","loadMoreHistory","async","loadWorldbookEntries","getWorldbook","reloadWorldbook","names","bind","getCharWorldbookNames","push","primary","additional","Boolean","getWorldbookNames","Array","from","Set","loadWorldbookNames","refreshChatVariablesSnapshot","dynamic","block","match","matchAll","extractRoleplayOptions","refreshLatestAssistantMessage","start","latest","role","at","handleOption","clean","isFirstTurn","createChatMessages","result","generate","user_input","should_stream","overrides","chat_history","prompts","undefined","target","document","getElementById","scrollIntoView","behavior","scrollStoryIfNeeded","warning","info","submitCustomOption","unshift","Date","now","toggleFullscreen","fullscreenElement","documentElement","requestFullscreen","exitFullscreen","handleStart","openFeatureModal","tab","activeElement","HTMLElement","closeFeatureModal","nextTick","focus","onGlobalKeydown","event","initializeForCurrentChat","cachedPerspective","watch","deep","replace","chars","setInterval","join","applyDisplayMessage","immediate","onMounted","meta","head","querySelector","createElement","appendChild","upsertMetaDescription","addEventListener","eventOn","tavern_events","MESSAGE_RECEIVED","stop","MESSAGE_EDITED","MESSAGE_SWIPED","CHAT_CHANGED","WORLDINFO_UPDATED","onBeforeUnmount","removeEventListener","_ctx","_cache","default","onClick","$event","option","disabled","placeholder","onKeydown","characterKey","src","alt","onError","characterName","onerror","encodeURIComponent","active","uid","enabled","updateWorldbookWith","entries","val","border","padding","cursor","background","textAlign","$","app","createApp","App","use","mount","on","unmount"],"sourceRoot":""}