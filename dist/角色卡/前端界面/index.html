<head><script type="module">import{createPinia as e}from'https://testingcf.jsdelivr.net/npm/pinia/+esm';const t=Vue,a={perspectives:{心爱:{description:'以保登心爱的情绪与语气观察事件发展，优先关注热情、主动与当下氛围。',opening:'你在清晨推开 Rabbit House 的门，熟悉的甜香与轻快脚步声同时向你迎来。'},智乃:{description:'以香风智乃的克制与细腻感知推进剧情，优先关注细节与隐含情绪变化。',opening:'你端正地整理围裙与托盘，抬眼时，门铃正好响起，今天的第一位客人到了。'},理世:{description:'以天天座理世的执行力推进剧情，优先处理秩序、任务与突发状况。',opening:'你快速扫视店内座位与动线，确认一切就绪后，今天的营业正式开始。'},千夜:{description:'以宇治松千夜的温婉风格观察互动，优先关注礼节、安抚与氛围调和。',opening:'你轻轻摆好茶点，窗外风铃声细微晃动，一段柔和却重要的对话即将开始。'},纱路:{description:'以桐间纱路的谨慎与责任感参与剧情，优先关注风险与规则边界。',opening:'你深呼吸后推门而入，尽量让自己的步伐显得从容，不让紧张暴露在表情里。'},无:{description:'使用中立视角，不绑定具体角色语气，更适合观察多角色并行叙事。',opening:'午后钟声落下，你推门进入熟悉的咖啡馆，空气里有甜点与咖啡的暖香。'}}},l=['data-theme','data-reduced-motion'],n={key:0,class:'splash-screen'},o={id:'region-top-nav'},r={class:'nav-actions'},i={id:'region-main-content'},s={class:'panel-story'},c={id:'story-current-message','aria-live':'polite'},d={class:'panel-options'},m={class:'panel-header'},u={key:0,class:'status-chip animate-pulse'},p={class:'option-list'},v=['disabled','onClick'],g={class:'custom-input-group'},y=['disabled','onKeydown'],f=['disabled'],E={id:'region-character-bar'},k={class:'character-scroll'},b=['onClick'],h={class:'char-avatar'},V=['src','alt','onError'],N={class:'char-name'},x={class:'quick-actions-mini'},C=['title'],S=['title'],w={class:'modal-shell'},B={class:'modal-header'},M={class:'tab-nav',style:{display:'flex',padding:'10px',gap:'10px','border-bottom':'1px solid var(--line-soft)'}},D=['onClick'],L={class:'modal-body'},T={key:0,class:'tab-panel'},I={class:'panel-tools',style:{display:'flex',gap:'10px','margin-bottom':'15px'}},U={class:'history-list',style:{display:'flex','flex-direction':'column',gap:'10px'}},F={style:{display:'flex','justify-content':'space-between','margin-bottom':'8px','font-size':'0.85rem',color:'var(--ink-1)'}},O={style:{'font-size':'0.95rem','margin-bottom':'10px'}},A=['onClick'],W={class:'tab-panel'},j={class:'panel-tools',style:{display:'flex','flex-direction':'column',gap:'10px','margin-bottom':'15px'}},P=['value'],R={class:'worldbook-list',style:{display:'flex','flex-direction':'column',gap:'10px'}},G={style:{display:'flex','justify-content':'space-between','align-items':'center','margin-bottom':'8px'}},H={style:{color:'var(--accent-gold)'}},q=['onClick'],K={style:{'font-size':'0.9rem',color:'var(--ink-1)'}},J={class:'tab-panel'},Q={class:'settings-grid',style:{display:'flex','flex-direction':'column',gap:'20px'}},X={class:'setting-item'},Y={style:{display:'flex',gap:'10px'}},Z={class:'setting-item'},ee={style:{display:'flex',gap:'10px'}},te={class:'setting-item'},ae={style:{display:'flex',gap:'10px'}},le={class:'tab-panel'},ne={style:{display:'flex',gap:'20px','flex-direction':'column'}},oe={style:{display:'flex',gap:'10px','overflow-x':'auto','padding-bottom':'10px'}},re=['onClick'],ie={class:'card',style:{padding:'20px',border:'1px solid var(--line-soft)','border-radius':'16px',background:'white'}},se={style:{display:'flex',gap:'20px','align-items':'flex-start'}},ce=['src'],de={style:{'margin-bottom':'5px',color:'var(--accent-gold)'}},me={style:{'font-size':'0.9rem',color:'var(--ink-1)'}},ue={style:{'margin-top':'20px',display:'grid','grid-template-columns':'1fr 1fr',gap:'15px'}},pe={style:{display:'block','font-size':'0.8rem',color:'var(--ink-muted)'}},ve={style:{'font-weight':'600'}},ge={key:0,class:'modal-scrim'},ye={class:'modal-shell',style:{'max-width':'800px'}},fe={class:'modal-body'},Ee={style:{display:'grid','grid-template-columns':'repeat(auto-fit, minmax(180px, 1fr))',gap:'15px','margin-bottom':'30px'}},ke=['onClick'],be={style:{display:'block','margin-bottom':'5px',color:'var(--accent-gold)'}},he={style:{'font-size':'0.85rem',color:'var(--ink-1)'}},Ve={key:0,class:'card',style:{padding:'20px',background:'var(--bg-1)','border-radius':'12px','margin-bottom':'20px'}},Ne={style:{'font-family':'\'Noto Serif SC\', serif','line-height':'1.6'}},xe=['disabled'],Ce='gochiusa.frontend.settings.v2',Se='前端界面.主视角',we=(0,t.defineComponent)({__name:'App',setup(e){const we=['心爱','智乃','理世','千夜','纱路','无'],Be={perspectives:{心爱:{description:'以保登心爱的情绪与语气观察事件发展，优先关注热情、主动与当下氛围。',opening:'你在清晨推开兔屋咖啡馆的大门，熟悉的甜香与轻快脚步声同时向你迎来。'},智乃:{description:'以香风智乃的克制与细腻感知推进剧情，优先关注细节与隐含情绪变化。',opening:'你端正地整理围裙与托盘，抬眼时，门铃正好响起，今天的第一位客人到了。'},理世:{description:'以天天座理世的执行力推进剧情，优先处理秩序、任务与突发状况。',opening:'你快速扫视店内座位与动线，确认一切就绪后，今天的营业正式开始。'},千夜:{description:'以宇治松千夜的温婉风格观察互动，优先关注礼节、安抚与氛围调和。',opening:'你轻轻摆好茶点，窗外风铃声细微晃动，一段柔和却重要的对话即将开始。'},纱路:{description:'以桐间纱路的谨慎与责任感参与剧情，优先关注风险与规则边界。',opening:'你深呼吸后推门而入，尽量让自己的步伐显得从容，不让紧张暴露在表情里。'},无:{description:'使用中立视角，不绑定具体角色语气，更适合观察多角色并行叙事。',opening:'午后钟声落下，你推门进入熟悉的咖啡馆，空气里有甜点与咖啡的暖香。'}}},Me={theme:'theme-latte-noir',displayMode:'instant',fontScale:'medium',autoScroll:!0,reduceMotion:!1};function _e(e){return`https://files.catbox.moe/${e}.png`}const De=[{key:'cocoa',name:'保登心爱',color:'var(--clr-cocoa)',avatarUrl:_e('qjltca'),summary:'活力型引导角色，擅长快速拉近关系并推动场景气氛。',mood:'开朗',location:'兔屋咖啡馆前厅',outfit:'咖啡厅制服',relation:'友好'},{key:'chino',name:'香风智乃',color:'var(--clr-chino)',avatarUrl:_e('6t09pw'),summary:'观察型角色，擅长在安静场景中提供高价值细节。',mood:'冷静',location:'吧台内侧',outfit:'咖啡厅制服',relation:'信任建立中'},{key:'rize',name:'天天座理世',color:'var(--clr-rize)',avatarUrl:_e('n9szhx'),summary:'执行型角色，擅长处理节奏与秩序相关场景。',mood:'专注',location:'点单与出餐动线',outfit:'咖啡厅制服',relation:'可靠同伴'},{key:'chiya',name:'宇治松千夜',color:'var(--clr-chiya)',avatarUrl:_e('v4spnt'),summary:'情绪调和型角色，擅长缓冲冲突与提升舒适感。',mood:'温和',location:'甜点展示区',outfit:'和风改良制服',relation:'亲近'},{key:'syaro',name:'桐间纱路',color:'var(--clr-syaro)',avatarUrl:_e('b982xz'),summary:'谨慎型角色，适合调查、推理与高压交互场景。',mood:'紧张但坚定',location:'门厅与过道',outfit:'学院日常装',relation:'逐步加深'}],ze={心爱:'cocoa',智乃:'chino',理世:'rize',千夜:'chiya',纱路:'syaro',无:'cocoa'};function $e(e,t=120){return e.length<=t?e:`${e.slice(0,t)}...`}const Le=function(e){const t=_.cloneDeep(Be);if(!e||'object'!=typeof e)return t;const a=e.perspectives;return a&&'object'==typeof a?(we.forEach(e=>{const l=a[e];l&&'string'==typeof l.description&&l.description.trim().length>0&&'string'==typeof l.opening&&l.opening.trim().length>0&&(t.perspectives[e]={description:l.description,opening:l.opening})}),t):t}(a),Te=(0,t.ref)(function(){try{const e=localStorage.getItem(Ce);if(!e)return Me;const t=JSON.parse(e);return{theme:'theme-midnight-salon'===t.theme?'theme-midnight-salon':'theme-latte-noir',displayMode:'typewriter'===t.displayMode||'segment'===t.displayMode?t.displayMode:'instant',fontScale:'small'===t.fontScale||'large'===t.fontScale?t.fontScale:'medium',autoScroll:!1!==t.autoScroll,reduceMotion:!0===t.reduceMotion}}catch{return Me}}()),Ie=(0,t.ref)(!1),Ue=(0,t.ref)('history'),Fe=(0,t.ref)(!1),Oe=(0,t.ref)(!0),Ae=(0,t.ref)(null),We=(0,t.ref)(!1),je=(0,t.ref)(''),Pe=(0,t.ref)(!1),Re=(0,t.ref)(!1),Ge=(0,t.ref)('正在等待剧情推进，请选择下一步行动。'),He=(0,t.ref)('正在等待剧情推进，请选择下一步行动。'),qe=(0,t.ref)('cocoa'),Ke=(0,t.ref)({}),Je=(0,t.ref)([]),Qe=(0,t.ref)(40),Xe=(0,t.ref)(''),Ye=(0,t.ref)([]),Ze=(0,t.ref)(''),et=(0,t.ref)([]),tt=(0,t.ref)(''),at=(0,t.ref)(''),lt=(0,t.ref)(!1),nt=(0,t.ref)(0),ot=(0,t.ref)([{id:'opt-001',title:'向柜台点单',content:'你走向柜台，礼貌地询问今日推荐饮品。'},{id:'opt-002',title:'观察店内',content:'你放慢脚步，观察店内客人与角色之间的互动细节。'},{id:'opt-003',title:'主动搭话',content:'你选择与当前出场角色展开一段自然交流。'}]),rt=[{key:'history',label:'历史消息'},{key:'worldbook',label:'世界书'},{key:'settings',label:'设置'},{key:'character',label:'角色详情'}],it=(0,t.computed)(()=>rt.find(e=>e.key===Ue.value)?.label||'功能面板'),st={small:'0.92',medium:'1',large:'1.08'},ct=(0,t.computed)(()=>({'--font-scale':st[Te.value.fontScale]})),dt=(0,t.computed)(()=>we.map(e=>({key:e,...Le.perspectives[e]}))),mt=(0,t.computed)(()=>{const e=Ae.value;return e?Le.perspectives[e].opening:'请选择一个主视角后查看对应开场白。'}),ut=(0,t.computed)(()=>{const e=Xe.value.trim().toLowerCase(),t=[...Je.value].sort((e,t)=>t.message_id-e.message_id);return e?t.filter(t=>`${t.name} ${t.message}`.toLowerCase().includes(e)):t}),pt=(0,t.computed)(()=>Qe.value<nt.value+1),vt=(0,t.computed)(()=>{const e=tt.value.trim().toLowerCase();return e?et.value.filter(t=>`${t.name} ${t.content}`.toLowerCase().includes(e)):et.value}),gt=(0,t.computed)(()=>De.find(e=>e.key===qe.value)??De[0]),yt=(0,t.computed)(()=>{const e=gt.value,t=Ke.value,a=_.get(t,`${e.name}.心情`)??_.get(t,`角色状态.${e.name}.心情`)??_.get(t,`角色.${e.name}.心情`)??e.mood,l=_.get(t,`${e.name}.位置`)??_.get(t,`角色状态.${e.name}.位置`)??_.get(t,`角色.${e.name}.位置`)??e.location,n=_.get(t,`${e.name}.着装`)??_.get(t,`角色状态.${e.name}.着装`)??_.get(t,`角色.${e.name}.着装`)??e.outfit,o=_.get(t,`${e.name}.关系`)??_.get(t,`角色状态.${e.name}.关系`)??_.get(t,`角色.${e.name}.关系`)??e.relation;return{当前心情:String(a),所在位置:String(l),当前着装:String(n),关系状态:String(o)}}),ft=[];let Et=null,kt=null;function bt(){null!==Et&&(window.clearInterval(Et),Et=null)}function ht(){localStorage.setItem(Ce,JSON.stringify(Te.value))}function Vt(){Te.value=_.cloneDeep(Me),ht(),toastr.success('设置已恢复默认值。')}function Nt(){const e=['instant','typewriter','segment'],t=e.indexOf(Te.value.displayMode);Te.value.displayMode=e[(t+1)%e.length]}function xt(){try{const e=getVariables({type:'chat'}),t=_.get(e,Se);return function(e){return we.includes(e)}(t)?t:null}catch{return null}}function Ct(){const e=getLastMessageId();return nt.value=e,e}function St(){const e=Ae.value??'无';return Le.perspectives[e].opening}function wt(){if(!Ae.value)return;We.value=!0,Fe.value=!1,function(e){try{updateVariablesWith(t=>(_.set(t,Se,e),t),{type:'chat'})}catch(e){console.warn('保存主视角到聊天变量失败:',e)}}(Ae.value);const e=ze[Ae.value];e&&(qe.value=e),0===Ct()&&(Ge.value=St(),$t(Ge.value)),toastr.success(`主视角已确定：${Ae.value}`)}function Bt(e=!1){e&&(Qe.value=40);const t=Ct(),a=`${Math.max(0,t-Qe.value+1)}-${t}`;Je.value=getChatMessages(a,{hide_state:'unhidden'})}function Mt(){Qe.value+=40,Bt(!1)}async function _t(){if(Ze.value){lt.value=!0,at.value='';try{et.value=await getWorldbook(Ze.value)}catch(e){at.value='读取世界书失败，请检查绑定状态。',console.error(e)}finally{lt.value=!1}}else et.value=[]}async function Dt(){await async function(){const e=[];try{const t=getCharWorldbookNames('current');e.push(...[t.primary,...t.additional].filter(e=>Boolean(e)))}catch{}if(e.length||e.push(...getWorldbookNames()),Ye.value=Array.from(new Set(e)),!Ye.value.length)return Ze.value='',void(et.value=[]);Ye.value.includes(Ze.value)||(Ze.value=Ye.value[0])}(),await _t()}function zt(){try{Ke.value=getVariables({type:'chat'})}catch{Ke.value={}}}function $t(e){const t=function(e){const t=e.match(/<roleplay_options>([\s\S]*?)<\/roleplay_options>/i)?.[1]??'';return t.trim()?[...t.matchAll(/(.+?)[:：]\s*(.+)/g)].map((e,t)=>({id:`opt-dynamic-${t+1}`,title:e[1].trim(),content:e[2].trim()})):[]}(e);t.length>0&&(ot.value=t)}function Lt(){const e=Ct(),t=Math.max(0,e-80),a=getChatMessages(`${t}-${e}`,{role:'assistant',hide_state:'unhidden'}).at(-1);a&&'string'==typeof a.message&&(Ge.value=a.message,$t(a.message))}async function Tt(e){const t=e.trim();if(t)if(!Fe.value&&We.value){if(!Re.value){Re.value=!0;try{const e=0===Ct();await createChatMessages([{role:'user',message:t}]);const a=await generate({user_input:t,should_stream:!1,overrides:e?{chat_history:{prompts:[{role:'assistant',content:St()}]}}:void 0}),l=getChatMessages(-1)[0];l&&'assistant'===l.role||await createChatMessages([{role:'assistant',message:a}]),Ge.value=a,Lt(),$t(a),Ct(),Bt(!1),zt(),function(){if(!Te.value.autoScroll)return;const e=document.getElementById('story-current-message');e?.scrollIntoView({behavior:Te.value.reduceMotion?'auto':'smooth',block:'nearest'})}()}catch(e){toastr.error('发送选项或生成回复失败。'),console.error(e)}finally{Re.value=!1}}}else toastr.warning('请先完成主视角选择。');else toastr.info('选项内容为空，无法发送。')}async function It(){const e=je.value.trim();e?(ot.value.unshift({id:`opt-custom-${Date.now()}`,title:'自定义行动',content:e}),je.value='',await Tt(e)):toastr.info('请先填写自定义选项内容。')}async function Ut(){try{if(!document.fullscreenElement)return await document.documentElement.requestFullscreen(),void(Pe.value=!0);await document.exitFullscreen(),Pe.value=!1}catch(e){toastr.warning('当前环境不支持全屏切换。'),console.warn(e)}}function Ft(){Oe.value=!1}function Ot(e){kt=document.activeElement instanceof HTMLElement?document.activeElement:null,Ue.value=e,Ie.value=!0}function At(){Ie.value=!1,(0,t.nextTick)(()=>{kt?.focus()})}function Wt(e){'Escape'===e.key&&(Fe.value||Ie.value&&At())}async function jt(){Ct();const e=xt();Fe.value=0===Ct()&&!e,Ae.value=Fe.value?e:e??'无',We.value=!Fe.value,!Fe.value&&Ae.value&&(qe.value=ze[Ae.value]),Lt(),Bt(!0),zt(),await Dt()}return(0,t.watch)(()=>Te.value,()=>{ht()},{deep:!0}),(0,t.watch)(()=>[Ge.value,Te.value.displayMode,Te.value.reduceMotion],()=>{!function(e){if(bt(),'instant'===Te.value.displayMode)return void(He.value=e);if('segment'===Te.value.displayMode)return void(He.value=(t=e,t.replace(/([。！？!?])(?=[^\n])/g,'$1\n').replace(/\n{3,}/g,'\n\n').trim()));var t;const a=Array.from(e);He.value='';let l=0;Et=window.setInterval(()=>{l+=1,He.value=a.slice(0,l).join(''),l>=a.length&&bt()},Te.value.reduceMotion?8:20)}(Ge.value)},{immediate:!0}),(0,t.watch)(Ue,e=>{'history'!==e?'worldbook'!==e?'character'===e&&zt():Dt():Bt(!1)}),(0,t.watch)(Ze,()=>{_t()}),(0,t.onMounted)(()=>{document.title='点兔文字交互界面',function(e){let t=document.head.querySelector('meta[name="description"]');t||(t=document.createElement('meta'),t.name='description',document.head.appendChild(t)),t.content=e}('高沉浸文字互动体验，支持选项驱动叙事、世界书联动与主视角开场注入。'),document.addEventListener('keydown',Wt),jt(),ft.push(eventOn(tavern_events.MESSAGE_RECEIVED,()=>{Ct(),Lt(),Bt(!1),zt()}).stop),ft.push(eventOn(tavern_events.MESSAGE_EDITED,()=>{Ct(),Lt(),Bt(!1)}).stop),ft.push(eventOn(tavern_events.MESSAGE_SWIPED,()=>{Ct(),Lt()}).stop),ft.push(eventOn(tavern_events.CHAT_CHANGED,()=>{jt(),toastr.info('检测到聊天切换，界面数据已自动同步。')}).stop),ft.push(eventOn(tavern_events.WORLDINFO_UPDATED,()=>{Dt()}).stop)}),(0,t.onBeforeUnmount)(()=>{bt(),document.removeEventListener('keydown',Wt),ft.forEach(e=>e())}),(e,a)=>((0,t.openBlock)(),(0,t.createElementBlock)('div',{id:'page-game-root','data-theme':Te.value.theme,'data-font':'font-ui-default','data-reduced-motion':Te.value.reduceMotion?'true':'false',style:(0,t.normalizeStyle)(ct.value)},[(0,t.createCommentVNode)(' Background Layer '),a[35]||(a[35]=(0,t.createElementVNode)('div',{class:'background-layer'},[(0,t.createElementVNode)('div',{class:'bg-pattern'})],-1)),(0,t.createCommentVNode)(' Splash Screen '),(0,t.createVNode)(t.Transition,{name:'fade'},{default:(0,t.withCtx)(()=>[Oe.value?((0,t.openBlock)(),(0,t.createElementBlock)('section',n,[a[18]||(a[18]=(0,t.createElementVNode)('div',{class:'splash-logo animate-fadeInDown'},[(0,t.createElementVNode)('h1',{class:'splash-title'},'ご注文はうさぎですか？'),(0,t.createElementVNode)('p',{class:'splash-subtitle'},'BLOOM SIMULATOR')],-1)),(0,t.createElementVNode)('button',{class:'press-start-btn animate-fadeInUp',onClick:Ft},[...a[17]||(a[17]=[(0,t.createElementVNode)('span',{class:'animate-pulse'},'PRESS START',-1)])])])):(0,t.createCommentVNode)('v-if',!0)]),_:1}),(0,t.createCommentVNode)(' Top Navigation '),(0,t.createElementVNode)('header',o,[a[22]||(a[22]=(0,t.createElementVNode)('div',{class:'brand-logo'},[(0,t.createElementVNode)('span',{class:'brand-main'},'点兔叙事界面'),(0,t.createElementVNode)('span',{class:'brand-sub'},'Gochiusa Narrative Interface')],-1)),(0,t.createElementVNode)('div',r,[(0,t.createElementVNode)('button',{class:'nav-btn',title:'历史消息',onClick:a[0]||(a[0]=e=>Ot('history'))},[...a[19]||(a[19]=[(0,t.createElementVNode)('i',{class:'fa-solid fa-clock-rotate-left'},null,-1),(0,t.createElementVNode)('span',null,'历史',-1)])]),(0,t.createElementVNode)('button',{class:'nav-btn',title:'世界书',onClick:a[1]||(a[1]=e=>Ot('worldbook'))},[...a[20]||(a[20]=[(0,t.createElementVNode)('i',{class:'fa-solid fa-book-open'},null,-1),(0,t.createElementVNode)('span',null,'世界书',-1)])]),(0,t.createElementVNode)('button',{class:'nav-btn',title:'设置',onClick:a[2]||(a[2]=e=>Ot('settings'))},[...a[21]||(a[21]=[(0,t.createElementVNode)('i',{class:'fa-solid fa-gear'},null,-1),(0,t.createElementVNode)('span',null,'设置',-1)])])])]),(0,t.createCommentVNode)(' Main Content '),(0,t.createElementVNode)('main',i,[(0,t.createCommentVNode)(' Story Panel '),(0,t.createElementVNode)('section',s,[(0,t.createElementVNode)('div',{class:'panel-header'},[a[24]||(a[24]=(0,t.createElementVNode)('h2',null,'叙事消息',-1)),(0,t.createElementVNode)('div',{class:'header-tools'},[(0,t.createElementVNode)('button',{class:'btn nav-btn',onClick:Lt},[...a[23]||(a[23]=[(0,t.createElementVNode)('i',{class:'fa-solid fa-arrows-rotate'},null,-1),(0,t.createElementVNode)('span',null,'同步',-1)])])])]),(0,t.createElementVNode)('article',c,(0,t.toDisplayString)(He.value),1)]),(0,t.createCommentVNode)(' Options Panel '),(0,t.createElementVNode)('section',d,[(0,t.createElementVNode)('div',m,[a[25]||(a[25]=(0,t.createElementVNode)('h2',null,'可选行动',-1)),Re.value?((0,t.openBlock)(),(0,t.createElementBlock)('span',u,'正在生成回复...')):(0,t.createCommentVNode)('v-if',!0)]),(0,t.createElementVNode)('ul',p,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(ot.value,(e,a)=>((0,t.openBlock)(),(0,t.createElementBlock)('li',{key:e.id},[(0,t.createElementVNode)('button',{class:'option-card',disabled:Re.value,onClick:t=>Tt(e.content)},[(0,t.createElementVNode)('strong',null,'Option '+(0,t.toDisplayString)(a+1),1),(0,t.createElementVNode)('span',null,(0,t.toDisplayString)(e.content),1)],8,v)]))),128))]),(0,t.createElementVNode)('div',g,[(0,t.withDirectives)((0,t.createElementVNode)('textarea',{'onUpdate:modelValue':a[3]||(a[3]=e=>je.value=e),placeholder:'输入自定义行动...',disabled:Re.value,onKeydown:(0,t.withKeys)((0,t.withModifiers)(It,['prevent']),['enter'])},null,40,y),[[t.vModelText,je.value]]),(0,t.createElementVNode)('button',{class:'btn-send',disabled:Re.value,onClick:It},[...a[26]||(a[26]=[(0,t.createElementVNode)('i',{class:'fa-solid fa-paper-plane'},null,-1)])],8,f)])])]),(0,t.createCommentVNode)(' Bottom Character Bar '),(0,t.createElementVNode)('footer',E,[(0,t.createElementVNode)('div',k,[((0,t.openBlock)(),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(De,e=>(0,t.createElementVNode)('div',{key:e.key,class:'char-chip',style:(0,t.normalizeStyle)({'--chip-color':e.color}),onClick:t=>{return a=e.key,qe.value=a,void Ot('character');var a}},[(0,t.createElementVNode)('div',h,[(0,t.createElementVNode)('img',{src:e.avatarUrl,alt:e.name,onError:t=>function(e,t){const a=e.target;a&&(a.onerror=null,a.src=`https://api.dicebear.com/9.x/initials/svg?seed=${encodeURIComponent(t)}`)}(t,e.name)},null,40,V)]),(0,t.createElementVNode)('span',N,(0,t.toDisplayString)(e.name),1)],12,b)),64))]),(0,t.createElementVNode)('div',x,[(0,t.createElementVNode)('button',{class:'mini-btn',title:Pe.value?'退出全屏':'全屏',onClick:Ut},[(0,t.createElementVNode)('i',{class:(0,t.normalizeClass)(['fa-solid',Pe.value?'fa-compress':'fa-expand'])},null,2)],8,C),(0,t.createElementVNode)('button',{class:'mini-btn',title:Te.value.autoScroll?'关闭自动滚动':'开启自动滚动',onClick:a[4]||(a[4]=e=>Te.value.autoScroll=!Te.value.autoScroll)},[(0,t.createElementVNode)('i',{class:(0,t.normalizeClass)(['fa-solid',Te.value.autoScroll?'fa-angles-down':'fa-minus'])},null,2)],8,S),(0,t.createElementVNode)('button',{class:'mini-btn',title:'切换显示模式',onClick:Nt},[...a[27]||(a[27]=[(0,t.createElementVNode)('i',{class:'fa-solid fa-font'},null,-1)])])])]),(0,t.createCommentVNode)(' Modals '),(0,t.createVNode)(t.Transition,{name:'fade'},{default:(0,t.withCtx)(()=>[Ie.value?((0,t.openBlock)(),(0,t.createElementBlock)('div',{key:0,class:'modal-scrim',onClick:(0,t.withModifiers)(At,['self'])},[(0,t.createElementVNode)('div',w,[(0,t.createElementVNode)('header',B,[(0,t.createElementVNode)('h2',null,(0,t.toDisplayString)(it.value),1),(0,t.createElementVNode)('button',{class:'nav-btn',onClick:At},[...a[28]||(a[28]=[(0,t.createElementVNode)('i',{class:'fa-solid fa-xmark'},null,-1)])])]),(0,t.createElementVNode)('nav',M,[((0,t.openBlock)(),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(rt,e=>(0,t.createElementVNode)('button',{key:e.key,class:(0,t.normalizeClass)(['btn',{active:Ue.value===e.key}]),style:{flex:'1',padding:'8px','border-radius':'8px',border:'1px solid var(--line-soft)',background:'none',cursor:'pointer'},onClick:t=>Ue.value=e.key},(0,t.toDisplayString)(e.label),11,D)),64))]),(0,t.createElementVNode)('div',L,[(0,t.createCommentVNode)(' History Tab '),'history'===Ue.value?((0,t.openBlock)(),(0,t.createElementBlock)('div',T,[(0,t.createElementVNode)('div',I,[(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':a[5]||(a[5]=e=>Xe.value=e),type:'search',placeholder:'搜索历史消息...',style:{flex:'1',padding:'8px','border-radius':'8px',border:'1px solid var(--line-soft)'}},null,512),[[t.vModelText,Xe.value,void 0,{trim:!0}]]),(0,t.createElementVNode)('button',{class:'btn',onClick:a[6]||(a[6]=e=>Bt(!0))},'刷新')]),(0,t.createElementVNode)('div',U,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(ut.value,e=>{return(0,t.openBlock)(),(0,t.createElementBlock)('div',{key:e.message_id,class:'card',style:{padding:'15px',border:'1px solid var(--line-soft)','border-radius':'12px',background:'white'}},[(0,t.createElementVNode)('div',F,[(0,t.createElementVNode)('span',null,'#'+(0,t.toDisplayString)(e.message_id)+' '+(0,t.toDisplayString)(e.name||(a=e.role,'assistant'===a?'助手':'user'===a?'玩家':'系统')),1)]),(0,t.createElementVNode)('p',O,(0,t.toDisplayString)($e(e.message,200)),1),(0,t.createElementVNode)('button',{class:'btn',style:{'font-size':'0.8rem',padding:'4px 10px'},onClick:t=>{return a=e.message,je.value=a,At(),void toastr.info('已将历史消息填入自定义选项输入框。');var a}},' 引用 ',8,A)]);var a}),128)),pt.value?((0,t.openBlock)(),(0,t.createElementBlock)('button',{key:0,class:'btn',onClick:Mt},'加载更多')):(0,t.createCommentVNode)('v-if',!0)])])):'worldbook'===Ue.value?((0,t.openBlock)(),(0,t.createElementBlock)(t.Fragment,{key:1},[(0,t.createCommentVNode)(' Worldbook Tab '),(0,t.createElementVNode)('div',W,[(0,t.createElementVNode)('div',j,[(0,t.withDirectives)((0,t.createElementVNode)('select',{'onUpdate:modelValue':a[7]||(a[7]=e=>Ze.value=e),style:{padding:'8px','border-radius':'8px',border:'1px solid var(--line-soft)'}},[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(Ye.value,e=>((0,t.openBlock)(),(0,t.createElementBlock)('option',{key:e,value:e},(0,t.toDisplayString)(e),9,P))),128))],512),[[t.vModelSelect,Ze.value]]),(0,t.withDirectives)((0,t.createElementVNode)('input',{'onUpdate:modelValue':a[8]||(a[8]=e=>tt.value=e),type:'search',placeholder:'搜索条目...',style:{padding:'8px','border-radius':'8px',border:'1px solid var(--line-soft)'}},null,512),[[t.vModelText,tt.value,void 0,{trim:!0}]])]),(0,t.createElementVNode)('div',R,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(vt.value,e=>((0,t.openBlock)(),(0,t.createElementBlock)('div',{key:e.uid,class:'card',style:{padding:'15px',border:'1px solid var(--line-soft)','border-radius':'12px',background:'white'}},[(0,t.createElementVNode)('div',G,[(0,t.createElementVNode)('strong',H,(0,t.toDisplayString)(e.name),1),(0,t.createElementVNode)('button',{class:'btn',style:(0,t.normalizeStyle)({color:e.enabled?'green':'red'}),onClick:t=>async function(e,t){if(Ze.value)try{et.value=await updateWorldbookWith(Ze.value,a=>a.map(a=>a.uid!==e?a:{...a,enabled:t}))}catch(e){toastr.error('世界书条目状态更新失败。'),console.error(e)}}(e.uid,!e.enabled)},(0,t.toDisplayString)(e.enabled?'已启用':'已禁用'),13,q)]),(0,t.createElementVNode)('p',K,(0,t.toDisplayString)($e(e.content,150)),1)]))),128))])])],2112)):'settings'===Ue.value?((0,t.openBlock)(),(0,t.createElementBlock)(t.Fragment,{key:2},[(0,t.createCommentVNode)(' Settings Tab '),(0,t.createElementVNode)('div',J,[(0,t.createElementVNode)('div',Q,[(0,t.createElementVNode)('div',X,[a[29]||(a[29]=(0,t.createElementVNode)('label',{style:{display:'block','margin-bottom':'8px','font-weight':'600'}},'主题风格',-1)),(0,t.createElementVNode)('div',Y,[(0,t.createElementVNode)('button',{class:(0,t.normalizeClass)(['btn',{active:'theme-latte-noir'===Te.value.theme}]),onClick:a[9]||(a[9]=e=>Te.value.theme='theme-latte-noir')},' 奶油白昼 ',2),(0,t.createElementVNode)('button',{class:(0,t.normalizeClass)(['btn',{active:'theme-midnight-salon'===Te.value.theme}]),onClick:a[10]||(a[10]=e=>Te.value.theme='theme-midnight-salon')},' 午夜沙龙 ',2)])]),(0,t.createElementVNode)('div',Z,[a[30]||(a[30]=(0,t.createElementVNode)('label',{style:{display:'block','margin-bottom':'8px','font-weight':'600'}},'显示模式',-1)),(0,t.createElementVNode)('div',ee,[(0,t.createElementVNode)('button',{class:(0,t.normalizeClass)(['btn',{active:'instant'===Te.value.displayMode}]),onClick:a[11]||(a[11]=e=>Te.value.displayMode='instant')},' 即时 ',2),(0,t.createElementVNode)('button',{class:(0,t.normalizeClass)(['btn',{active:'typewriter'===Te.value.displayMode}]),onClick:a[12]||(a[12]=e=>Te.value.displayMode='typewriter')},' 打字机 ',2),(0,t.createElementVNode)('button',{class:(0,t.normalizeClass)(['btn',{active:'segment'===Te.value.displayMode}]),onClick:a[13]||(a[13]=e=>Te.value.displayMode='segment')},' 分段 ',2)])]),(0,t.createElementVNode)('div',te,[a[31]||(a[31]=(0,t.createElementVNode)('label',{style:{display:'block','margin-bottom':'8px','font-weight':'600'}},'字体大小',-1)),(0,t.createElementVNode)('div',ae,[(0,t.createElementVNode)('button',{class:(0,t.normalizeClass)(['btn',{active:'small'===Te.value.fontScale}]),onClick:a[14]||(a[14]=e=>Te.value.fontScale='small')},' 小 ',2),(0,t.createElementVNode)('button',{class:(0,t.normalizeClass)(['btn',{active:'medium'===Te.value.fontScale}]),onClick:a[15]||(a[15]=e=>Te.value.fontScale='medium')},' 中 ',2),(0,t.createElementVNode)('button',{class:(0,t.normalizeClass)(['btn',{active:'large'===Te.value.fontScale}]),onClick:a[16]||(a[16]=e=>Te.value.fontScale='large')},' 大 ',2)])]),(0,t.createElementVNode)('button',{class:'btn',style:{'margin-top':'20px',background:'#ff4d4f',color:'white',border:'none'},onClick:Vt},' 重置所有设置 ')])])],2112)):'character'===Ue.value?((0,t.openBlock)(),(0,t.createElementBlock)(t.Fragment,{key:3},[(0,t.createCommentVNode)(' Character Tab '),(0,t.createElementVNode)('div',le,[(0,t.createElementVNode)('div',ne,[(0,t.createElementVNode)('div',oe,[((0,t.openBlock)(),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(De,e=>(0,t.createElementVNode)('button',{key:e.key,class:(0,t.normalizeClass)(['btn',{active:qe.value===e.key}]),onClick:t=>qe.value=e.key},(0,t.toDisplayString)(e.name),11,re)),64))]),(0,t.createElementVNode)('div',ie,[(0,t.createElementVNode)('div',se,[(0,t.createElementVNode)('img',{src:gt.value.avatarUrl,style:{width:'100px',height:'100px','border-radius':'12px','object-fit':'cover',border:'2px solid var(--accent-gold)'}},null,8,ce),(0,t.createElementVNode)('div',null,[(0,t.createElementVNode)('h3',de,(0,t.toDisplayString)(gt.value.name),1),(0,t.createElementVNode)('p',me,(0,t.toDisplayString)(gt.value.summary),1)])]),(0,t.createElementVNode)('div',ue,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(yt.value,(e,a)=>((0,t.openBlock)(),(0,t.createElementBlock)('div',{key:a},[(0,t.createElementVNode)('span',pe,(0,t.toDisplayString)(a),1),(0,t.createElementVNode)('span',ve,(0,t.toDisplayString)(e),1)]))),128))])])])])],2112)):(0,t.createCommentVNode)('v-if',!0)])])])):(0,t.createCommentVNode)('v-if',!0)]),_:1}),(0,t.createCommentVNode)(' Perspective Selector '),(0,t.createVNode)(t.Transition,{name:'fade'},{default:(0,t.withCtx)(()=>[Fe.value?((0,t.openBlock)(),(0,t.createElementBlock)('div',ge,[(0,t.createElementVNode)('div',ye,[a[34]||(a[34]=(0,t.createElementVNode)('header',{class:'modal-header'},[(0,t.createElementVNode)('h2',null,'请选择主视角')],-1)),(0,t.createElementVNode)('div',fe,[a[33]||(a[33]=(0,t.createElementVNode)('p',{style:{'margin-bottom':'20px',color:'var(--ink-1)'}},' 首次进入当前聊天，请选择一个主视角以注入对应的开场白。 ',-1)),(0,t.createElementVNode)('div',Ee,[((0,t.openBlock)(!0),(0,t.createElementBlock)(t.Fragment,null,(0,t.renderList)(dt.value,e=>((0,t.openBlock)(),(0,t.createElementBlock)('button',{key:e.key,class:'card',style:(0,t.normalizeStyle)({border:Ae.value===e.key?'2px solid var(--accent-gold)':'1px solid var(--line-soft)',padding:'15px',cursor:'pointer',background:'white',textAlign:'left'}),onClick:t=>Ae.value=e.key},[(0,t.createElementVNode)('strong',be,(0,t.toDisplayString)(e.key),1),(0,t.createElementVNode)('span',he,(0,t.toDisplayString)(e.description),1)],12,ke))),128))]),Ae.value?((0,t.openBlock)(),(0,t.createElementBlock)('div',Ve,[a[32]||(a[32]=(0,t.createElementVNode)('h3',{style:{'font-size':'0.9rem','margin-bottom':'10px',color:'var(--ink-1)'}},'开场白预览：',-1)),(0,t.createElementVNode)('p',Ne,(0,t.toDisplayString)(mt.value),1)])):(0,t.createCommentVNode)('v-if',!0),(0,t.createElementVNode)('button',{class:'btn-send',style:{width:'100%',padding:'15px','font-size':'1.1rem'},disabled:!Ae.value,onClick:wt},' 确认并开始故事 ',8,xe)])])])):(0,t.createCommentVNode)('v-if',!0)]),_:1})],12,l))}});$(()=>{const a=(0,t.createApp)(we).use(e());a.mount('#app'),$(window).on('pagehide',()=>a.unmount())});
//# sourceMappingURL=index.js.map</script><style>@import url(https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&family=Noto+Serif+SC:wght@400;600;700&family=ZCOOL+XiaoWei&display=swap);
@import url(https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css);
/*! tailwindcss v4.2.0 | MIT License | https://tailwindcss.com */:root{--clr-cocoa:#f5b0b6;--clr-chino:#8ab7eb;--clr-rize:#ae96d8;--clr-chiya:#87ce87;--clr-syaro:#f5d36e;--clr-maya:#7dd4df;--clr-megu:#f7a699;--clr-fuyu:#8d8fd6;--clr-yura:#e58ec4;--clr-natsume:#ce67e8;--clr-eru:#faa548;--clr-aoyama:#4778d1;--clr-mate:#4bafd7;--clr-mocha:#b7df69}:root{--bg-0:#faf8f5;--bg-1:#f5f0e8;--bg-2:#e8e0d5;--ink-0:#4a4a4a;--ink-1:#7a7a7a;--ink-muted:#9a9a9a;--accent-rose:#e8c4c4;--accent-violet:#d4c4e8;--accent-gold:#d4a574;--line-soft:rgba(0,0,0,0.08);--card-bg:rgba(255,255,255,0.85);--shadow-sm:0 2px 8px rgba(0,0,0,0.05);--shadow-md:0 8px 24px rgba(0,0,0,0.08);--shadow-lg:0 16px 48px rgba(0,0,0,0.12);--dur-fast:150ms;--dur-normal:300ms;--ease-out:cubic-bezier(0.33,1,0.68,1);--clr-cocoa:#f5b0b6;--clr-chino:#8ab7eb;--clr-rize:#ae96d8;--clr-chiya:#87ce87;--clr-syaro:#f5d36e}[data-theme='theme-midnight-salon']{--bg-0:#1a1a1c;--bg-1:#252529;--bg-2:#2d2d33;--ink-0:#e0e0e0;--ink-1:#a0a0a0;--ink-muted:#707070;--accent-rose:#8b5e5e;--accent-violet:#5e5e8b;--accent-gold:#8b7355;--line-soft:rgba(255,255,255,0.1);--card-bg:rgba(30,30,35,0.85)}*{box-sizing:border-box;margin:0;padding:0}html,body,#app{width:100%;height:100%;overflow:hidden}body{font-family:'Noto Sans SC',sans-serif;color:var(--ink-0);background-color:var(--bg-0);line-height:1.6;-webkit-font-smoothing:antialiased}.background-layer{position:fixed;inset:0;z-index:-1;background:linear-gradient(135deg,var(--bg-0) 0%,var(--bg-1) 100%)}.bg-pattern{position:absolute;inset:0;opacity:0.03;background-image:url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23d4a574' fill-opacity='0.4'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")}.splash-screen{position:fixed;inset:0;z-index:1000;background:var(--bg-0);display:flex;flex-direction:column;align-items:center;justify-content:center;padding:20px}.splash-logo{width:100%;max-width:500px;margin-bottom:60px;text-align:center}.splash-logo img{width:100%;height:auto;filter:drop-shadow(0 4px 12px rgba(0,0,0,0.1))}.splash-title{font-family:'ZCOOL XiaoWei',serif;font-size:2.5rem;color:var(--accent-gold);margin-top:20px}.press-start-btn{background:none;border:2px solid var(--accent-gold);color:var(--accent-gold);padding:12px 40px;font-size:1.2rem;font-weight:700;letter-spacing:4px;border-radius:999px;cursor:pointer;transition:all var(--dur-normal) var(--ease-out);position:relative;overflow:hidden}.press-start-btn:hover{background:var(--accent-gold);color:white;box-shadow:0 0 20px rgba(212,165,116,0.4)}#page-game-root{width:100%;height:100%;display:flex;flex-direction:column;position:relative}#region-top-nav{height:64px;display:flex;align-items:center;justify-content:space-between;padding:0 24px;background:var(--card-bg);backdrop-filter:blur(12px);border-bottom:1px solid var(--line-soft);z-index:100}.brand-logo{display:flex;flex-direction:column}.brand-main{font-family:'ZCOOL XiaoWei',serif;font-size:1.25rem;color:var(--accent-gold);line-height:1.2}.brand-sub{font-size:0.75rem;color:var(--ink-1);letter-spacing:1px}.nav-actions{display:flex;gap:12px}.nav-btn{background:none;border:none;color:var(--ink-1);font-size:1.1rem;padding:8px;cursor:pointer;transition:color var(--dur-fast);display:flex;align-items:center;gap:6px}.nav-btn span{font-size:0.9rem;font-weight:500}.nav-btn:hover{color:var(--accent-gold)}#region-main-content{flex:1;display:flex;flex-direction:column;overflow:hidden;max-width:1000px;margin:0 auto;width:100%;padding:20px;gap:20px}.panel-story{flex:1;display:flex;flex-direction:column;background:var(--card-bg);border-radius:20px;border:1px solid var(--line-soft);box-shadow:var(--shadow-md);overflow:hidden}.panel-header{padding:16px 24px;border-bottom:1px solid var(--line-soft);display:flex;justify-content:space-between;align-items:center}.panel-header h2{font-size:1rem;font-weight:700;color:var(--ink-1);text-transform:uppercase;letter-spacing:1px}#story-current-message{flex:1;padding:24px;overflow-y:auto;font-family:'Noto Serif SC',serif;font-size:1.15rem;line-height:1.8;color:var(--ink-0);white-space:pre-wrap}.panel-options{background:var(--card-bg);border-radius:20px;border:1px solid var(--line-soft);box-shadow:var(--shadow-md);padding:20px;display:flex;flex-direction:column;gap:16px}.option-list{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:12px;list-style:none}.option-card{background:white;border:1px solid var(--line-soft);border-radius:12px;padding:14px 18px;text-align:left;cursor:pointer;transition:all var(--dur-normal) var(--ease-out);display:flex;flex-direction:column;gap:4px}.option-card:hover{border-color:var(--accent-gold);transform:translateY(-2px);box-shadow:var(--shadow-md)}.option-card strong{font-size:0.85rem;color:var(--accent-gold);text-transform:uppercase}.option-card span{font-size:1rem;color:var(--ink-0)}.custom-input-group{display:flex;gap:10px;margin-top:8px}.custom-input-group textarea{flex:1;background:white;border:1px solid var(--line-soft);border-radius:12px;padding:12px;font-family:inherit;font-size:0.95rem;resize:none;height:48px;transition:border-color var(--dur-fast)}.custom-input-group textarea:focus{outline:none;border-color:var(--accent-gold)}.btn-send{background:var(--accent-gold);color:white;border:none;border-radius:12px;padding:0 20px;font-weight:600;cursor:pointer;transition:opacity var(--dur-fast)}.btn-send:hover{opacity:0.9}#region-character-bar{height:80px;background:var(--card-bg);backdrop-filter:blur(12px);border-top:1px solid var(--line-soft);display:flex;align-items:center;padding:0 20px;gap:16px;z-index:100}.character-scroll{flex:1;display:flex;gap:12px;overflow-x:auto;padding:10px 0;scrollbar-width:none}.character-scroll::-webkit-scrollbar{display:none}.char-chip{flex-shrink:0;display:flex;align-items:center;gap:10px;background:white;border:1px solid var(--line-soft);border-radius:999px;padding:6px 16px 6px 6px;cursor:pointer;transition:all var(--dur-fast)}.char-chip:hover{border-color:var(--chip-color);transform:translateY(-2px)}.char-avatar{width:32px;height:32px;border-radius:50%;overflow:hidden;border:2px solid var(--chip-color)}.char-avatar img{width:100%;height:100%;object-fit:cover}.char-name{font-size:0.9rem;font-weight:600;color:var(--ink-0)}.quick-actions-mini{display:flex;gap:8px}.mini-btn{width:36px;height:36px;border-radius:50%;background:white;border:1px solid var(--line-soft);color:var(--ink-1);display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all var(--dur-fast)}.mini-btn:hover{color:var(--accent-gold);border-color:var(--accent-gold)}.modal-scrim{position:fixed;inset:0;background:rgba(0,0,0,0.4);backdrop-filter:blur(4px);z-index:2000;display:flex;align-items:center;justify-content:center;padding:20px}.modal-shell{background:var(--bg-0);width:100%;max-width:600px;max-height:90vh;border-radius:24px;box-shadow:var(--shadow-lg);display:flex;flex-direction:column;overflow:hidden;animation:modalEnter 0.4s var(--ease-out)}@keyframes modalEnter{from{opacity:0;transform:scale(0.9) translateY(20px)}to{opacity:1;transform:scale(1) translateY(0)}}.modal-header{padding:20px 24px;border-bottom:1px solid var(--line-soft);display:flex;justify-content:space-between;align-items:center}.modal-body{flex:1;overflow-y:auto;padding:24px}.fade-enter-active,.fade-leave-active{transition:opacity 0.5s}.fade-enter-from,.fade-leave-to{opacity:0}.slide-up-enter-active,.slide-up-leave-active{transition:transform 0.4s var(--ease-out),opacity 0.4s}.slide-up-enter-from,.slide-up-leave-to{transform:translateY(20px);opacity:0}@keyframes fadeInDown{from{opacity:0;transform:translateY(-20px)}to{opacity:1;transform:translateY(0)}}@keyframes fadeInUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}@keyframes pulse{0%,100%{opacity:1}50%{opacity:0.7}}.animate-fadeInDown{animation:fadeInDown 0.8s var(--ease-out) forwards}.animate-fadeInUp{animation:fadeInUp 0.8s var(--ease-out) forwards}.animate-pulse{animation:pulse 2s ease-in-out infinite}@media (max-width:768px){#region-top-nav{padding:0 16px}.nav-btn span{display:none}#region-main-content{padding:12px;gap:12px}.panel-header{padding:12px 16px}#story-current-message{padding:16px;font-size:1.05rem}.option-list{grid-template-columns:1fr}.char-name{display:none}.char-chip{padding:6px}}


/*# sourceMappingURL=main.css.map*/</style></head><body><div id="app"></div></body>